<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SQL MCQ Exam – Batch + Resume + Timers + Persistence</title>
  <style>
    :root{--bg:#f4f4f4;--card:#fff;--accent:#007bff;--good:#28a745;--bad:#dc3545;--muted:#666}
    body{font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);margin:0;padding:20px;color:#222}
    .container{max-width:1000px;margin:auto;background:var(--card);padding:18px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,0.06)}
    h1{margin:0 0 12px;color:var(--accent)}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    button{padding:8px 12px;border-radius:6px;border:0;cursor:pointer}
    .primary{background:var(--accent);color:#fff}
    .secondary{background:#6c757d;color:#fff}
    .warn{background:#ffc107}
    .danger{background:var(--bad);color:#fff}
    .menu{margin-bottom:12px}
    #questionBox{padding:12px;border-radius:8px;background:#fafafa;margin:12px 0}
    .progress{height:10px;background:#eee;border-radius:6px;overflow:hidden}
    .progress > div{height:100%;background:var(--accent);width:0%}
    .small{font-size:0.9rem;color:var(--muted)}
    .navNums{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
    .navNums button{width:36px;height:36px;border-radius:50%;background:#e9ecef;border:2px solid transparent}
    .navNums button.answered{background:var(--good);color:#fff}
    .navNums button.marked{outline:2px dashed #ff9800}
    .dark{background:#121214;color:#e6eef8}
    .dark #questionBox{background:#1a1a1f}
    .controls-left { display:flex; gap:8px; align-items:center; }
    /* menu extras */
    .batch-btn { min-width:140px; padding:10px 12px; border-radius:8px; font-weight:600; }
    .batch-wrap { display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .reset-btn { margin-top:16px; display:inline-block; }
  </style>
</head>
<body>
<div class="container" id="app">
  <h1>SQL MCQ Exam — Batch Mode</h1>

  <div id="menu" class="menu"></div>

  <div id="controls" style="display:none" class="row">
    <div class="small">Batch: <strong id="batchTitle"></strong></div>
    <div class="small">Global Time: <span id="globalTimer"></span></div>
    <div class="small">Question Time: <span id="questionTimer"></span></div>

    <div style="margin-left:auto" class="controls-left">
      <button id="homeBtn" class="secondary">Home</button>
      <button id="prevBatchBtn" class="secondary">Prev Batch</button>
      <button id="nextBatchBtn" class="secondary">Next Batch</button>
      <button id="shuffleToggle" class="secondary">Shuffle: ON</button>
      <button id="darkToggle" class="secondary">Dark</button>
      <button id="exportBtn" class="secondary">Export</button>
      <input id="importFile" type="file" accept="application/json" style="display:none">
      <button id="importBtn" class="secondary">Import</button>
    </div>
  </div>

  <div id="exam" style="display:none">
    <div id="questionBox"></div>

    <div class="row">
      <button id="prevBtn" class="secondary">Previous</button>
      <button id="nextBtn" class="primary">Next</button>
      <button id="answerLaterBtn" class="warn">Answer Later (Mark)</button>
      <button id="pauseBtn" class="secondary">Pause</button>
      <button id="resumeBtn" class="primary" style="display:none">Resume</button>
      <button id="submitBtn" class="danger">Submit Batch</button>
    </div>

    <div style="margin-top:12px">
      <div class="progress"><div id="progBar"></div></div>
      <div class="row small" style="justify-content:space-between;margin-top:6px">
        <div id="progressText"></div>
        <div id="marksLegend" class="small"></div>
      </div>
      <div class="navNums" id="navNums"></div>
    </div>
  </div>

  <div id="result" style="margin-top:12px"></div>
</div>

<script>
/* ----------------- CONFIG ----------------- */
const QUESTIONS_PER_BATCH = 25;
const PER_QUESTION_SECONDS = 20;
const LS_KEY = 'mcq_exam_v2_state';
const COMPLETED_KEY = 'mcq_completed_batches';

/* ----------------- SAMPLE QUESTIONS (replace with full set later) ----------------- */
let originalQuestions = [
        {
    "q": "Which SQL command is used to retrieve data from a database table?",
    "options": [
      "GET",
      "FETCH",
      "SELECT",
      "OPEN TABLE"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which SQL clause is used to filter rows based on a specific condition?",
    "options": [
      "CONDITION",
      "FILTER BY",
      "WHERE",
      "LIMIT TO"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which SQL command is used to insert new rows into a table?",
    "options": [
      "ADD ROW",
      "INSERT INTO",
      "CREATE RECORD",
      "UPDATE"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What does the acronym SQL stand for?",
    "options": [
      "Structured Question Language",
      "Standard Query Logic",
      "Simple Query Language",
      "Structured Query Language"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "Which operator is used to search for a specific pattern in a column?",
    "options": [
      "PATTERN",
      "LIKE",
      "MATCH",
      "COMPARE"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which type of JOIN returns only the rows with matching values in both tables?",
    "options": [
      "FULL JOIN",
      "LEFT JOIN",
      "INNER JOIN",
      "OUTER JOIN"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which SQL command is used to modify existing data in a table?",
    "options": [
      "MODIFY",
      "CHANGE",
      "ALTER",
      "UPDATE"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "Which SQL keyword is used to sort the result-set of a query?",
    "options": [
      "SORT BY",
      "ARRANGE BY",
      "GROUP BY",
      "ORDER BY"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "A table must have a column defined as a ______ to uniquely identify each record.",
    "options": [
      "Foreign Key",
      "Candidate Key",
      "Primary Key",
      "Unique Key"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which function is used to count the number of rows in a table?",
    "options": [
      "SUM()",
      "COUNT()",
      "NUMBER()",
      "ROWS()"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Can we add a column with IDENTITY property in an existing table?",
    "options": [
      "Yes, by using the `ALTER COLUMN` command directly.",
      "No, the operation is restricted or requires an alternative approach.",
      "No, because it would violate referential integrity.",
      "You must drop and recreate the database."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Can we add a NOT NULL column to an existing table?",
    "options": [
      "No, because it would violate referential integrity.",
      "Yes, by using the `ALTER COLUMN` command directly.",
      "Yes, but a DEFAULT value must be provided for existing rows.",
      "You must drop and recreate the database."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "How can you create an incrementing sequence object in SQL Server?",
    "options": [
      "Use an `IDENTITY` column to generate sequential numbers.",
      "The command to restart is `RESET SEQUENCE`.",
      "Sequence values are only generated during table creation.",
      "A SEQUENCE object generates a sequence of numeric values in order."
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "How do you reset the value of a sequence object?",
    "options": [
      "Drop and recreate the database.",
      "Use an `IDENTITY` column to generate sequential numbers.",
      "ALTER SEQUENCE dbo.SequenceObject RESTART WITH 1",
      "The command to restart is `RESET SEQUENCE`."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which command is used to drop a sequence?",
    "options": [
      "RESET SEQUENCE",
      "Unsupported operation",
      "DROP SEQUENCE",
      "ROLLBACK"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "What is a Clustered Index?",
    "options": [
      "A clustered index allows up to 5 indexes per table.",
      "It dictates the physical, sorted storage order of data rows.",
      "The index is stored in memory only.",
      "The index structure is a hash table."
    ],
    "answer": 1,
    "time": 20
  },
  {
  "q": "What is the maximum number of clustered indexes that can exist on a single table in SQL Server?",
  "options": [
    "A table can have one clustered index, but additional clustered indexes can be simulated using indexed views.",
    "A table may contain multiple clustered indexes if each is defined on a separate partition scheme.",
    "Only one clustered index is allowed per table, because the table's rows can be physically ordered in only one way.",
    "Clustered indexes can be created in pairs as long as different unique keys are used for each."
  ],
  "answer": 2,
  "time": 20
}
,
  {
    "q": "What is a Page Split?",
    "options": [
      "Moving half the rows from a full page to a new page for inserts.",
      "Page splits occur only during SELECT operations.",
      "A page split is a database corruption error.",
      "Resolved by using `ROLLBACK`."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the physical structure of a clustered index?",
    "options": [
      "Hash table",
      "B-tree hash map",
      "B-Tree",
      "Enterprise-only feature"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "What is a Non-Clustered Index?",
    "options": [
      "Dictates physical order of data rows.",
      "Contains key values and row pointers separate from the data.",
      "Stored in the same location as the data.",
      "Unsupported command resulting in error."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "How many non-clustered indexes can a table have?",
    "options": [
      "Stored in the same location as data.",
      "Only one clustered index per table.",
      "Drop and recreate the database.",
      "Maximum of 999 non-clustered indexes."
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "What is index fragmentation?",
    "options": [
      "Feature related to distributed transactions.",
      "Index stored only in memory.",
      "When index data pages are scattered, degrading performance.",
      "Process of deleting the database file."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "What is the difference between Index Rebuild and Index Reorganize?",
    "options": [
      "Rebuild is online and faster, Reorganize is offline and slower.",
      "Rebuild creates a new index and drops the old one; Reorganize physically reorders the leaf-level pages in place.",
      "The solution is to use the `ROLLBACK` command.",
      "Reorganize creates a new index and drops the old one; Rebuild physically reorders the leaf-level pages in place."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is Fill Factor in SQL Server indexes?",
    "options": [
      "Fill factor only applies to the root node of the index.",
      "It is a value from 0 to 100 that specifies the percentage of space to leave empty on each leaf-level page.",
      "The functionality is reserved for Enterprise Edition only.",
      "It specifies the maximum number of columns an index can contain."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is a Covered Index in SQL Server?",
    "options": [
      "An index that includes all the columns requested in the query, allowing the query to complete without looking up the data row.",
      "It is a feature related to distributed transactions only.",
      "The index is stored in memory (RAM) only.",
      "The index structure is a Hash Table (Hash map)."
    ],
    "answer": 0,
    "time": 20
  },
   
  {
    "q": "What is the difference between WHERE and HAVING clauses in SQL Server?",
    "options": [
      "`WHERE` is used for row filtering before aggregation; `HAVING` is used for group filtering after aggregation.",
      "`HAVING` is faster than `WHERE` and is used only on indexed columns.",
      "It is not possible in SQL Server.",
      "`WHERE` is used for filtering data after aggregation; `HAVING` is used for filtering before aggregation."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is a Stored Procedure in SQL Server?",
    "options": [
      "A temporary object that holds data only for the current session.",
      "A precompiled set of one or more SQL statements stored in the database.",
      "The functionality is reserved for Enterprise Edition only.",
      "An index that includes all the columns requested in the query."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the key difference between Stored Procedure and Function in SQL Server?",
    "options": [
      "Functions can modify data and cannot be used in `SELECT` statements; Procedures can only return a single value.",
      "Stored Procedures can modify data and return 0 or more values; Functions cannot modify data (usually) and return a single value or table.",
      "The command is unsupported and results in an error.",
      "Functions can modify data; Procedures are read-only."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the difference between Local Temporary Table and Global Temporary Table?",
    "options": [
      "Local temporary tables are visible to all sessions; Global temporary tables are visible only to the session that created them.",
      "Local tables are prefixed with `##` and are session-specific; Global tables are prefixed with `#` and are visible to all sessions.",
      "Local tables are prefixed with `#` and are session-specific; Global tables are prefixed with `##` and are visible to all sessions.",
      "It is only available in older SQL Server versions."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "How to create a Global Temporary Table in SQL Server?",
    "options": [
      "CREATE GLOBAL TABLE #TableName",
      "CREATE TABLE ##TableName",
      "It is not possible in SQL Server.",
      "CREATE TABLE ##TableName (Col1 INT)"
    ],
    "answer": 3,
    "time": 20
  },
  
{
  "q": "What is a Self Join in SQL Server?",
  "options": [
    "A join where a table is logically paired with itself using different aliases to compare rows within the same dataset.",
    "A join that requires a self-referencing foreign key to relate parent and child records within a hierarchical structure.",
    "A join used when two tables share identical structures and need to be compared column-by-column.",
    "A join operation that forces SQL Server to perform a recursive traversal of the same table using a CTE."
  ],
  "answer": 0,
  "time": 20
}
,
  {
    "q": "What is a Subquery in SQL Server?",
    "options": [
      "A precompiled set of one or more SQL statements stored in the database.",
      "A query embedded inside another SQL query (SELECT, INSERT, UPDATE, or DELETE).",
      "It is a feature related to distributed transactions only.",
      "The solution is to use the `ROLLBACK` command."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the difference between Scalar and Inline Table-Valued Functions?",
    "options": [
      "Scalar functions return a single value; Inline Table-Valued Functions return a table.",
      "Scalar functions return a table; Inline Table-Valued Functions return a single value.",
      "The functionality is reserved for Enterprise Edition only.",
      "Inline Table-Valued Functions cannot be used in the `FROM` clause."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is a Trigger in SQL Server?",
    "options": [
      "A temporary object that holds data only for the current session.",
      "A special kind of stored procedure that automatically executes when a specified event occurs (INSERT, UPDATE, DELETE).",
      "Triggers are only used for creating indexes.",
      "The command is unsupported and results in an error."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the difference between INSTEAD OF and AFTER triggers?",
    "options": [
      "`AFTER` triggers fire before the action and can bypass it; `INSTEAD OF` triggers fire after the action.",
      "`INSTEAD OF` triggers fire instead of the action, allowing you to bypass or replace it; `AFTER` triggers fire after the action is complete.",
      "It is only available in older SQL Server versions.",
      "The functionality is reserved for Enterprise Edition only."
    ],
    "answer": 1,
    "time": 20
  },
  {
  "q": "What is the difference between User and Schema in SQL Server?",
  "options": [
    "A user is a container for database objects; a schema is a login used to connect to the database.",
    "A user is a security principal that can access a database; a schema is a logical container that holds database objects.",
    "Schemas and users are the same in SQL Server and interchangeable.",
    "A schema controls permissions, while the user stores objects."
  ],
  "answer": 1,
  "time": 20
}
,
  {
    "q": "What is the difference between View and Indexed View?",
    "options": [
      "A view is a stored query; an indexed view (materialized view) stores the results physically, making it faster to query.",
      "Indexed views are only allowed on temporary tables.",
      "Views allow data modification; Indexed views do not.",
      "The functionality is reserved for Enterprise Edition only."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the difference between Dynamic SQL and Static SQL?",
    "options": [
      "Static SQL is generated at runtime and is prone to SQL injection; Dynamic SQL is precompiled and safe.",
      "Dynamic SQL is generated at runtime and is prone to SQL injection; Static SQL is precompiled and safe.",
      "The solution is to use the `ROLLBACK` command.",
      "Dynamic SQL is faster because it uses a compiled plan."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "How to execute Dynamic SQL in SQL Server?",
    "options": [
      "The correct command is `EXECUTE PROCEDURE`.",
      "You must drop and recreate the database.",
      "Using the `EXEC` or `sp_executesql` command.",
      "It is not possible in SQL Server."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "What is the difference between EXEC and sp_executesql?",
    "options": [
      "EXEC is safer and uses parameterization; `sp_executesql` is faster but is more prone to SQL injection.",
      "The command is unsupported and results in an error.",
      "`sp_executesql` supports parameterized queries, which improves security (prevents SQL injection) and execution plan reuse.",
      "EXEC is faster and supports parameterized queries."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "What is a Transaction in SQL Server?",
    "options": [
      "A single database operation that modifies exactly one row.",
      "A sequence of one or more SQL statements that are treated as a single, indivisible unit of work.",
      "It is only available in older SQL Server versions.",
      "The functionality is reserved for Enterprise Edition only."
    ],
    "answer": 1,
    "time": 20
  },
  {
  "q": "Which statement correctly defines the ACID properties in SQL Server?",
  "options": [
    "A collection of transaction behaviors ensuring that once a transaction begins, all locks are escalated to prevent partial writes across filegroups.",
    "A fundamental set of guarantees—Atomicity, Consistency, Isolation, Durability—that ensure reliable transaction processing regardless of system failures.",
    "A mechanism that applies only when snapshot isolation or read-committed snapshot isolation (RCSI) is enabled in the database.",
    "A legacy feature used only in distributed or two-phase commit transactions, ensuring remote resource managers validate log records."
  ],
  "answer": 1,
  "time": 25
}
,
  {
    "q": "What is the difference between Commit and Rollback in SQL Server?",
    "options": [
      "`COMMIT` makes all changes permanent; `ROLLBACK` undoes all changes since the last `BEGIN TRANSACTION` or `COMMIT`.",
      "`ROLLBACK` makes all changes permanent; `COMMIT` undoes all changes.",
      "The command is unsupported and results in an error.",
      "The functionality is reserved for Enterprise Edition only."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the difference between ISNULL and COALESCE in SQL Server?",
    "options": [
      "`ISNULL` supports only one check value and uses the check value's data type; `COALESCE` supports multiple check values and uses the highest precedence data type.",
      "`COALESCE` is an older function and is less compatible; `ISNULL` is the modern replacement.",
      "It is not possible in SQL Server.",
      "`COALESCE` only works on non-string data types."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the difference between NOLOCK and READ UNCOMMITTED?",
    "options": [
      "`NOLOCK` is a keyword; `READ UNCOMMITTED` is a transaction isolation level that achieves the same result (reading uncommitted changes).",
      "`READ UNCOMMITTED` is faster and does not introduce dirty reads; `NOLOCK` is slower and causes dirty reads.",
      "The command is unsupported and results in an error.",
      "They are completely different and unrelated concepts."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the difference between CHAR and VARCHAR in SQL Server?",
    "options": [
      "`CHAR` is variable length; `VARCHAR` is fixed length.",
      "`VARCHAR` is variable length and stores only necessary bytes; `CHAR` is fixed length and always uses the declared size.",
      "The solution is to use the `ROLLBACK` command.",
      "The functionality is reserved for Enterprise Edition only."
    ],
    "answer": 1,
    "time": 20
  },

  {
    "q": "What is difference between DDL and DML in SQL Server?",
    "options": [
      "DDL (Data Definition Language) manages data and rows; DML (Data Manipulation Language) manages structure and objects.",
      "DDL manages structure/objects (CREATE, ALTER, DROP); DML manages data/rows (INSERT, UPDATE, DELETE).",
      "The command is unsupported and results in an error.",
      "DDL only works on temporary tables; DML works on permanent tables."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is difference between primary and foreign key?",
    "options": [
      "A primary key establishes a unique row identifier; a foreign key links two tables by referencing the primary key of another table.",
      "Both are the same, but the foreign key is faster.",
      "A primary key allows one NULL value; a foreign key does not allow any NULL values.",
      "The solution is to use the `ROLLBACK` command."
    ],
    "answer": 0,
    "time": 20
  },
  {
  "q": "Which statement best describes the relationship between a primary key and candidate keys?",
  "options": [
    "A primary key is the candidate key selected to uniquely identify rows, while other candidate keys remain alternate unique identifiers that also guarantee uniqueness.",
    "A candidate key is any column participating in a foreign key relationship, whereas the primary key is always system-generated unless overridden.",
    "Primary keys enforce both entity integrity and referential integrity, while candidate keys enforce only referential integrity.",
    "Candidate keys must be natural keys, whereas primary keys must be surrogate keys generated by the database engine."
  ],
  "answer": 0,
  "time": 25
}
,
  {
    "q": "What is difference between user and login in SQL Server?",
    "options": [
      "A login is a database identity that grants permissions; a user is a server identity used for connection.",
      "A login is a server-level identity used to connect to the SQL Server instance; a user is a database-level identity used to grant permissions.",
      "The functionality is reserved for Enterprise Edition only.",
      "They are completely different and unrelated concepts."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is CTE in SQL Server?",
    "options": [
      "A temporary object that holds data only for the current session.",
      "Common Table Expression (CTE) is a named temporary result set defined within the execution scope of a single SELECT, INSERT, UPDATE, or DELETE statement.",
      "It is only available in older SQL Server versions.",
      "The command is unsupported and results in an error."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is STUFF function in SQL Server?",
    "options": [
      "The STUFF function removes a specified length of characters from a string and inserts another string in its place.",
      "The STUFF function converts a table into a single column string.",
      "The solution is to use the `ROLLBACK` command.",
      "The correct command is `EXECUTE PROCEDURE`."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is PIVOT and UNPIVOT in SQL Server?",
    "options": [
      "PIVOT converts columns into rows; UNPIVOT converts rows into columns.",
      "PIVOT converts rows into columns; UNPIVOT converts columns into rows.",
      "It is not possible in SQL Server.",
      "The functionality is reserved for Enterprise Edition only."
    ],
    "answer": 1,
    "time": 20
  },
  {
  "q": "In SQL Server, what is the primary use of the FOR XML PATH() construct?",
  "options": [
    "It generates XML fragments that can be manipulated to concatenate row values or build custom-shaped XML output.",
    "It is used strictly for shredding XML data into relational tables during parsing operations.",
    "It is a legacy feature that only works on XML datatype columns and cannot be used with regular SELECT statements.",
    "It is primarily used to enforce hierarchical referential constraints across related tables."
  ],
  "answer": 0,
  "time": 25
}
,
  {
    "q": "What is an Identity column in SQL Server?",
    "options": [
      "A column that must be manually updated with a unique value.",
      "A property on a column that automatically generates sequential numeric values when new rows are inserted.",
      "A column that enforces referential integrity between tables.",
      "A setting that restricts duplicate values in a table."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is difference between Primary Key and Foreign Key?",
    "options": [
      "A primary key links two tables; a foreign key ensures data uniqueness.",
      "A primary key uniquely identifies a row in a table; a foreign key establishes a relationship by referencing the primary key in another table.",
      "A foreign key can only be created on temporary tables.",
      "Both enforce uniqueness at the column level."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the difference between a Left Join and a Full Join?",
    "options": [
      "Left Join returns only matching rows; Full Join returns only non-matching rows.",
      "Left Join returns all rows from the left table and matching rows from the right; Full Join returns all rows from both tables whether matched or not.",
      "Left Join and Full Join return identical results.",
      "Full Join returns rows only when both tables contain matching records."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is a Cross Join in SQL Server?",
    "options": [
      "A join that returns only matching rows between two tables.",
      "A join that returns the Cartesian product of all rows from both tables.",
      "A join that requires a primary-foreign key relationship.",
      "A join that is used to merge duplicate rows."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the difference between Inner Join and Outer Join?",
    "options": [
      "Inner Join returns only the rows that match in both tables; Outer Join returns matching rows plus non-matching rows from one or both sides.",
      "Outer Join returns only rows that match in both tables; Inner Join includes non-matching rows.",
      "Inner Join retrieves all rows from both tables regardless of condition.",
      "Outer Join can only be used with aggregate functions."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is a Schema in SQL Server?",
    "options": [
      "A database connection used for authentication.",
      "A logical container that groups database objects like tables, views, and stored procedures.",
      "A system object that stores execution plans.",
      "A structure used to enforce referential integrity."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is an Alias in SQL Server?",
    "options": [
      "A permanent name assigned to a table or column.",
      "A temporary name assigned to a table or column in a query for readability.",
      "A feature used to store XML data in SQL Server.",
      "A system-defined name used for stored procedures."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is a View in SQL Server?",
    "options": [
      "A physical table that stores data permanently.",
      "A virtual table based on the result set of a SQL query.",
      "A synonym for a schema in SQL Server.",
      "A system object used to manage indexes."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is an Index in SQL Server?",
    "options": [
      "A feature that enforces referential integrity between tables.",
      "A data structure that speeds up data retrieval operations on a table.",
      "A logical container for grouping stored procedures.",
      "A command used to define the primary key on a table."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the difference between CHECK and DEFAULT constraint?",
    "options": [
      "CHECK defines a default value for a column; DEFAULT limits the allowed range of values.",
      "CHECK restricts the allowed values in a column; DEFAULT provides an automatic value when no explicit value is given.",
      "CHECK is only applicable to string columns; DEFAULT is for numeric columns.",
      "DEFAULT can be applied multiple times; CHECK can only be used once per column."
    ],
    "answer": 1,
    "time": 20
  },

{
  q: "What are CAST and CONVERT functions used for in SQL Server?",
  options: [
    "Both are used to change an expression from one data type to another, but CONVERT allows formatting with an optional style parameter.",
    "They are used to encrypt and decrypt data.",
    "They are used to convert data into XML format only.",
    "They are used to transform table structures between databases."
  ],
  answer: 0,
  time: 20
},
{
  q: "What is the difference between DATETIME and DATETIME2 in SQL Server?",
  options: [
    "`DATETIME2` supports a larger date range and higher precision (up to 7 digits); `DATETIME` has a smaller range and fixed 3-digit precision.",
    "`DATETIME` supports fractional seconds; `DATETIME2` does not.",
    "`DATETIME` can store timezone info; `DATETIME2` cannot.",
    "`DATETIME2` is available only in SQL Server 2022 and later."
  ],
  answer: 0,
  time: 20
},
{
  q: "What is the difference between NCHAR and NVARCHAR in SQL Server?",
  options: [
    "`NCHAR` is fixed-length Unicode; `NVARCHAR` is variable-length Unicode.",
    "`NCHAR` stores ASCII characters; `NVARCHAR` stores Unicode.",
    "`NVARCHAR` is fixed-length Unicode; `NCHAR` is variable-length Unicode.",
    "Both are identical in functionality and storage."
  ],
  answer: 0,
  time: 20
},
 
{
  q: "What is the difference between a Table Variable and a Temp Table in SQL Server?",
  options: [
    "Table variables are scope-limited and non-transactional (often in memory); Temp tables are transactional and stored in tempdb until the session ends.",
    "Temp tables are stored in memory only; Table variables are stored permanently.",
    "Table variables can have indexes; Temp tables cannot.",
    "Table variables persist even after the session is closed."
  ],
  answer: 0,
  time: 20
},
{
  "q": "What is an Execution Plan in SQL Server?",
  "options": [
    "A metadata table that records index fragmentation details.",
    "A detailed set of steps SQL Server takes internally to execute a query efficiently.",
    "A temporary cache used to store result sets.",
    "A system process for backing up databases automatically."
  ],
  "answer": 1,
  "time": 20
}, 
{
  "q": "How can you generate an Execution Plan in SQL Server?",
  "options": [
    "By using `SET SHOWPLAN_ALL ON` or viewing the graphical plan in SQL Server Management Studio (SSMS).",
    "By enabling query notifications.",
    "By using the BACKUP DATABASE command.",
    "It is automatically created but cannot be viewed by users."
  ],
  "answer": 0,
  "time": 20
}, 
{
  "q": "What is the Database Engine in SQL Server?",
  "options": [
    "The core component that processes queries, manages storage, indexing, and transactions.",
    "A client tool for writing and testing SQL queries.",
    "A monitoring service that tracks user activity.",
    "A system view that lists all tables in a database."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between User and System Databases?",
  "options": [
    "User databases are created by users to store application data; system databases are required for SQL Server’s internal operations.",
    "System databases are optional and can be deleted safely.",
    "User databases are read-only by default; system databases are writable.",
    "Both are automatically created during SQL Server installation."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the Master Database in SQL Server?",
  "options": [
    "It stores user tables and indexes.",
    "It stores system-level information such as logins, configuration, and references to other databases.",
    "It holds temporary objects created by queries.",
    "It is used only for backup operations."
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the Model Database in SQL Server?",
  "options": [
    "A template database used as a blueprint for creating new databases.",
    "A read-only database used for metadata storage.",
    "It stores information about SQL Server Agent jobs.",
    "It acts as a system cache for query results."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the MSDB Database in SQL Server?",
  "options": [
    "It stores information related to SQL Server Agent jobs, alerts, and maintenance plans.",
    "It holds query execution plans for reuse.",
    "It tracks index fragmentation for all user databases.",
    "It is a backup of the Master database."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the TempDB Database in SQL Server?",
  "options": [
    "A workspace for temporary tables, table variables, and intermediate query results.",
    "A repository for system logins and credentials.",
    "A read-only database used for configuration settings.",
    "A database that stores historical backups."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the Resource Database in SQL Server?",
  "options": [
    "It stores all system objects physically and is read-only for users.",
    "It stores the backup history of all databases.",
    "It is used to track SQL Agent activity logs.",
    "It contains the user-defined functions and triggers."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is Replication in SQL Server?",
  "options": [
    "A technology for copying and distributing data and objects between databases and synchronizing them for consistency.",
    "A feature to compress data during backups.",
    "A method to encrypt database connections.",
    "A query optimization feature for distributed systems."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is Database Mirroring in SQL Server?",
  "options": [
    "A high-availability solution that maintains two synchronized copies of a database (principal and mirror).",
    "A backup mechanism that runs once a day.",
    "A process for migrating databases between servers.",
    "A feature for real-time performance tuning."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is Log Shipping in SQL Server?",
  "options": [
    "A disaster recovery solution that transfers transaction log backups from a primary server to secondary servers.",
    "A process of shipping database backups using SSIS packages.",
    "A manual method of synchronizing two databases.",
    "A feature used for encrypting log files."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What are AlwaysOn Availability Groups in SQL Server?",
  "options": [
    "A high-availability and disaster-recovery feature that allows a group of databases to failover together as a single unit.",
    "A data compression feature used for large databases.",
    "A configuration setting for query parallelism.",
    "A performance monitoring tool in SQL Server Management Studio."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Database Mirroring and AlwaysOn Availability Groups?",
  "options": [
    "Database Mirroring supports only one mirror database, while AlwaysOn supports multiple secondary replicas and automatic failover.",
    "Both provide identical functionality with different names.",
    "AlwaysOn supports only synchronous replication; Mirroring supports both modes.",
    "Mirroring allows more replicas than AlwaysOn."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Database Mirroring and Log Shipping?",
  "options": [
    "Mirroring provides real-time synchronization for high availability; Log Shipping provides delayed synchronization for disaster recovery.",
    "Log Shipping is faster but less reliable than Mirroring.",
    "Mirroring requires manual synchronization; Log Shipping is automatic.",
    "Both perform identical roles in database recovery."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is Data Guard in SQL Server?",
  "options": [
    "A built-in SQL Server backup utility.",
    "A replication mechanism for synchronizing servers.",
    "An Oracle feature similar to SQL Server’s AlwaysOn Availability Groups.",
    "A monitoring tool for transaction logs."
  ],
  "answer": 2,
  "time": 20
},

{
  "q": "What is the difference between a Hotfix and a Cumulative Update in SQL Server?",
  "options": [
    "A Hotfix is a small, targeted fix for a specific issue; a Cumulative Update includes all previous hotfixes and updates.",
    "A Hotfix contains performance improvements, while Cumulative Updates are security-only patches.",
    "A Cumulative Update fixes only one issue at a time, while Hotfixes include multiple fixes.",
    "A Hotfix can only be installed on Enterprise Edition; Cumulative Updates work on all editions."
  ],
  "answer": 0,
  "time": 20
},

{
  "q": "What is database collation in SQL Server?",
  "options": [
    "A set of rules defining how strings are sorted and compared, including case and accent sensitivity.",
    "A method used to compress character data for faster performance.",
    "A process of replicating databases across multiple servers.",
    "A backup setting that determines file storage order."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is an Extended Event in SQL Server?",
  "options": [
    "A lightweight event-handling system for monitoring and collecting performance and troubleshooting data.",
    "A trigger that fires automatically after every SQL statement execution.",
    "A logging mechanism for user activities only.",
    "A background job used to schedule periodic database events."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is a Database Snapshot in SQL Server?",
  "options": [
    "A static, read-only view of a database captured at a specific point in time.",
    "A dynamic, writable copy of a database used for real-time analysis.",
    "A compressed backup of the database transaction log.",
    "A transaction log mirror used for failover purposes."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between a User and a Database Principal?",
  "options": [
    "A User is a type of Database Principal; a Database Principal represents any entity (user, role, or application) that can access the database.",
    "A User is created automatically, while a Database Principal must be created manually.",
    "They are two unrelated concepts used for schema mapping.",
    "A Database Principal refers only to server-level roles."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Windows and SQL Server Authentication?",
  "options": [
    "Windows Authentication uses Active Directory credentials; SQL Server Authentication uses credentials stored in SQL Server.",
    "Windows Authentication allows only one user per server; SQL Authentication allows multiple users.",
    "SQL Authentication uses Windows password policies; Windows Authentication does not.",
    "Both methods store credentials directly in the master database."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Permission and Access Control?",
  "options": [
    "Permission grants a specific right on a securable; Access Control is the overall framework for managing who can perform which actions.",
    "Permission and Access Control are identical concepts in SQL Server.",
    "Access Control applies only to stored procedures, while Permission applies to tables.",
    "Permission controls login creation; Access Control controls database design."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Fixed and Flexible Database Roles?",
  "options": [
    "Fixed roles have predefined permissions (e.g., db_owner); Flexible roles are user-defined and can be customized.",
    "Fixed roles can be dropped, while Flexible roles cannot.",
    "Flexible roles are created by the system; Fixed roles are created by users.",
    "Both types have identical behavior but different names."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Database and Server Roles?",
  "options": [
    "Database roles manage permissions within a database; Server roles manage permissions at the SQL Server instance level.",
    "Server roles can only manage logins; Database roles can manage instances.",
    "Database roles are read-only; Server roles are write-only.",
    "Both serve identical purposes but exist in different databases."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "How can you create a Database Role in SQL Server?",
  "options": [
    "Using the `CREATE ROLE` statement.",
    "Using the `CREATE LOGIN` command.",
    "By inserting a record into the sysroles table.",
    "By assigning a user directly to the sysadmin role."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "How do you add a User to a Database Role?",
  "options": [
    "Using `ALTER ROLE ADD MEMBER` or the `sp_addrolemember` procedure.",
    "By updating the sysmembers table manually.",
    "By granting permissions directly to a schema.",
    "By creating a new login with the same name as the role."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is Database Consistency in SQL Server?",
  "options": [
    "The property that ensures the database moves from one valid state to another while maintaining integrity constraints.",
    "The ability of multiple users to access the same data simultaneously.",
    "A measure of how efficiently indexes are used.",
    "The synchronization of backup and restore operations."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between SQL and T-SQL?",
  "options": [
    "SQL is the standard query language; T-SQL is Microsoft’s extension that includes procedural features like variables and error handling.",
    "T-SQL is the standard, while SQL is Microsoft’s extension.",
    "Both are completely identical languages.",
    "SQL is only for querying; T-SQL can only define tables."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is a Database Server Instance in SQL Server?",
  "options": [
    "An isolated environment containing one or more databases and services, running as a separate SQL Server installation.",
    "A physical file that stores database logs.",
    "A user connection to the SQL Server Management Studio.",
    "A process that runs only system databases."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between SQL Server and SQL Database?",
  "options": [
    "SQL Server is the on-premises software; SQL Database is the managed cloud-based PaaS service offered by Azure.",
    "SQL Server is cloud-only; SQL Database runs only on Windows.",
    "SQL Database is used for backups; SQL Server is used for queries.",
    "Both are identical in deployment and management."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between IaaS, PaaS, and SaaS?",
  "options": [
    "IaaS provides infrastructure (VMs, storage), PaaS provides a managed platform, and SaaS provides ready-to-use software applications.",
    "IaaS provides applications, PaaS provides infrastructure, and SaaS provides servers.",
    "IaaS and SaaS are the same, but PaaS is local deployment.",
    "PaaS is hardware-only, while SaaS is platform-only."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Azure SQL Database and Azure SQL Managed Instance?",
  "options": [
    "Azure SQL DB is a fully managed single database with some feature limitations; Managed Instance offers near full SQL Server compatibility with minimal admin effort.",
    "Azure SQL DB supports SQL Agent; Managed Instance does not.",
    "Managed Instance supports only single databases, while SQL DB supports multiple databases.",
    "They are identical in features and configuration."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is Database Integrity in SQL Server?",
  "options": [
    "The accuracy, validity, and consistency of data enforced by constraints and relationships.",
    "The speed at which a database can process transactions.",
    "A feature that allows data encryption at rest.",
    "The ability to recover data after a crash."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the difference between Data and Information?",
  "options": [
    "Data is raw and unprocessed; Information is structured and meaningful data after processing.",
    "Data and Information are synonyms and used interchangeably.",
    "Information is collected from reports; Data comes from databases only.",
    "Data is always numeric, whereas Information is always textual."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is a Database Schema in SQL Server?",
  "options": [
    "A logical container that defines how database objects like tables and views are organized and grouped.",
    "The physical file structure where database data is stored.",
    "A user account used to access data.",
    "A backup plan configuration setting."
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is a Deadlock in SQL Server?",
  "options": [
    "A condition where two or more processes wait indefinitely for each other to release locks.",
    "A temporary block that resolves automatically after 10 seconds.",
    "A type of syntax error that stops query execution.",
    "A failed login attempt caused by invalid credentials."
  ],
  "answer": 0,
  "time": 20
},
  {
    "q": "What is difference between table and temporary table?",
    "options": [
      "Temporary tables exist permanently unless dropped manually; permanent tables are dropped automatically when session ends.",
      "Permanent tables are stored in the database until dropped; Temporary tables are stored in tempdb and dropped when session ends.",
      "Permanent tables are faster because they use memory; Temporary tables are slower as they use disk space.",
      "Temporary tables cannot be indexed, while permanent tables can."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the difference between TRUNCATE and DELETE statements?",
    "options": [
      "DELETE is a DDL command that removes all rows and resets identity; TRUNCATE is DML and logs each deletion.",
      "TRUNCATE is DDL, logs minimal info, resets identity, and is faster; DELETE is DML, logs every row deletion, and is slower.",
      "TRUNCATE supports WHERE clause while DELETE does not.",
      "Both are identical except for rollback behavior."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is difference between WHERE and HAVING clause?",
    "options": [
      "HAVING filters individual rows before aggregation; WHERE filters after aggregation.",
      "WHERE filters rows before aggregation; HAVING filters aggregated results.",
      "Both WHERE and HAVING can be used interchangeably in SELECT queries.",
      "HAVING is used only with ORDER BY clause."
    ],
    "answer": 1,
    "time": 20
  },
   
  {
    "q": "What is the key difference between Primary Key and Unique Key?",
    "options": [
      "Primary Key allows NULLs, Unique Key does not.",
      "Primary Key enforces non-NULL values and only one per table; Unique Key allows one NULL and multiple per table.",
      "Both Primary and Unique Keys can have multiple NULLs.",
      "Primary Key is used for non-clustered index, Unique Key is used for clustered index."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the key difference between IDENTITY and SEQUENCE?",
    "options": [
      "IDENTITY generates numbers per table; SEQUENCE is a standalone object that can be shared across tables.",
      "SEQUENCE resets automatically on restart; IDENTITY always continues from the last value.",
      "IDENTITY values can be reused automatically; SEQUENCE cannot be reused.",
      "IDENTITY requires explicit creation; SEQUENCE is created by default with each table."
    ],
    "answer": 0,
    "time": 20
  },
  
  {
    "q": "What is the key difference between NVARCHAR and VARCHAR?",
    "options": [
      "NVARCHAR stores Unicode characters using 2 bytes per char; VARCHAR stores non-Unicode using 1 byte per char.",
      "Both store Unicode data but NVARCHAR has smaller storage.",
      "VARCHAR supports emojis while NVARCHAR does not.",
      "NVARCHAR is faster than VARCHAR because it uses less memory."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the key difference between CHAR and VARCHAR?",
    "options": [
      "CHAR uses fixed length; VARCHAR uses variable length and saves space.",
      "VARCHAR is fixed-length while CHAR is variable-length.",
      "Both occupy equal storage regardless of data size.",
      "CHAR allows NULLs; VARCHAR does not."
    ],
    "answer": 0,
    "time": 20
  },

 
  {
    "q": "What is the key difference between View and Indexed View?",
    "options": [
      "Indexed views physically store their result set and use a unique clustered index; Views are only stored queries.",
      "Indexed views are temporary and only allowed on temporary tables.",
      "Views allow data modification; Indexed views do not.",
      "Indexed views cannot be queried directly."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the key difference between Stored Procedure and Function?",
    "options": [
      "Functions can modify data; Procedures cannot modify data.",
      "Stored Procedures can modify data and return multiple result sets; Functions return a single value or table and usually cannot modify data.",
      "Functions can return multiple result sets like Procedures.",
      "Procedures are read-only, Functions can modify tables."
    ],
    "answer": 1,
    "time": 20
  },
  
  {
    "q": "What is the key difference between Subquery and CTE?",
    "options": [
      "A CTE is a named temporary result set that can be referenced multiple times; a Subquery is only defined and used within a single statement.",
      "Subqueries are stored and can be reused across multiple queries; CTEs cannot.",
      "CTEs are always faster than subqueries.",
      "Subqueries are physically materialized like CTEs."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the key difference between UNION and UNION ALL?",
    "options": [
      "UNION removes duplicate rows (slower); UNION ALL retains all rows (faster).",
      "UNION ALL removes duplicates automatically; UNION retains all rows.",
      "Both UNION and UNION ALL remove duplicates.",
      "UNION can be used only with numeric columns; UNION ALL with all types."
    ],
    "answer": 0,
    "time": 20
  },
   
  {
    "q": "What is the key difference between INNER JOIN and OUTER JOIN?",
    "options": [
      "Inner Join returns only matching rows; Outer Join returns matching rows plus non-matching rows from one or both sides.",
      "Outer Join returns only matching rows; Inner Join returns all rows.",
      "Inner Join returns unmatched rows only; Outer Join returns matched rows only.",
      "Both Inner and Outer Joins return all rows regardless of matches."
    ],
    "answer": 0,
    "time": 20
  },
  
  {
    "q": "What is the key difference between SQL and NoSQL?",
    "options": [
      "NoSQL databases are vertically scalable; SQL databases are horizontally scalable.",
      "SQL databases are vertically scalable, schema-rigid, and ideal for complex transactions; NoSQL databases are horizontally scalable, schema-flexible, and ideal for large volumes of unstructured data.",
      "They are completely different and unrelated concepts.",
      "SQL databases are schema-flexible; NoSQL databases are schema-rigid."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is a transaction in SQL Server?",
    "options": [
      "A sequence of one or more SQL statements treated as a single, indivisible unit of work (all succeed or all fail).",
      "A temporary object that holds data only for the current session.",
      "Transactions are only used for backup operations.",
      "A unit of work that can be partially committed."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is ACID in SQL Server?",
    "options": [
      "It is only available in older SQL Server versions.",
      "A set of properties (Atomicity, Consistency, Isolation, Durability) that guarantee database transactions are processed reliably.",
      "ACID refers to the SQL engine optimization settings.",
      "It is a special type of transaction."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is a stored procedure in SQL Server?",
    "options": [
      "A temporary name given to a table or a column.",
      "A named, precompiled set of one or more SQL statements stored in the database.",
      "A command to roll back database changes automatically.",
      "A query that cannot accept parameters."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is a view in SQL Server?",
    "options": [
      "A virtual table based on the result-set of a SQL query.",
      "A temporary name given to a table or a column.",
      "A stored procedure that returns a table.",
      "A method to physically store aggregated data."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is an Index in SQL Server?",
    "options": [
      "A temporary object that holds data only for the current session.",
      "A data structure that improves the speed of data retrieval operations on database tables.",
      "A method to store data redundantly in tempdb.",
      "A type of stored procedure for queries."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is Index Fragmentation?",
    "options": [
      "A condition where index data pages are scattered and not logically ordered, degrading performance.",
      "Index pages are duplicated to improve read speed.",
      "Indexes are stored in memory only.",
      "Index structure is converted into a heap table."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the key difference between Index Rebuild and Index Reorganize?",
    "options": [
      "Rebuild creates a new index and drops the old one; Reorganize physically reorders the leaf-level pages in place.",
      "Reorganize creates a new index; Rebuild modifies the existing one in place.",
      "Both operations are identical and have no performance impact.",
      "Rebuild only works on Non-Clustered Indexes; Reorganize only works on Clustered Indexes."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is Fill Factor in SQL Server Index?",
    "options": [
      "It is a value from 0 to 100 that specifies the percentage of space to leave empty on each leaf-level page.",
      "Fill Factor determines the maximum number of indexes on a table.",
      "It sets the CPU utilization for index creation.",
      "Fill Factor is the total memory allocated to an index."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is Covered Index in SQL Server?",
    "options": [
      "An index that includes all the columns requested in the query, allowing the query to complete without looking up the data row.",
      "An index that is stored only in tempdb.",
      "An index used only for primary keys.",
      "A clustered index that covers multiple tables."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is Dynamic SQL in SQL Server?",
    "options": [
      "Dynamic SQL is generated at runtime and is prone to SQL injection; Static SQL is precompiled and safe.",
      "Dynamic SQL cannot accept parameters or variables.",
      "Dynamic SQL is executed only once per database.",
      "It refers to system-generated temporary tables."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "How to execute Dynamic SQL in SQL Server?",
    "options": [
      "Using the `EXEC` or `sp_executesql` command.",
      "By creating a temporary table first.",
      "Dynamic SQL executes automatically when a query runs.",
      "It is not supported in SQL Server."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the key difference between EXECUTE and sp_executesql?",
    "options": [
      "`sp_executesql` supports parameterized queries, which improves security (prevents SQL injection) and execution plan reuse.",
      "EXEC supports parameterized queries while sp_executesql does not.",
      "EXEC is only for dynamic SQL; sp_executesql is only for static SQL.",
      "Both are identical in functionality and performance."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is Isolation Level in SQL Server?",
    "options": [
      "The set of rules that governs how transactions interact with each other, affecting concurrency and data integrity.",
      "It defines the physical storage of indexes in the database.",
      "It determines which users can execute a transaction.",
      "Isolation Level is only relevant for NoSQL databases."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What are the Isolation Levels in SQL Server?",
    "options": [
      "Read Uncommitted, Read Committed, Repeatable Read, Serializable, and Snapshot.",
      "Isolation levels determine the maximum number of concurrent connections.",
      "Serializable and Repeatable Read are the only isolation levels.",
      "Isolation levels are used only for backup transactions."
    ],
    "answer": 0,
    "time": 20
  },
 
  {
    "q": "What is Cursor in SQL Server?",
    "options": [
      "A database control structure used to traverse and process records from a result set one row at a time.",
      "A special type of index that speeds up queries.",
      "A temporary table created in memory.",
      "A method to enforce primary key constraints."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is difference between CHAR and VARCHAR?",
    "options": [
      "`VARCHAR` is variable length and stores only necessary bytes; `CHAR` is fixed length and always uses the declared size.",
      "CHAR stores Unicode; VARCHAR stores only ASCII.",
      "VARCHAR can store more than 8000 characters; CHAR cannot.",
      "CHAR automatically trims trailing spaces; VARCHAR does not."
    ],
    "answer": 0,
    "time": 20
  },
  
  {
    "q": "What is difference between Normalization and Denormalization?",
    "options": [
      "Normalization reduces data redundancy, improving integrity but potentially slowing reads; Denormalization adds redundancy to improve query speed (reads).",
      "Normalization merges tables; Denormalization splits tables.",
      "Denormalization eliminates all null values; Normalization allows them.",
      "Normalization is only used in NoSQL databases."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is difference between DDL and DML?",
    "options": [
      "DDL (Data Definition Language) manages structure/objects (CREATE, ALTER, DROP); DML (Data Manipulation Language) manages data/rows (INSERT, UPDATE, DELETE).",
      "DDL only works on temporary tables; DML works on permanent tables.",
      "DML can modify schema; DDL cannot modify data.",
      "DDL is deprecated in SQL Server 2019."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is difference between Primary Key and Unique Key?",
    "options": [
      "Primary Key enforces non-NULL values and allows only one per table; Unique Key allows one NULL value and multiple per table.",
      "Unique Key can never be null; Primary Key can have multiple nulls.",
      "Primary Key allows duplicates; Unique Key does not.",
      "Unique Key is used only for temporary tables."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is difference between User and Login?",
    "options": [
      "A Login is a server-level identity used for connection; a User is a database-level identity used for permissions.",
      "User can connect to SQL Server; Login cannot.",
      "Login is for temporary tables only; User is for permanent tables.",
      "Both are synonyms and used interchangeably."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is a CTE in SQL Server?",
    "options": [
      "Common Table Expression (CTE) is a named temporary result set defined within the execution scope of a single statement.",
      "A permanent table created dynamically during query execution.",
      "A special type of index to optimize queries.",
      "A stored procedure that returns multiple tables."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is a recursive CTE in SQL Server?",
    "options": [
      "A CTE that references itself, used to query hierarchical or tree-structured data.",
      "A CTE that runs only once per session.",
      "A temporary table stored in memory.",
      "A CTE used for creating indexes."
    ],
    "answer": 0,
    "time": 20
  }, 
  
  {
    "q": "What is the key difference between ROW_NUMBER(), RANK() and DENSE_RANK()?",
    "options": [
      "`ROW_NUMBER()` assigns unique, sequential number; `RANK()` assigns rank with gaps for ties; `DENSE_RANK()` assigns rank without gaps for ties.",
      "`RANK()` ignores ties; ROW_NUMBER() creates duplicates.",
      "`DENSE_RANK()` skips numbers for non-matching rows.",
      "ROW_NUMBER() is only used in temporary tables."
    ],
    "answer": 0,
    "time": 20
  },
  
  {
    "q": "What is the key difference between Clustered Index and Non-Clustered Index?",
    "options": [
      "A Clustered Index determines the physical order of data (data at leaf level); a Non-Clustered Index is separate from data and uses pointers.",
      "Non-Clustered Index stores data physically; Clustered Index does not.",
      "Clustered Index can only be created on temporary tables.",
      "They are identical and interchangeable."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is Cross Join in SQL Server?",
    "options": [
      "A join that returns the Cartesian product of the rows from the tables in the join.",
      "A join that only returns matching rows.",
      "A join that merges tables physically.",
      "A join that can be applied only to indexed tables."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What are Data Types in SQL Server?",
    "options": [
      "A specification that identifies the type of data a column can hold (e.g., INT, VARCHAR, DATE).",
      "Rules to create indexes for tables.",
      "A type of temporary table in memory.",
      "Constraints applied to enforce primary keys."
    ],
    "answer": 0,
    "time": 20
  },
  
  {
    "q": "What is the key difference between GETDATE() and SYSDATETIME()?",
    "options": [
      "`GETDATE()` returns the current date/time with a precision of 3 milliseconds; `SYSDATETIME()` returns the current date/time with a higher precision of 100 nanoseconds.",
      "`GETDATE()` returns UTC; `SYSDATETIME()` returns local time.",
      "`SYSDATETIME()` is deprecated; `GETDATE()` is recommended.",
      "Both always return the same values and precision."
    ],
    "answer": 0,
    "time": 20
  },
  
  
  {
    "q": "What is the STRING_AGG function in SQL Server?",
    "options": [
      "A function that returns a single string by concatenating the values of string expressions and placing separator values between them.",
      "A function to split strings into rows.",
      "A function that counts distinct strings in a table.",
      "A function to generate sequential numbers."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the key difference between Subquery and CTE?",
    "options": [
      "A CTE is a named temporary result set that can be referenced multiple times; a Subquery is only defined and used within a single statement.",
      "A Subquery is always faster than a CTE.",
      "CTEs can only return single columns; Subqueries can return multiple columns.",
      "Subqueries are temporary tables; CTEs are permanent tables."
    ],
    "answer": 0,
    "time": 20
  },
  
   
  {
    "q": "What are the types of Execution Plan?",
    "options": [
      "Estimated Plan (before execution) and Actual Plan (after execution).",
      "Simple Plan and Complex Plan.",
      "Clustered Plan and Non-Clustered Plan.",
      "Logical Plan and Physical Plan only."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "How to generate an Execution Plan?",
    "options": [
      "By using `SET SHOWPLAN_ALL ON` or using the graphical display tools in SQL Server Management Studio (SSMS).",
      "By creating a temporary table with execution details.",
      "By running `DBCC CHECKDB` on the database.",
      "By enabling TRACE flag 1111."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What is the key difference between Real and Estimated Execution Plan?",
    "options": [
      "Real Plan includes runtime statistics (actual rows, time); Estimated Plan does not (based on statistics only).",
      "Estimated Plan includes actual runtime data; Real Plan does not.",
      "Real Plan is generated for temp tables only.",
      "There is no difference; both are identical."
    ],
    "answer": 0,
    "time": 20
  },
  
  {
    "q": "You need to convert an existing primary key column into an IDENTITY. The table has 50 million rows and cannot afford downtime. Which approach is correct?",
    "options": [
      "Use ALTER COLUMN to enable IDENTITY on existing column.",
      "Create a new table with IDENTITY, migrate data in chunks, then rename.",
      "Drop primary key and apply IDENTITY directly.",
      "Turn on IDENTITY_INSERT to convert the column."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer added a new IDENTITY column using ALTER TABLE. But the table already had 5 million rows. The new IDENTITY values started from 1. What should they have done?",
    "options": [
      "Manually update IDENTITY values after creation.",
      "Use IDENTITY(start, increment) inside ALTER TABLE.",
      "Specify IDENTITY seed using DBCC CHECKIDENT.",
      "Identity values are always correct; no change needed."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "An ETL process truncates a table before inserting new data. The IDENTITY column keeps increasing endlessly. How can you reset identity each load?",
    "options": [
      "Run ALTER TABLE RESET IDENTITY.",
      "Run DBCC CHECKIDENT('table', RESEED, 0).",
      "Recreate the table each time.",
      "Identity cannot be reset once generated."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need to add a NOT NULL column to a table with 120 million rows. What is the most efficient method?",
    "options": [
      "ALTER TABLE ADD column NOT NULL DEFAULT value WITH VALUES.",
      "Add column as NULL, update in batches, then change to NOT NULL.",
      "Add the column with NOT NULL directly and let SQL Server update all rows instantly.",
      "Drop the table and recreate it with the new schema."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer runs: ALTER TABLE Users ADD Age INT NOT NULL; and gets an error. Why?",
    "options": [
      "INT cannot be used with NOT NULL.",
      "The table already has a primary key.",
      "Table has rows and no default was provided.",
      "NOT NULL columns require a computed value."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "A SEQUENCE is used by 3 tables for ID generation. Suddenly IDs are skipping numbers. Why?",
    "options": [
      "SEQUENCE objects never skip values.",
      "SQL Server restarts sequences automatically.",
      "Values were preallocated and lost due to rollback.",
      "SEQUENCE was accidentally deleted."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "You created a SEQUENCE with CACHE 100. After a SQL Server crash, the next value jumps by 100. Why?",
    "options": [
      "The SEQUENCE is corrupted.",
      "CACHE values are stored in memory and lost on crash.",
      "SQL Server recalculates based on row count.",
      "CACHE forces the sequence to restart randomly."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You want a SEQUENCE to generate numbers only between 1 and 999 and then restart automatically. Which option is correct?",
    "options": [
      "Use IDENTITY instead of SEQUENCE.",
      "Use: CREATE SEQUENCE ... CYCLE;",
      "Use: ALTER SEQUENCE ... RESET ALWAYS;",
      "Run DBCC CHECKIDENT after every cycle."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "After reseeding a SEQUENCE using RESTART WITH 1, you still see a higher value generated. Why?",
    "options": [
      "RESTART WITH works only when a SEQUENCE is empty.",
      "Another session cached SEQUENCE values before restart.",
      "SEQUENCE cannot restart once used.",
      "SQL Server delays reset until service restart."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which scenario requires a SEQUENCE rather than IDENTITY?",
    "options": [
      "You need a counter per table.",
      "You need numbers only when rows are inserted.",
      "You need numbers shared across multiple tables.",
      "You need values reset automatically each day."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "During migration, you need to keep the exact same IDENTITY values in the new table. What should you do?",
    "options": [
      "Disable IDENTITY temporarily.",
      "Use IDENTITY_INSERT ON.",
      "Copy without specifying identity column.",
      "Change IDENTITY to SEQUENCE."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You added a NOT NULL column with default value. The update took 30 minutes. How can you improve performance?",
    "options": [
      "Use SP_RECOMPILE before adding column.",
      "Use a computed column instead.",
      "Add column as NULL → update in batches → apply NOT NULL.",
      "Restart SQL Server to free memory."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "You must guarantee that invoice numbers never have gaps. Which solution works?",
    "options": [
      "Use SEQUENCE with CACHE OFF.",
      "Use IDENTITY with log backups.",
      "Use custom table-based generator with serialization.",
      "Use SEQUENCE with CYCLE ON."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "A SEQUENCE starts generating negative values. Why?",
    "options": [
      "SEQUENCE is corrupted.",
      "START WITH was set to 0.",
      "INCREMENT BY was negative.",
      "MAXVALUE was removed automatically."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "You use NEXT VALUE FOR a SEQUENCE inside a multi-row insert SELECT. How are values assigned?",
    "options": [
      "Same number to all rows.",
      "Each row gets the next sequence value.",
      "Only first row gets a value.",
      "Values assigned randomly."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "After truncating a table with IDENTITY, what happens?",
    "options": [
      "IDENTITY resets automatically.",
      "IDENTITY continues from last value.",
      "IDENTITY becomes NULL until reseeded.",
      "IDENTITY is converted to a SEQUENCE."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "You need to add a NOT NULL column with zero downtime. What is the best method?",
    "options": [
      "Add NOT NULL directly during peak hours.",
      "Add column as NULL, fill in batches, then switch to NOT NULL.",
      "Restart SQL Server to free locks.",
      "Remove all indexes first."
    ],
    "answer": 1,
    "time": 20
  }
  ,
    {
    "q": "Which command is used to drop a SEQUENCE object in SQL Server?",
    "options": [
      "REMOVE SEQUENCE seq_name",
      "DELETE SEQUENCE seq_name",
      "DROP SEQUENCE seq_name",
      "TRUNCATE SEQUENCE seq_name"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "How do you generate the next value of a SEQUENCE object?",
    "options": [
      "SELECT VALUE FROM dbo.SequenceObject;",
      "SELECT NEXT VALUE FOR dbo.SequenceObject;",
      "EXEC NEXT dbo.SequenceObject;",
      "SELECT NEWID() FROM dbo.SequenceObject;"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "How do you retrieve metadata including the current value of a sequence?",
    "options": [
      "SELECT CURRENT_VALUE FROM dbo.SequenceObject;",
      "SELECT NEXT VALUE FOR dbo.SequenceObject;",
      "SELECT * FROM sys.sequence_stats;",
      "SELECT * FROM sys.sequences WHERE name = 'SequenceObject';"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "A sequence dbo.InvoiceSeq is created with START WITH 1 INCREMENT BY 1. What will be the first value returned by NEXT VALUE FOR?",
    "options": [
      "0",
      "1",
      "2",
      "NULL"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You insert rows into a table using NEXT VALUE FOR dbo.InvoiceSeq. What happens to the sequence values?",
    "options": [
      "They always start from 1 each day.",
      "They generate values independently of table rows.",
      "They reset after every INSERT.",
      "They depend on row count in the table."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You created a sequence with: START WITH 1000 INCREMENT BY 10. What will be the next values?",
    "options": [
      "1000, 1001, 1002",
      "1000, 1005, 1010",
      "1000, 1010, 1020",
      "1000, 1000, 1000"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "You restart a sequence using: ALTER SEQUENCE dbo.InvoiceSeq RESTART WITH 1. What does the next call return?",
    "options": [
      "The last used value again",
      "0",
      "1",
      "NULL"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "A single sequence dbo.InvoiceSeq is used by two tables: Sales and Returns. What is the behavior?",
    "options": [
      "Each table gets its own independent numbering.",
      "The sequence generates shared values across both tables.",
      "The sequence resets after switching tables.",
      "The sequence generates random values."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the correct syntax to add a Primary Key to an existing table?",
    "options": [
      "ALTER TABLE deu SET PRIMARY KEY(id);",
      "ALTER TABLE deu ADD PRIMARY KEY(id);",
      "ALTER TABLE deu MAKE PRIMARY KEY(id);",
      "ALTER TABLE deu ENABLE PRIMARY KEY(id);"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the recommended way to add a primary key to an existing table?",
    "options": [
      "ALTER TABLE table_name ADD PRIMARY KEY(id);",
      "ALTER TABLE table_name ADD CONSTRAINT pk_name PRIMARY KEY(id);",
      "CREATE PRIMARY KEY ON table_name(id);",
      "PRIMARY KEY can only be created during table creation."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Why is adding a named primary key constraint recommended?",
    "options": [
      "It is required by SQL Server.",
      "It improves data type performance.",
      "It helps with maintainability and allows easier constraint management.",
      "It avoids NULL values automatically."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "How many ways can a primary key be defined in SQL Server?",
    "options": [
      "Only during table creation.",
      "Only using ALTER TABLE.",
      "Two ways: during creation or using ALTER TABLE.",
      "Three ways: creation, ALTER, or UPDATE statement."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which of these is a valid inline primary key declaration?",
    "options": [
      "EmpID INT KEY PRIMARY",
      "EmpID INT PRIMARY KEY",
      "EmpID PRIMARY KEY INT",
      "PRIMARY KEY INT EmpID"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What happens if you try to add a primary key on a column that contains duplicate values?",
    "options": [
      "SQL Server auto-removes duplicates.",
      "SQL Server converts duplicates into NULL.",
      "The statement fails with an error.",
      "The latest value overrides earlier duplicates."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which statement correctly adds a primary key to Employees(EmpID) after table creation?",
    "options": [
      "ALTER TABLE Employees PRIMARY KEY (EmpID);",
      "ADD PRIMARY KEY TO Employees(EmpID);",
      "ALTER TABLE Employees ADD CONSTRAINT pk_Emp PRIMARY KEY (EmpID);",
      "CREATE PRIMARY KEY Employees(EmpID);"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "You created a sequence for invoice numbers, but you need the first value to start at 5000. Which creation syntax is valid?",
    "options": [
      "CREATE SEQUENCE InvoiceSeq START 5000;",
      "CREATE SEQUENCE InvoiceSeq BEGIN 5000;",
      "CREATE SEQUENCE InvoiceSeq START WITH 5000;",
      "CREATE SEQUENCE InvoiceSeq SEED 5000;"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which operation does NOT affect a sequence object?",
    "options": [
      "TRUNCATE TABLE users;",
      "ALTER SEQUENCE RESTART WITH;",
      "DELETE FROM table using the sequence;",
      "Restarting SQL Server"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What happens when a SEQUENCE is created with CACHE 100?",
    "options": [
      "SQL Server stores 100 values on disk for fast restart.",
      "SQL Server pre-allocates 100 values in memory.",
      "SQL Server generates values in blocks of 100 always.",
      "The sequence always increments by 100."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "If a sequence is created without MINVALUE or MAXVALUE, what range does SQL Server use?",
    "options": [
      "1 to 1 billion",
      "0 to 1 million",
      "Full range of the data type (e.g., INT)",
      "It depends on SQL Server version"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "You call NEXT VALUE FOR a sequence inside a multi-row INSERT. How are numbers generated?",
    "options": [
      "Only one value is generated for all rows.",
      "Values are repeated per row.",
      "Each row receives a unique next value.",
      "Sequence values restart automatically."
    ],
    "answer": 2,
    "time": 20
  }
,
{
  "q": "Which is the correct syntax to add a Foreign Key to an existing table?",
  "options": [
    "ALTER TABLE table_name SET FOREIGN KEY (col) REFERENCES parent(col);",
    "ALTER TABLE table_name ADD FOREIGN KEY (col) REFERENCES parent(col);",
    "ALTER TABLE table_name ADD CONSTRAINT fk_name FOREIGN KEY (col) REFERENCES parent(col);",
    "ALTER TABLE table_name MODIFY FOREIGN KEY (col) REFERENCES parent(col);"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "A Foreign Key in SQL Server ensures which rule?",
  "options": [
    "Enforces uniqueness on the child column",
    "Prevents duplicate values in the child column",
    "Ensures each value in child exists in parent table",
    "Prevents INSERT operations on the parent table"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Does a Foreign Key allow duplicate values in the child table?",
  "options": [
    "No, duplicates are not allowed",
    "Yes, duplicates are allowed unless UNIQUE is applied",
    "Yes, duplicates are allowed only if parent table has duplicates",
    "Duplicates are allowed only with CASCADE options"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why does this error occur? 'The DELETE statement conflicted with the REFERENCE constraint...'",
  "options": [
    "Parent table has NULL values",
    "Child table has rows referencing the parent row being deleted",
    "Foreign Key was created incorrectly",
    "Primary Key is not indexed"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "How do you fix a DELETE conflict caused by a Foreign Key?",
  "options": [
    "Drop the primary key",
    "Disable constraints permanently",
    "Delete child rows first or use ON DELETE CASCADE",
    "Run CHECKPOINT before deleting"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What is wrong with: ALTER TABLE primarykeytest ADD CONSTRAINT defaultcontraint DEFAULT id NOT NULL",
  "options": [
    "DEFAULT must reference a column using FOR clause",
    "DEFAULT cannot be added to an existing table",
    "NOT NULL cannot be used in DEFAULT definition",
    "Both A and C are correct"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "What is the correct way to add a default value of 0 to a column?",
  "options": [
    "ALTER TABLE t ADD DEFAULT 0;",
    "ALTER TABLE t MODIFY DEFAULT 0 FOR id;",
    "ALTER TABLE t ADD CONSTRAINT d_id DEFAULT 0 FOR id;",
    "ALTER TABLE t ALTER COLUMN id SET DEFAULT 0;"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which statement correctly creates a table with a Foreign Key?",
  "options": [
    "CREATE TABLE Orders (OrderID INT PRIMARY KEY, PersonID INT REFERENCES Persons(PersonID));",
    "CREATE TABLE Orders (OrderID INT PRIMARY KEY, PersonID INT FOREIGN KEY Persons(PersonID));",
    "CREATE TABLE Orders (OrderID INT PRIMARY KEY, PersonID INT ADD FOREIGN KEY REFERENCES Persons(PersonID));",
    "CREATE TABLE Orders (OrderID INT PRIMARY KEY, FOREIGN KEY PersonID REFERENCES Persons(PersonID));"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which command drops a foreign key constraint?",
  "options": [
    "ALTER TABLE Orders REMOVE FOREIGN KEY fk_name;",
    "DROP FOREIGN KEY fk_name FROM Orders;",
    "ALTER TABLE Orders DROP CONSTRAINT fk_name;",
    "ALTER TABLE Orders DELETE FOREIGN KEY fk_name;"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Can a table have multiple Foreign Keys?",
  "options": [
    "No",
    "Yes, but only if referencing same parent table",
    "Yes, a table can have multiple Foreign Keys to different tables",
    "Yes, but only one can be active at a time"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Can a Foreign Key reference a UNIQUE column instead of a Primary Key?",
  "options": [
    "No, only Primary Key is allowed",
    "Yes, as long as the column is indexed",
    "Yes, Foreign Key can reference UNIQUE constraint columns",
    "Only if the UNIQUE column is not nullable"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Can a Foreign Key column contain NULL values?",
  "options": [
    "No, never",
    "Yes, NULLs are allowed unless NOT NULL is defined",
    "Yes, but only if referenced column has NULLs",
    "Only for temporary tables"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Can a composite Primary Key be referenced by a Foreign Key?",
  "options": [
    "No, SQL Server does not allow this",
    "Yes, but only if referencing one of the columns",
    "Yes, but the FK must include all columns of the composite PK",
    "Only if composite PK has identity columns"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What happens when ON DELETE CASCADE is defined on a Foreign Key?",
  "options": [
    "Parent cannot be deleted",
    "Deleting parent deletes all related child rows",
    "Child rows are set to NULL",
    "SQL Server ignores delete operations"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What does ON UPDATE CASCADE do?",
  "options": [
    "Updates parent rows when child rows change",
    "Prevents updates on parent",
    "Automatically updates child rows when the referenced parent column changes",
    "Resets child rows to default value"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which statement creates a schema?",
  "options": [
    "ADD SCHEMA Sales;",
    "NEW SCHEMA Sales;",
    "CREATE SCHEMA Sales;",
    "CREATE NEW Sales SCHEMA;"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "How do you list all schemas in SQL Server?",
  "options": [
    "SELECT * FROM sys.databases;",
    "SELECT * FROM sys.schemas;",
    "SELECT SCHEMAS();",
    "EXEC sp_list_schemas;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is a schema in SQL Server?",
  "options": [
    "A file storing table metadata",
    "A logical container grouping database objects",
    "A synonym for a table",
    "A reserved keyword for constraints"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which command copies table structure and data from another database?",
  "options": [
    "CREATE TABLE new AS SELECT * FROM old;",
    "SELECT INTO newDB.dbo.Table FROM oldDB.dbo.Table;",
    "COPY TABLE old TO new;",
    "INSERT TABLE new SELECT FROM old;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which method copies a table WITH constraints and indexes?",
  "options": [
    "SELECT INTO",
    "INSERT INTO SELECT",
    "Generate Scripts Wizard",
    "Linked Server SELECT"
  ],
  "answer": 2,
  "time": 20
}
,
{
  "q": "You try to delete a row from a parent table, but SQL Server blocks it. The child table has no rows referencing it. What is the MOST LIKELY reason?",
  "options": [
    "Foreign key is disabled",
    "Foreign key has NOT FOR REPLICATION set",
    "Foreign key uses a trigger instead of real constraint",
    "There is another child table referencing the same row"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which action will prevent inserting a child row if the parent key does not exist?",
  "options": [
    "CHECK constraint",
    "UNIQUE constraint",
    "FOREIGN KEY constraint",
    "DEFAULT constraint"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "You need to temporarily allow deleting parent rows even if child rows exist, but without losing data integrity. Which approach is BEST?",
  "options": [
    "Drop the foreign key",
    "Disable the foreign key, perform delete, re-enable with CHECK",
    "Add ON DELETE CASCADE",
    "Set the child column to NULL"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What happens when a foreign key is disabled using: ALTER TABLE t NOCHECK CONSTRAINT fk?",
  "options": [
    "Existing data is validated but new inserts are not checked",
    "Both existing and new data skip validation",
    "Constraint is deleted",
    "Constraint is paused only for DELETE operations"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which command re-validates existing data after re-enabling a foreign key?",
  "options": [
    "ALTER TABLE t CHECK CONSTRAINT fk;",
    "ENABLE FOREIGN KEY fk;",
    "EXEC sp_check_foreignkey fk;",
    "ALTER TABLE t VALIDATE CONSTRAINT fk;"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "A child table allows NULL in FK column. What happens when parent row is deleted and FK is NOT NULL?",
  "options": [
    "Child row is deleted automatically",
    "Delete statement fails",
    "Child value is set to default",
    "Child value becomes orphaned"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which is TRUE about ON UPDATE CASCADE?",
  "options": [
    "It is rarely triggered because PK values usually don't change",
    "It updates all numeric columns in the child table",
    "It works only if parent table has identity column",
    "It prevents updating parent rows"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "You try creating a foreign key but receive: 'The ALTER TABLE statement conflicted with the FOREIGN KEY constraint'. What caused this?",
  "options": [
    "The child column contains NULL values",
    "Existing child rows have values not present in parent table",
    "Parent table has duplicate Primary Keys",
    "Constraint name already exists"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What happens when you run: ALTER TABLE t1 ADD CONSTRAINT fk FOREIGN KEY (a) REFERENCES t2(b) ON DELETE SET NULL;",
  "options": [
    "Parent deletion is blocked",
    "Child row is deleted",
    "Child column is set to NULL",
    "Constraint is ignored during delete"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "In SQL Server, how can you find all foreign keys referencing a table?",
  "options": [
    "SELECT * FROM sys.foreign_keys WHERE table = 't';",
    "EXEC sp_help 't';",
    "SELECT * FROM sys.foreign_keys WHERE referenced_object_id = OBJECT_ID('t');",
    "EXEC sp_check_constraints 't';"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What happens if a DEFAULT constraint is added to a column with existing NULL values?",
  "options": [
    "NULL values are automatically replaced",
    "Only new inserts get default values",
    "Existing data is blocked until updated",
    "Column becomes NOT NULL automatically"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement is TRUE about schemas?",
  "options": [
    "Each table must belong to a unique schema",
    "Schemas automatically replicate across databases",
    "Schema is a container that can group tables and procedures",
    "Schema names must match login names"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which command creates a table in another database using SELECT INTO?",
  "options": [
    "SELECT INTO Orders FROM Sales.Orders;",
    "SELECT * INTO NewDB.dbo.Orders FROM OldDB.dbo.Orders;",
    "INSERT INTO NewDB.dbo.Orders SELECT * FROM OldDB.dbo.Orders;",
    "COPY OldDB.Sales.Orders TO NewDB.Sales.Orders;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which method keeps indexes, defaults, and constraints when copying a table to another database?",
  "options": [
    "SELECT INTO",
    "INSERT INTO SELECT",
    "SSMS Generate Scripts with 'Schema and Data'",
    "Bulk Copy Program (bcp)"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which scenario REQUIRES using Linked Servers?",
  "options": [
    "Copying data between tables in same database",
    "Copying table from one schema to another",
    "Copying data between two SQL Servers",
    "Backing up the database"
  ],
  "answer": 2,
  "time": 20
}
,
{
  "q": "Which command in SQL Server provides the MOST comprehensive details about a table including columns, data types, constraints, and indexes?",
  "options": [
    "EXEC sp_columns table_name;",
    "SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'table_name';",
    "EXEC sp_help table_name;",
    "SELECT name FROM sys.columns WHERE object_id = OBJECT_ID('table_name');"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What does pressing ALT + F1 on a table in SSMS do?",
  "options": [
    "Drops the table",
    "Displays full table metadata similar to sp_help",
    "Shows only column names",
    "Shows only foreign keys"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which method allows exporting SQL Server data directly into an Excel sheet using SQL syntax?",
  "options": [
    "SSIS package",
    "OPENROWSET",
    "bcp command",
    "Generate Scripts Wizard"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which export method is best for very large datasets?",
  "options": [
    "SSMS Export Wizard",
    "SSIS",
    "OPENROWSET",
    "bcp (Bulk Copy Program)"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "How do you correctly insert the string 'John O'Reilly' into a table?",
  "options": [
    "INSERT INTO t VALUES ('John O'Reilly');",
    "INSERT INTO t VALUES ('John O\\'Reilly');",
    "INSERT INTO t VALUES ('John O''Reilly');",
    "INSERT INTO t VALUES ('John \"O'Reilly\"');"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which command correctly changes a column's data type?",
  "options": [
    "MODIFY COLUMN table.col newtype;",
    "ALTER TABLE table ALTER COLUMN col newtype;",
    "CHANGE DATATYPE table.col newtype;",
    "UPDATE DATATYPE table.col newtype;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "You need to reduce VARCHAR(200) to VARCHAR(50) safely. What is the best approach?",
  "options": [
    "ALTER TABLE t ALTER COLUMN col VARCHAR(50);",
    "Use SSMS design mode and save",
    "Create a new column, copy data, drop old column, rename new column",
    "Shrink database size first then alter column"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which is the recommended way to rename a database?",
  "options": [
    "EXEC sp_renamedb old, new;",
    "EXEC sp_rename old, new;",
    "ALTER DATABASE old MODIFY NAME = new;",
    "UPDATE sys.databases SET name = new WHERE name = old;"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which function returns the SQL Server login name for the current session?",
  "options": [
    "CURRENT_USER",
    "USER_NAME()",
    "SESSION_USER",
    "SYSTEM_USER"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which statement transfers a table from dbo schema to Sales schema?",
  "options": [
    "MOVE dbo.Table TO Sales;",
    "ALTER TABLE dbo.Table SET SCHEMA Sales;",
    "ALTER SCHEMA Sales TRANSFER dbo.Table;",
    "EXEC sp_transfer_schema dbo.Table, Sales;"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which catalog view lists all server-level logins?",
  "options": [
    "sys.database_principals",
    "sys.server_principals",
    "sys.sql_logins",
    "sys.sysusers"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What does this query return? SELECT * FROM sys.database_principals;",
  "options": [
    "All server logins",
    "All database users, roles, and application roles",
    "Only schema owners",
    "Only SQL authenticated logins"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "How do you view all databases in SQL Server?",
  "options": [
    "SELECT * FROM sys.objects;",
    "EXEC sp_databases;",
    "SELECT name FROM sys.tables;",
    "EXEC sp_tables;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which command lists ALL constraints in a table?",
  "options": [
    "SELECT * FROM sys.columns WHERE constraint = 1;",
    "EXEC sp_helpconstraint 'table';",
    "SELECT * FROM sys.objects WHERE type='C';",
    "SELECT * FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following lists all tables in the current database?",
  "options": [
    "SELECT * FROM sys.tables;",
    "SELECT * FROM sys.databases;",
    "SELECT * FROM INFORMATION_SCHEMA.DATABASES;",
    "EXEC sp_tables WHERE type='TABLE';"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "You want to view Orders table from SalesDB while connected to MasterDB. Which query works?",
  "options": [
    "SELECT * FROM Orders;",
    "USE SalesDB; SELECT * FROM Orders;",
    "SELECT * FROM SalesDB.dbo.Orders;",
    "SELECT Orders FROM SalesDB;"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which is TRUE about SQL Server constraints?",
  "options": [
    "NOT NULL and PRIMARY KEY are the same",
    "Constraints enforce rules to maintain data integrity",
    "Constraints only apply during INSERT but not UPDATE",
    "DEFAULT constraints prevent duplicate values"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which constraint ensures values meet a specific rule such as Salary > 0?",
  "options": [
    "DEFAULT",
    "CHECK",
    "UNIQUE",
    "FOREIGN KEY"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which constraint ensures a column cannot have NULL values?",
  "options": [
    "CHECK",
    "DEFAULT",
    "NOT NULL",
    "UNIQUE"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which constraint guarantees uniqueness across one or more columns?",
  "options": [
    "CHECK",
    "DEFAULT",
    "PRIMARY KEY",
    "UNIQUE"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which constraint implies both NOT NULL and UNIQUE?",
  "options": [
    "CHECK",
    "UNIQUE",
    "PRIMARY KEY",
    "FOREIGN KEY"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which is the BEST reason to use a schema?",
  "options": [
    "Improve query performance by increasing indexing",
    "Group related objects and manage permissions",
    "Reduce table size",
    "Store backup copies of tables"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which method allows exporting structure AND data together?",
  "options": [
    "bcp",
    "OPENROWSET",
    "Generate Scripts Wizard with 'Schema and Data'",
    "SSIS"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What does this SSMS action do: Right-click → Tasks → Generate Scripts → Script Data?",
  "options": [
    "Exports only the table structure",
    "Exports only data",
    "Exports both table structure and data",
    "Exports constraints only"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which statement is TRUE about ESCAPING single quotes?",
  "options": [
    "Use \\ to escape quotes",
    "Use two single quotes '' to represent one quote",
    "Use backticks to escape quotes",
    "SQL Server automatically escapes quotes"
  ],
  "answer": 1,
  "time": 20
}
,
{
  "q": "Which statement correctly generates the next value from a Sequence named InvoiceSeq?",
  "options": [
    "SELECT * FROM NEXT VALUE OF InvoiceSeq;",
    "SELECT NEXT VALUE FOR InvoiceSeq;",
    "EXEC NEXT VALUE InvoiceSeq;",
    "SELECT NEXT FROM InvoiceSeq;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "You created a sequence that starts at 100 and increments by 5. What will be the second generated value?",
  "options": [
    "100",
    "105",
    "110",
    "115"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which query returns sequence details including current value?",
  "options": [
    "SELECT * FROM INFORMATION_SCHEMA.SEQUENCES;",
    "SELECT * FROM sys.objects WHERE type='SQ';",
    "SELECT * FROM sys.sequences WHERE name='InvoiceSeq';",
    "EXEC sp_helpsequence 'InvoiceSeq';"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "How do you restart a sequence named TicketSeq with a value of 1?",
  "options": [
    "ALTER SEQUENCE TicketSeq RESTART WITH 1;",
    "RESET SEQUENCE TicketSeq TO 1;",
    "MODIFY SEQUENCE TicketSeq START 1;",
    "ALTER TicketSeq START WITH 1;"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "A sequence is used in two tables: Sales and Returns. What issue can occur?",
  "options": [
    "Duplicate numbers in both tables",
    "Sequence resets automatically per table",
    "Sequence generates global unique numbers with no duplicates",
    "Sequence cannot be shared between tables"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which method describes table structure including constraints, data types, and indexes?",
  "options": [
    "EXEC sp_help table_name",
    "SELECT * FROM sys.indexes",
    "SELECT * FROM sys.parameters",
    "EXEC sp_databases"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which SQL command exports data to Excel using command-line tools?",
  "options": [
    "SQLCMD EXPORT ...",
    "bcp \"SELECT * FROM Employees\" queryout \"C:\\Employees.csv\" -c -t, -T",
    "EXPORT TABLE Employees TO EXCEL",
    "sp_export_excel 'Employees'"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which stored procedure command inserts employee data only after validating input, and catches errors?",
  "options": [
    "Using TRY...CATCH inside procedure",
    "Using IF ERROR THEN",
    "Using PROC VALIDATION ON",
    "SQL Server does not support error handling"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which statement is TRUE about Stored Procedures?",
  "options": [
    "They always return exactly one value",
    "They cannot contain multiple SELECT result sets",
    "They reduce network traffic because only procedure call is sent",
    "They cannot call other stored procedures"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which of the following allows dynamic SQL execution with parameters?",
  "options": [
    "EXEC SQL",
    "sp_executesql",
    "sp_runSQL",
    "EXECUTE_DYNAMIC"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is returned when inserting a string longer than column size?",
  "options": [
    "Data gets truncated and inserted",
    "Error: String or binary data would be truncated",
    "SQL automatically resizes column",
    "Insert succeeds but warns only in logs"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the correct way to escape a single quote inside a string?",
  "options": [
    "Use backslash: D\'Mello",
    "Use double quote: D\"Mello",
    "Use two single quotes: D''Mello",
    "No escape needed"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which ALTER TABLE command correctly changes a VARCHAR column to NVARCHAR?",
  "options": [
    "ALTER COLUMN table MODIFY col NVARCHAR(50);",
    "ALTER TABLE table_name ALTER COLUMN col NVARCHAR(50);",
    "CHANGE COLUMN table col NVARCHAR;",
    "MODIFY table_name.col TO NVARCHAR;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement is TRUE about changing a column type?",
  "options": [
    "You can always reduce datatype size without risk",
    "SQL Server blocks changes that may lose data unless handled manually",
    "Column type can only be changed by dropping the table",
    "Data type cannot be altered if column contains NULL"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which command renames a database using the recommended method?",
  "options": [
    "ALTER DATABASE old MODIFY NAME = new;",
    "RENAME DATABASE old TO new;",
    "EXEC sp_renamedb old, new;",
    "CHANGE DATABASE old new;"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "How do you move a table to another schema?",
  "options": [
    "MODIFY table SET SCHEMA new_schema;",
    "ALTER TABLE table SET SCHEMA new_schema;",
    "ALTER SCHEMA new_schema TRANSFER old_schema.table_name;",
    "EXEC MoveTable old_schema new_schema table_name;"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which query lists all server-level logins?",
  "options": [
    "SELECT * FROM sys.database_principals;",
    "SELECT * FROM master.sys.server_principals;",
    "EXEC sp_databases;",
    "SELECT * FROM sys.tables;"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement about Primary Keys is TRUE?",
  "options": [
    "A table can have multiple Primary Keys",
    "A Primary Key cannot contain NULL values",
    "A Primary Key allows duplicate values",
    "A Primary Key must be INT datatype"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement about UNIQUE constraints is TRUE?",
  "options": [
    "A table can only have one UNIQUE constraint",
    "UNIQUE allows multiple NULLs in SQL Server",
    "UNIQUE constraints guarantee duplicates",
    "UNIQUE constraints automatically index the column"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which method is best when modifying a column type that risks data loss?",
  "options": [
    "Direct ALTER COLUMN",
    "Drop column and recreate",
    "Create new column → copy data → drop old column → rename",
    "Use TRY_CAST"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which method correctly returns the current logged-in SQL Server login?",
  "options": [
    "SELECT USER_NAME();",
    "SELECT SYSTEM_USER;",
    "SELECT SESSION_USER;",
    "SELECT DB_LOGIN();"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement allows capturing Stored Procedure output into a temp table?",
  "options": [
    "CALL proc INTO #temp;",
    "INSERT INTO #temp EXEC procName;",
    "EXEC proc INTO #temp;",
    "EXPORT proc TO TABLE;"
  ],
  "answer": 1,
  "time": 20
}
,
{
  "q": "Which best describes a SELF JOIN?",
  "options": [
    "A join between two completely different tables",
    "A join where a table is joined to itself using aliases",
    "A join that automatically removes duplicate rows",
    "A join that uses FULL OUTER JOIN only"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "In a self join, why are table aliases required?",
  "options": [
    "SQL Server does not allow joining without aliases",
    "To improve query performance",
    "To differentiate between the two references of the same table",
    "To apply ORDER BY on both tables"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which type of integrity ensures that each record in a table is uniquely identifiable?",
  "options": [
    "Entity Integrity",
    "Referential Integrity",
    "Domain Integrity",
    "User-defined Integrity"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Foreign keys are used to enforce which type of integrity?",
  "options": [
    "Domain Integrity",
    "Entity Integrity",
    "Referential Integrity",
    "Logical Integrity"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "A CHECK constraint enforces which type of integrity?",
  "options": [
    "Referential Integrity",
    "Domain Integrity",
    "Entity Integrity",
    "Key Integrity"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "The rule 'Minimum account balance must not drop below 2000' enforces which type of integrity?",
  "options": [
    "Entity Integrity",
    "User-defined Integrity",
    "Domain Integrity",
    "Referential Integrity"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which is an example of Referential Integrity in banking?",
  "options": [
    "Account numbers must be unique",
    "Transaction amount must be positive",
    "Every transaction must belong to an existing account",
    "Customer name cannot be NULL"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Normalization mainly aims to:",
  "options": [
    "Increase redundancy for faster reads",
    "Eliminate redundancy and maintain integrity",
    "Merge multiple tables into one",
    "Improve write performance by duplicating data"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Denormalization is used to:",
  "options": [
    "Increase the number of tables to organise data better",
    "Reduce table size dramatically",
    "Improve query performance by reducing joins",
    "Ensure data integrity strictly"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which of the following is TRUE about denormalization?",
  "options": [
    "It reduces query performance",
    "It increases redundancy intentionally",
    "It is always recommended for OLTP systems",
    "It prevents anomalies completely"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which query searches text inside stored procedures?",
  "options": [
    "SELECT * FROM sys.objects WHERE text LIKE '%keyword%';",
    "SELECT name FROM sys.tables WHERE definition LIKE '%keyword%';",
    "SELECT name FROM sys.procedures WHERE OBJECT_DEFINITION(object_id) LIKE '%keyword%';",
    "EXEC SearchProcedure '%keyword%';"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which system view provides the SQL definition (body) of stored procedures?",
  "options": [
    "sys.objects",
    "sys.sql_modules",
    "sys.dm_exec_sessions",
    "sys.procedures_info"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which query searches for a string across all SQL objects like views, triggers, functions and procedures?",
  "options": [
    "SELECT * FROM sys.indexes WHERE definition LIKE '%text%';",
    "SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME LIKE '%text%';",
    "SELECT o.name FROM sys.objects o JOIN sys.sql_modules m ON o.object_id = m.object_id WHERE m.definition LIKE '%text%';",
    "EXEC sp_search_all '%text%';"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which command is commonly used to view the text of a stored procedure in SQL Server?",
  "options": [
    "EXEC sp_columns 'procname'",
    "EXEC sp_helptext 'procname'",
    "EXEC sp_procedure 'procname'",
    "EXEC viewtext 'procname'"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which view stores the full SQL definition of a stored procedure?",
  "options": [
    "sys.objects",
    "sys.procedures",
    "sys.sql_modules",
    "sys.syscomments"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What is the primary difference between a table variable and a temporary table?",
  "options": [
    "Table variables are stored in tempdb, temp tables are stored in memory",
    "Table variables support full indexing, temp tables do not",
    "Temp tables maintain statistics while table variables do not",
    "Table variables allow multiple sessions to access them"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which syntax is correct to declare a table variable?",
  "options": [
    "CREATE TABLE @Temp (id INT)",
    "DECLARE @Temp TABLE (id INT)",
    "DECLARE TABLE @Temp (id INT)",
    "CREATE VARIABLE TABLE @Temp (id INT)"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "When should a table variable be preferred over a temporary table?",
  "options": [
    "When working with large datasets and heavy joins",
    "When needing statistics for query optimization",
    "When handling small datasets inside stored procedures",
    "When requiring cross-session visibility"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Is it recommended to use SELECT * inside a stored procedure?",
  "options": [
    "Yes, SELECT * improves performance",
    "Yes, SELECT * helps maintain consistency",
    "No, SELECT * causes dependency and performance issues",
    "No, SQL Server does not allow SELECT * inside procedures"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why is SELECT * discouraged inside stored procedures?",
  "options": [
    "It causes SQL injection",
    "It reduces security permissions",
    "It may break when table structure changes",
    "It prevents the use of ORDER BY"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which property of ACID ensures that either all operations in a transaction succeed or none do?",
  "options": [
    "Consistency",
    "Atomicity",
    "Durability",
    "Isolation"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which SQL block begins a transaction?",
  "options": [
    "START TRAN",
    "BEGIN",
    "BEGIN TRAN",
    "TRANSACTION BEGIN"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What does ROLLBACK TRANSACTION do?",
  "options": [
    "Saves all changes permanently",
    "Undoes all changes made in the transaction",
    "Ends the current session",
    "Validates the transaction but does not execute it"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "In a transaction block, why is RETURN used after ROLLBACK?",
  "options": [
    "To commit changes immediately",
    "To exit the procedure and stop further execution",
    "To restart the transaction",
    "To log an error in tempdb"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "In a bank transfer transaction, which of the following represents a correct transaction behavior?",
  "options": [
    "Debit succeeds even if credit fails",
    "Credit runs even when debit fails",
    "Both operations commit only when both succeed",
    "Each update commits separately"
  ],
  "answer": 2,
  "time": 20
}

,

  {
    "q": "A transaction updates 3 tables, but the last UPDATE fails. The developer forgot to include TRY...CATCH around BEGIN TRAN. What is the impact?",
    "options": [
      "Only failed statement rolls back, others remain committed",
      "Whole transaction becomes an open transaction and locks may remain until session ends",
      "SQL Server automatically rolls back the entire transaction",
      "SQL Server commits all successful statements and skips the failed one"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A foreign key between Orders.CustomerID → Customers.CustomerID has ON DELETE CASCADE. The Customers table has 10 million rows, Orders has 100 million. What is a likely issue when deleting 1 customer?",
    "options": [
      "The delete will be very fast because CASCADE optimizes it internally",
      "It will only delete 1 row from Orders",
      "It may lock Orders table heavily and cause blocking/long-running operations",
      "The child table will be ignored during cascading"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "A developer uses a table variable @t with 200,000 rows and joins it with 4 large tables. Performance is extremely poor. Why?",
    "options": [
      "@table variables spill to tempdb too fast",
      "Table variables do not maintain statistics leading to poor query plans",
      "Table variables require a primary key always",
      "Table variables do not support joins with large tables"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A stored procedure returns incorrect results only on large datasets. After investigating, the root cause is parameter sniffing. Which solution is best?",
    "options": [
      "Rewrite the procedure using SELECT *",
      "Add WITH RECOMPILE to the stored procedure",
      "Move logic to a function",
      "Convert all parameters to NVARCHAR(MAX)"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need to enforce that a bank account balance never goes below 2000. Which integrity rule is this?",
    "options": [
      "Domain Integrity",
      "Referential Integrity",
      "Entity Integrity",
      "User-defined Integrity"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "A team wants to denormalize a table and store customer address directly inside Orders to improve Power BI speed. What is a major risk?",
    "options": [
      "Increased join complexity",
      "Inconsistent data across rows when address changes",
      "Power BI cannot read denormalized tables",
      "Primary keys stop working"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What happens if you try to delete a row from a parent table that is referenced by a foreign key without cascade?",
    "options": [
      "Delete succeeds and child rows become orphaned",
      "SQL Server deletes the child rows automatically",
      "SQL Server raises a foreign key conflict error and blocks the delete",
      "The row is soft-deleted only"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "You add a NOT NULL column to a table with existing data but do not provide a DEFAULT. What happens?",
    "options": [
      "SQL Server fills all existing rows with NULL",
      "SQL Server throws an error because old rows cannot have NULL",
      "Column is added with random data",
      "Column is added successfully but remains unused"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer uses INSERT INTO #temp EXEC SomeProcedure. The procedure has both SELECT and PRINT statements. What happens?",
    "options": [
      "PRINT output will break the INSERT",
      "Only the SELECT result goes into #temp; PRINT is ignored",
      "Both PRINT and SELECT go into #temp",
      "SQL Server throws an error"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You run sp_helptext on a stored procedure but only see partial text. Why?",
    "options": [
      "Stored procedure is too old",
      "Stored procedure is encrypted using WITH ENCRYPTION",
      "Stored procedure name is wrong",
      "SQL Server Management Studio blocks long text"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer adds a DEFAULT constraint using ALTER TABLE but forgets to add FOR column_name. What happens?",
    "options": [
      "SQL Server assumes the first column",
      "SQL Server throws a syntax error",
      "Constraint applies to all columns",
      "SQL Server auto-detects the intended column"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A sequence object is used across 3 tables. One table performs heavy deletes and restarts the sequence using RESTART WITH 1. What issue may occur?",
    "options": [
      "Other tables continue numbering correctly",
      "Sequence resets globally affecting all tables and causing key collisions",
      "Restart only affects that table",
      "SQL Server silently ignores RESTART for shared sequences"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need to check which stored procedure references a particular column inside a table. Which approach works best?",
    "options": [
      "Query sys.tables",
      "Use sys.sql_modules with LIKE search",
      "Use INFORMATION_SCHEMA.TABLES",
      "Use sp_who2"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "During a concurrent update workload, a transaction reads a row twice and sees different values each time. Which isolation level is being used?",
    "options": [
      "Serializable",
      "Repeatable Read",
      "Snapshot",
      "Read Committed"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "When transferring a table to another schema using ALTER SCHEMA, which objects move automatically?",
    "options": [
      "Only the table",
      "Table + indexes + constraints + triggers tied to the table",
      "Only schema-level objects",
      "Nothing moves automatically"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "If a stored procedure updates millions of rows but commits only at the end, what is a major risk?",
    "options": [
      "Deadlocks will be prevented",
      "Long-running locks may block other users",
      "No impact, SQL Server auto-optimizes",
      "Rows become corrupted"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What happens if you use SELECT * inside a stored procedure and the table definition changes (column added)?",
    "options": [
      "Stored procedure will automatically recompile and adjust",
      "Stored procedure might return extra columns and break applications",
      "Stored procedure will fail immediately",
      "SQL Server rejects schema changes"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A table has a composite PK (ColA, ColB). A foreign key references only ColA. What happens?",
    "options": [
      "Foreign key is created successfully",
      "SQL Server throws an error because FK must reference all PK columns",
      "Partial referencing is allowed",
      "FK becomes disabled automatically"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You join two tables on a non-indexed column with millions of rows. What issue occurs?",
    "options": [
      "Hash join or full scan causing slow performance",
      "SQL rejects the query",
      "Rows return in random order",
      "Joins require indexes by rule"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which scenario breaks Referential Integrity even if FK exists?",
    "options": [
      "Using MERGE with WHEN NOT MATCHED",
      "Disabling the foreign key temporarily",
      "Using INNER JOIN",
      "Using SELECT INTO"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer wants the same sequence number to be used by three tables. What is the danger?",
    "options": [
      "Sequence will have gaps",
      "Restarting sequence or heavy DELETEs cause duplicates across tables",
      "Sequence cannot be used by multiple tables",
      "SQL auto-divides sequence across tables"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which statement about GRanularity is correct?",
    "options": [
      "Granularity determines table index types",
      "Granularity defines the level of detail at which data is grouped or analyzed",
      "Granularity depends on foreign keys only",
      "Granularity is used only in Power BI"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Developers want to normalize a table from 2NF to 3NF. What must be removed?",
    "options": [
      "Partial dependency",
      "Transitive dependency",
      "All NULL columns",
      "Surrogate keys"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A DELETE is running for 30 minutes on a table with billions of rows and a foreign key without cascade. What is the most likely cause?",
    "options": [
      "DELETE is checking every child row in the referencing table",
      "DELETE is blocked by memory",
      "SQL Server automatically batches deletes",
      "No constraints are being validated"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which of the following ensures a transaction is durable?",
    "options": [
      "Buffer manager",
      "Tempdb writes",
      "Transaction log and write-ahead logging",
      "Clustered index"
    ],
    "answer": 2,
    "time": 20
  }
,
  {
    "q": "A long-running transaction updates millions of rows and then the session disconnects unexpectedly before COMMIT or ROLLBACK. What is the likely immediate impact?",
    "options": [
      "Changes are committed automatically",
      "Transaction remains open causing locks until rollback completes during recovery",
      "Changes are partially committed",
      "SQL Server cancels the transaction silently"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Two transactions concurrently try to update the same row. One uses SERIALIZABLE isolation, the other uses READ COMMITTED. What behavior is expected?",
    "options": [
      "Both proceed without blocking",
      "READ COMMITTED blocks SERIALIZABLE",
      "SERIALIZABLE may acquire more restrictive locks and block the other transaction",
      "Both are promoted to SNAPSHOT automatically"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "A stored procedure runs slowly only when executed from the application but is fast in SSMS. The plan in cache differs. What is the likely cause?",
    "options": [
      "Different SET options or parameter sniffing causing a bad cached plan for the app",
      "SSMS has a faster network",
      "App user lacks permissions so SQL Server slows down",
      "SSMS automatically adds WITH RECOMPILE"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "You create a nonclustered index on a very wide table. After the index is created, inserts slow down significantly. Why?",
    "options": [
      "Nonclustered indexes are stored outside the table and do not affect inserts",
      "Every insert must maintain the nonclustered index causing extra IO and logging",
      "Indexes compress inserts automatically",
      "SQL Server ignores nonclustered indexes during inserts"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query using a join produces an unexpectedly large estimated row count leading to a bad plan. Which action can help the optimizer produce a better plan?",
    "options": [
      "Disable statistics on all tables",
      "Create or update statistics on the columns used in the join",
      "Use SELECT * to force a new plan",
      "Drop all nonclustered indexes"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You observe frequent deadlocks between two stored procedures. Best immediate mitigation without code changes?",
    "options": [
      "Restart SQL Server",
      "Add a query hint to reduce lock escalation, such as ROWLOCK, or set /NOLOCK on safe reads",
      "Drop and recreate databases",
      "Use SELECT * for faster scans"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A table has a clustered index on ID and several nonclustered indexes. You often query by Date column. What should you do to speed those queries?",
    "options": [
      "Add a nonclustered index on Date (and include needed columns)",
      "Drop the clustered index",
      "Convert Date to VARCHAR",
      "Use a view instead of indexing"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A developer sets a table variable @t and inserts 100K rows, and then runs a complex join. The query uses a poor plan. Why?",
    "options": [
      "Table variables maintain perfect statistics and the plan is optimal",
      "Table variables lack statistics, causing the optimizer to assume 1 row leading to bad plan",
      "Table variables are faster than temp tables for large data",
      "SQL Server refuses to use table variables in joins"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need to avoid gaps in invoice numbers (no missing numbers) while handling concurrent transactions. Which approach is safest?",
    "options": [
      "Use IDENTITY column and accept gaps",
      "Use SEQUENCE with caching on",
      "Use a serialized table-based counter with transaction and row lock to allocate numbers sequentially",
      "Use NEXT VALUE FOR in every insert"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "An index rebuild is running and you notice high transaction log growth. Why does index rebuild affect log size?",
    "options": [
      "Index rebuilds are minimally logged in full recovery mode, causing log to grow",
      "Index rebuilds are never logged",
      "Index rebuild writes only to tempdb",
      "Index rebuilds compress the log automatically"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A DELETE statement on parent table is extremely slow because of foreign key checks. How can you optimize?",
    "options": [
      "Disable the foreign key permanently",
      "Ensure child table has an index on the FK column so delete checks are fast",
      "Use TRUNCATE TABLE instead of DELETE",
      "Drop child table"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You altered a large column from VARCHAR(1000) to VARCHAR(200) and the ALTER COLUMN operation takes very long or fails. Best safe approach?",
    "options": [
      "Run ALTER COLUMN directly and hope for the best",
      "Create new column with target type, update in batches verifying data loss, drop old column, rename new column",
      "Reinstall SQL Server",
      "Change client to accept larger values"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query with OPTION (RECOMPILE) now performs well but increases CPU. Why?",
    "options": [
      "RECOMPILE makes SQL Server generate a fresh plan each execution, which can avoid parameter sniffing but costs CPU",
      "RECOMPILE caches the plan forever",
      "RECOMPILE disables indices",
      "RECOMPILE changes table schema"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A transaction uses SERIALIZABLE isolation for a reporting query and now causes significant blocking. What alternative can give snapshot isolation without blocking writers?",
    "options": [
      "Read Uncommitted",
      "Snapshot isolation or Read Committed Snapshot (RCSI)",
      "Repeatable Read",
      "Use NOLOCK everywhere"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer added many nonclustered indexes to speed reads, but now ETL inserts are too slow. Best compromise?",
    "options": [
      "Drop all nonclustered indexes permanently",
      "Disable unnecessary indexes during bulk load and rebuild later",
      "Convert indexes to XML indexes",
      "Copy data without using transactions"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A stored procedure uses dynamic SQL built by concatenating parameters. Risk?",
    "options": [
      "No risk, it is always safe",
      "Risk of SQL Injection and plan cache inefficiencies; use sp_executesql with parameters",
      "It is faster than parameterized queries",
      "Dynamic SQL cannot be used in stored procedures"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A SELECT with a LEFT JOIN returns more rows than expected due to duplicates in the right table. Best immediate fix?",
    "options": [
      "Convert LEFT JOIN to INNER JOIN blindly",
      "Identify and deduplicate the right table (or use aggregated subquery or DISTINCT) to ensure the join is on unique keys",
      "Add SELECT * to remove duplicates",
      "Drop indexes"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A table partitioning strategy is considered for a very large fact table. What is a primary benefit?",
    "options": [
      "It removes need for indexes",
      "Partition elimination can speed queries that filter on partition key and enables efficient partition switching for loads",
      "It guarantees no fragmentation",
      "It automatically compresses data"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You see an execution plan with a table spool operator. What does a spool typically indicate?",
    "options": [
      "Perfect CPU usage",
      "Optimizer cached intermediate results, possibly due to nested loops and repeated reads; can indicate workaround for parameter sniffing or repeated access",
      "No IO was used",
      "Spool deletes data"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query with CROSS APPLY returns rows where a subquery depends on outer values. When is CROSS APPLY preferred over JOIN?",
    "options": [
      "When subquery returns a single scalar only",
      "When you need to invoke a table-valued function or correlated subquery per row and want to preserve row correlations",
      "When no correlation exists",
      "When you want Cartesian product always"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You have parameter sniffing issues for a procedure used by diverse parameter values. Which persistent fix is appropriate?",
    "options": [
      "Add WITH RECOMPILE to procedure permanently",
      "Use OPTIMIZE FOR UNKNOWN or local variable trick, or use plan guides / forced parameterization carefully",
      "Drop all indexes",
      "Convert procedure to inline scalar function"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer queries sys.sql_modules to search for a text and finds no matches though the procedure contains the text. Why?",
    "options": [
      "sys.sql_modules never contains text",
      "Procedure may have been created WITH ENCRYPTION or text is split/obfuscated; alternative is to check sys.objects or encrypted procedures cannot be read",
      "The text is only dynamic at runtime",
      "SQL Server caches the text in tempdb only"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need to copy table structure and data to another database preserving indexes and constraints. Which method is best?",
    "options": [
      "SELECT INTO across databases",
      "Use SSMS Generate Scripts (Schema and Data) or backup/restore, or use SSIS to move schema and data preserving objects",
      "bcp queryout",
      "Use SELECT * INTO with triggers"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "An index seek turns into an index scan after statistics become stale. Why?",
    "options": [
      "Stale statistics lead the optimizer to misestimate cardinality and choose a scan over seek",
      "Index seek is illegal after long runtime",
      "SQL Server randomly changes plans",
      "Index seek requires table lock"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A database uses full recovery model. During heavy insert operations the log grows. Which measure will control log growth?",
    "options": [
      "Switch to SIMPLE recovery permanently",
      "Ensure frequent transaction log backups, consider batching inserts and check long-running transactions",
      "Disable logging",
      "Move log file to fast disk"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query uses a covering index (includes) but still performs lookups. Why?",
    "options": [
      "Include columns are ignored by optimizer",
      "The included columns were not actually included or the predicate requires columns not covered; verify index includes and key order",
      "Covering indexes always cause lookups",
      "SQL Server does not support included columns"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You use DBCC CHECKIDENT to reseed an identity but see duplicate values after bulk load. Probable reason?",
    "options": [
      "DBCC CHECKIDENT is only for sequences",
      "Identity reseed was done incorrectly; or identity_insert was used and reseed not set properly causing collisions",
      "SQL Server ignores reseed",
      "Identity columns can have duplicates intentionally"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A UNIQUE constraint allows a single NULL in some DB engines. In SQL Server, what's the behavior of UNIQUE with NULLs?",
    "options": [
      "SQL Server permits multiple NULLs in a UNIQUE column",
      "SQL Server prevents any NULLs in UNIQUE column",
      "SQL Server treats NULLs as equal and allows only one NULL",
      "SQL Server converts NULL to empty string for uniqueness"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A query uses ROW_NUMBER() OVER (PARTITION BY ...) to deduplicate. Which consideration is important?",
    "options": [
      "Ensure ORDER BY inside OVER is deterministic to pick desired row; otherwise result selection may be arbitrary",
      "ROW_NUMBER cannot be used with PARTITION",
      "ROW_NUMBER always chooses smallest value",
      "ROW_NUMBER removes duplicates magically"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "You plan to use READ COMMITTED SNAPSHOT isolation. Which prerequisites must you check?",
    "options": [
      "Enable snapshot isolation at database level (ALTER DATABASE SET READ_COMMITTED_SNAPSHOT ON) and ensure tempdb has capacity for row versioning",
      "No change required on database",
      "Disable all indexes",
      "Rebuild all statistics"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which is the best practice for avoiding row-level locks escalating to table locks during bulk operations?",
    "options": [
      "Use small batch sizes, keep transactions short, and use appropriate lock hints only if necessary",
      "Disable all constraints",
      "Use a single giant transaction",
      "Run on weekends always"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A temp table #T and a table variable @T are both used. Which is true for statistics and plan quality?",
    "options": [
      "Table variables have full statistics and often generate better plans",
      "Temp tables have statistics maintained which can lead to better plans for large data, table variables do not have stats historically",
      "Both have identical optimizer behavior",
      "Table variables are always in tempdb and never spill to disk"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A stored procedure includes an OUTPUT parameter as NVARCHAR(MAX) containing JSON of many rows. What is a tradeoff?",
    "options": [
      "OUTPUT of large JSON avoids network roundtrips but may increase memory usage and serialize cost on server and client; prefer INSERT...EXEC or streaming when possible",
      "OUTPUT is always most efficient",
      "OUTPUT parameters cannot be NVARCHAR(MAX)",
      "JSON cannot be returned from procedures"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "When should you use sp_executesql over EXEC for dynamic SQL?",
    "options": [
      "sp_executesql supports parameterization which improves plan reuse and prevents SQL injection; use it for dynamic SQL with parameters",
      "EXEC is always better",
      "sp_executesql cannot be used in procedures",
      "EXEC compiles plans better"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A bulk load uses TABLOCK hint for performance. Side effect?",
    "options": [
      "TABLOCK reduces concurrency by acquiring a table-level lock but enables minimal logging in some recovery models, improving bulk load speed",
      "TABLOCK prevents data from being written",
      "TABLOCK disables indexes automatically",
      "TABLOCK converts data to readonly"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which action helps when a query shows high logical reads on a small set of rows?",
    "options": [
      "Consider adding a selective nonclustered index that covers the query, or adjust query to filter on indexed columns",
      "Increase MAXDOP",
      "Drop all indexes",
      "Use SELECT * to reduce reads"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "You see constant compilation and recompilation of a proc causing CPU spikes. Likely cause?",
    "options": [
      "Use of WITH RECOMPILE everywhere",
      "Plan cache churn due to many single-use adhoc queries or frequent invalidation by statistics updates; consider parameterization and optimize for reuse",
      "SQL Server is low on disk space",
      "Network latency"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A MERGE statement causes deadlocks and unexpected behavior under concurrency. Best approach?",
    "options": [
      "Use MERGE always regardless of concurrency",
      "Replace MERGE with separate INSERT/UPDATE logic with proper locking and ordering to avoid race conditions",
      "Use MERGE with NOLOCK",
      "MERGE is atomic and cannot deadlock"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query uses an index but includes an OR predicate that prevents seek on the index. How to improve?",
    "options": [
      "Rewrite query using UNION ALL of two selective predicates each using index seeks",
      "Add more OR conditions",
      "Remove all indexes",
      "Use CROSS APPLY"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Your database files are on a single disk and IO is the bottleneck. Short-term mitigation?",
    "options": [
      "Add files on multiple disks for tempdb and log, separate data and log files on different IO paths, and consider faster storage",
      "Defragment index",
      "Use more CPU",
      "Delete data to reduce IO"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A developer uses SELECT INTO to create a table with data during ETL. Downsides?",
    "options": [
      "SELECT INTO creates an empty table only",
      "SELECT INTO does not copy constraints, indexes, defaults. You must recreate them to match source",
      "SELECT INTO is always transactional",
      "SELECT INTO is faster but risky due to lack of logging"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A schema-bound view referencing base tables helps with determinism. What is a benefit?",
    "options": [
      "Allows the view to be indexed (indexed view) and improves performance for specific aggregations if criteria are met",
      "Prevents any DML on base tables",
      "Automatically adds indexes",
      "Removes need for permissions"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which log backup strategy reduces recovery point objective (RPO) without huge overhead?",
    "options": [
      "Do full backups only",
      "Frequent transaction log backups (e.g., every few minutes) to truncate log and reduce RPO while maintaining full recovery",
      "Never backup transaction logs",
      "Use file copy for logs"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need to query historic partitions quickly and drop old data efficientl y. Which design helps?",
    "options": [
      "Partition table by date so you can SWITCH OUT or DROP partitions quickly",
      "Use a single huge table and run DELETE WHERE date < cutoff",
      "Move old data to blob storage only",
      "Use clustered index on date only"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A user reports intermittent errors 'String or binary data would be truncated' during inserts. Best root cause approach?",
    "options": [
      "Assume network issue",
      "Identify which column and input length exceeds defined column size, add validation or increase column width and review data pipeline transformations",
      "Add TRY/CATCH to ignore errors",
      "Convert data to VARCHAR(MAX) always"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which is true about READ UNCOMMITTED isolation?",
    "options": [
      "It guarantees consistent reads",
      "It allows dirty reads and can return uncommitted changes",
      "It prevents phantom reads",
      "It is same as SNAPSHOT"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query uses an anti-join pattern NOT EXISTS but performs slowly. What index helps?",
    "options": [
      "Index on columns used in the NOT EXISTS subquery predicate (child table) to speed exclusion",
      "Index on unrelated columns",
      "No index will help antijoins",
      "Convert NOT EXISTS to NOT IN always"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "You want to avoid plan changes when statistics are updated during heavy load. What can stabilize behavior?",
    "options": [
      "Disable auto update stats globally",
      "Use trace flags or set OPTIMIZE FOR or use plan guides where appropriate; or schedule stats updates during maintenance windows",
      "Drop statistics entirely",
      "Force recompilation every minute"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A function returns a scalar and is used in a WHERE clause per row; performance is poor. Why?",
    "options": [
      "Scalar UDFs often execute row-by-row and can lead to RBAR behavior; consider inline table-valued functions or rewrite logic for set-based execution",
      "Scalar functions are always faster",
      "Functions cannot be used in WHERE",
      "SQL Server parallelizes scalar UDFs automatically"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A SELECT with ORDER BY on a large result set causes tempdb spills. What remedy helps?",
    "options": [
      "Increase memory grant, add appropriate indexes that match ORDER BY, or increase tempdb capacity and file count",
      "Use ORDER BY randomly",
      "Remove ORDER BY always",
      "Drop tempdb"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which of the following is an advantage of compressed tables/indexes?",
    "options": [
      "Compressed data reduces IO and storage, may improve IO-bound query performance but increases CPU usage",
      "Compression removes need for indexes",
      "Compression disables backups",
      "Compression causes data corruption"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A plan shows an expensive Key Lookup operator. How to remove it?",
    "options": [
      "Add the missing columns to the nonclustered index as included columns to make it covering",
      "Remove the index",
      "Use NOLOCK",
      "Rewrite query to use SELECT *"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A database has multiple filegroups. You want to place large read-only historical tables on slower storage. Benefit?",
    "options": [
      "Placing large historical read-only tables on cheaper slower storage reduces cost while keeping hot OLTP data on faster IO paths",
      "It improves OLTP performance automatically",
      "It removes need for backups for historical data",
      "It makes queries always faster"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A user runs sp_who2 and sees many sessions with status 'SUSPENDED'. What is a likely reason?",
    "options": [
      "Sessions are idle",
      "Sessions are waiting on resources (locks, IO) causing suspension; check wait_type to identify blocking",
      "Sessions are completed",
      "sp_who2 is broken"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need to capture the text of long stored procedures including definitions over 4000 chars. Best method?",
    "options": [
      "INFORMATION_SCHEMA.ROUTINES",
      "sys.sql_modules.definition or OBJECT_DEFINITION(object_id)",
      "sp_helptext only",
      "sys.tables"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which approach prevents blocking during large delete operations on archive data?",
    "options": [
      "DELETE in a single transaction",
      "Batch deletes in small transactions and free log growth, or use partition switching for bulk removal",
      "Disable constraints permanently",
      "TRUNCATE TABLE on parent tables"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which statement about tempdb is true?",
    "options": [
      "tempdb persists across server restarts",
      "tempdb is recreated on SQL Server startup and is shared by all sessions; contention here affects many operations",
      "You can shrink tempdb to reclaim space permanently",
      "tempdb stores only user tables forever"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A clustered index key is very wide and frequently updated, causing fragmentation. What is a better design?",
    "options": [
      "Use the wide key as clustered index anyway",
      "Choose a narrow, static clustered key (surrogate INT) and create nonclustered indexes for other search patterns",
      "Eliminate clustered index",
      "Keep cluster on updated columns only"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of the following best explains phantom reads?",
    "options": [
      "A transaction reads same row twice and gets same result",
      "A transaction reads a set of rows twice and sees new rows inserted by other transactions between reads; prevented by Serializable isolation",
      "A row-level lock escalation",
      "A deadlock situation"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You see frequent PAGEIOLATCH waits. What is the top probable cause?",
    "options": [
      "CPU starvation",
      "Waiting for physical IO to read pages from disk; consider faster storage, caching, or index tuning to reduce IO",
      "Network latency",
      "Too many temp tables"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer wants the same identity values copied from old table to new table during migration. What step is required?",
    "options": [
      "Just insert values normally",
      "Enable IDENTITY_INSERT ON for the target table during insert to allow explicit identity values, then set IDENTITY_INSERT OFF",
      "Use DBCC COPY_IDENT",
      "Use SEQUENCE instead always"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A large table has many nonclustered indexes. Rebuilding them takes long. What can help?",
    "options": [
      "Rebuild all indexes at once with max degree of parallelism 1",
      "Rebuild indexes online if edition supports it, or rebuild in parallel batches during maintenance window and consider reorganize for low fragmentation",
      "Drop all indexes and never recreate",
      "Restart SQL Server"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which situation indicates statistics auto-update threshold may be insufficient for large tables?",
    "options": [
      "Queries always use good plans",
      "Significant data changes (large % of rows changed) but auto-update stats not triggered frequently enough causing stale stats and poor plans",
      "Auto-update stats never runs",
      "Statistics only affect small tables"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query plan chooses Hash Join instead of Nested Loops and performs better for large sets. Why might optimizer choose Hash Join?",
    "options": [
      "Hash join is always slower",
      "Hash join is chosen when inputs are large and hash build/probe costs are lower than nested loop repeated probes",
      "Nested loops require without indexes",
      "Hash join avoids IO entirely"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You want to perform an online index rebuild but get an error in Standard Edition. Why?",
    "options": [
      "Online index rebuild is not supported in Standard Edition for large tables; Enterprise/Developer editions support ONLINE=ON for some index types",
      "Online rebuild is disabled by default",
      "SQL Server cannot rebuild indexed views",
      "Indexes can never be rebuilt"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "An application relies on GETDATE() at insert time for timestamp but needs repeatable results during a transaction. Better choice?",
    "options": [
      "Use GETDATE() everywhere",
      "Use a variable set once per transaction (DECLARE @now = GETUTCDATE()) and use it consistently to avoid slight variances",
      "Use new GETDATE2()",
      "Use SELECT * to lock time"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which backup type minimizes restore time for a point-in-time recovery while balancing backup overhead?",
    "options": [
      "Only full backups weekly",
      "Combination: regular full backups, frequent differential backups, and frequent transaction log backups to enable point-in-time restore",
      "Only log backups",
      "No backups needed with mirror"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A table has many small wide columns and queries only use a few columns. Which storage tweak helps?",
    "options": [
      "Create a narrow covering nonclustered index with included columns for the frequent query projection to avoid reading wide row data frequently",
      "Convert columns to XML",
      "Use SELECT * only",
      "Drop unused columns physically"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which method reduces contention on tempdb allocations?",
    "options": [
      "Use a single tempdb data file",
      "Use multiple tempdb data files (one per CPU core up to a reasonable number) to reduce allocation contention",
      "Store tempdb on network share",
      "Disable tempdb"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You enable READ_COMMITTED_SNAPSHOT ON and see queries returning older committed values than expected. Explanation?",
    "options": [
      "Snapshot isolation returns earlier committed state at query start, which may be different from latest committed changes; RCSI uses row versioning",
      "READ_COMMITTED_SNAPSHOT disables reads",
      "Values are corrupted",
      "It forces dirty reads"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A query uses FOR XML PATH to produce XML; nested special characters cause invalid XML. Fix?",
    "options": [
      "Concatenate strings directly",
      "Use FOR XML PATH with TYPE and then .value or use proper escaping functions to get safe XML",
      "Remove special chars manually in client only",
      "XML cannot contain special characters"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You suspect fragmentation; query shows high fragmentation percentages. Appropriate action?",
    "options": [
      "Ignore fragmentation always",
      "If fragmentation > 30% consider rebuild; 5%-30% consider reorganize; consider fill factor and maintenance schedule",
      "Drop table and recreate database",
      "Always defragment manually row-by-row"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A CROSS JOIN is used inadvertently producing Cartesian product and causing timeouts. Mitigation?",
    "options": [
      "Allow timeout",
      "Add proper join predicates, limit result set, or use TOP for testing while fixing logic",
      "Use CROSS APPLY instead",
      "Remove WHERE clause"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You need consistent numbering per partition for analytics (row numbers restart per group). Which function?",
    "options": [
      "ROW_NUMBER() OVER (PARTITION BY partition_key ORDER BY sort_key)",
      "RANK() without partition",
      "NTILE()",
      "COUNT()"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which of the following is true about plan guides?",
    "options": [
      "Plan guides allow forcing hints without changing application code, useful for tuning adhoc queries when you cannot change the SQL text",
      "Plan guides change the database schema",
      "Plan guides are deprecated",
      "Plan guides automatically update statistics"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A system shows frequent PAGE_LOCK waits on a heap table. What is a likely solution?",
    "options": [
      "Convert heap to cluster index to provide ordered access and reduce page latch contention for certain workloads",
      "Drop the table",
      "Set database to read-only",
      "Disable locking"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "You must enforce a business rule 'employee salary <= manager salary'. Best approach?",
    "options": [
      "Use a CHECK constraint referencing other row directly",
      "Use triggers or stored procedure logic to validate because CHECK constraints cannot reference other rows easily",
      "Relational integrity auto-enforces this",
      "Use UNIQUE constraint"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A developer uses NOLOCK hint to improve performance but sees inconsistent results. Why is NOLOCK risky?",
    "options": [
      "NOLOCK causes blocking",
      "NOLOCK allows dirty reads, non-repeatable reads and phantom reads; it can return inconsistent or missing rows",
      "NOLOCK increases locks",
      "NOLOCK is the same as SNAPSHOT"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A heavy OLTP system shows frequent latch contention on allocation pages. Which tuning helps?",
    "options": [
      "Reduce contention by adding multiple file groups and files for heavy tables, optimize tempdb, and tune allocation units",
      "Add more indexes",
      "Disable logging",
      "Use single-threaded processing"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which is true about invisible columns in queries?",
    "options": [
      "Invisible columns do not exist",
      "No such concept in SQL Server; columns exist unless dropped. To reduce surface, avoid SELECT * and explicitly select columns",
      "Invisible columns auto-hide in SSMS",
      "Columns can be hidden permanently from queries"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A function is marked deterministic and schema-bound. Advantage?",
    "options": [
      "Allows creation of indexed view that uses the function if function is deterministic and schema-bound, enabling performance benefits",
      "Function runs faster always",
      "Function never needs recompilation",
      "Function can update data"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "You need to enforce a unique business key across partitioned tables. Best approach?",
    "options": [
      "Use global unique index if possible, or maintain uniqueness at application level or use partition-aligned unique index if possible",
      "Ignore uniqueness",
      "Use trigger to duplicate keys",
      "Use non-unique clustered index"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "A query uses TOP 10 PERCENT ORDER BY somecol. Which behavior matters?",
    "options": [
      "TOP PERCENT is nondeterministic without ORDER BY; combined with ORDER BY it returns top percent deterministically; consider performance impact",
      "TOP PERCENT always faster",
      "TOP is ignored if PERCENT used",
      "TOP PERCENT only works with GROUP BY"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which maintenance activity reduces index fragmentation with minimal logging impact?",
    "options": [
      "Index rebuild online always minimal logging",
      "Reorganize index for low fragmentation is online and lighter-weight than rebuild, but rebuild may be preferred for heavy fragmentation",
      "Rebuild always offline only",
      "No maintenance is needed"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A report needs consistent snapshot across many tables during ETL. Best approach without blocking OLTP?",
    "options": [
      "Use table locks across whole database",
      "Use snapshot-based approach (Snapshot isolation or BEGIN TRANSACTION with appropriate isolation) or export from a restored backup to avoid impacting OLTP",
      "Use NOLOCK everywhere",
      "Run report during peak hours"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You observe that INSERT performance is worse after adding many included columns to an index. Why?",
    "options": [
      "Included columns reduce index size",
      "More included columns increase nonclustered index size and maintenance cost during DML, slowing inserts",
      "Included columns are ignored by SQL Server",
      "Included columns compress data automatically"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which is a correct reason to use filtered indexes?",
    "options": [
      "Filtered indexes index entire table always",
      "Filtered indexes can improve performance and reduce index size for queries that target a subset of rows (e.g., WHERE IsActive = 1)",
      "Filtered indexes replace partitioning always",
      "Filtered indexes disable statistics"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "When restoring a database to a point in time, which backups are required in full recovery model?",
    "options": [
      "Only the last full backup",
      "Most recent full backup, any subsequent differential backup (if used), and all transaction log backups up to the restore point",
      "Only log backups",
      "Only differential backups"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A query has a worrisome memory grant wait. Which fix reduces memory grant pressure?",
    "options": [
      "Increase memory on server only",
      "Rewrite query to lower memory needs (avoid large sorts, use batch processing), add appropriate indexes, or break into smaller operations",
      "Avoid using indexes",
      "Use SELECT * always"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which technique helps find which statement inside a multi-statement stored procedure causes high IO?",
    "options": [
      "Run proc in production without tracing",
      "Use SET STATISTICS IO ON and step through statements, or capture actual execution plan and use Extended Events or Query Store for per-statement analysis",
      "Drop procedure",
      "Use sp_helptext only"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You want to minimize blocking during index rebuilds in a production environment. Which option helps?",
    "options": [
      "Perform rebuilds during peak hours",
      "Use ONLINE=ON (if edition supports it) or use reorganize for less blocking and schedule during maintenance windows",
      "Disable the database",
      "Use SELECT INTO"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A large aggregation using GROUP BY is slow. Which index can help?",
    "options": [
      "Clustered index on unrelated column",
      "Create a covering index on grouping columns with included aggregate columns or use indexed view if appropriate",
      "No index helps aggregates",
      "Use CROSS JOIN"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which is true regarding TRY...CATCH in T-SQL?",
    "options": [
      "TRY...CATCH catches compile-time errors only",
      "TRY...CATCH catches runtime errors and allows you to ROLLBACK if @@TRANCOUNT > 0 during CATCH to avoid open transactions",
      "TRY...CATCH cannot be nested",
      "TRY...CATCH auto-commits transactions"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "A cross-database query uses three-part names and transactions spanning databases. What should you consider?",
    "options": [
      "No additional considerations",
      "Distributed transactions may be involved; ensure MSDTC configured and be careful of cross-database ownership chaining and permissions",
      "Cross-database queries auto-commit each part",
      "You cannot run cross-database transactions"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of the following causes plan cache bloat?",
    "options": [
      "Use of sp_executesql with parameters",
      "Many single-use ad-hoc statements with different literal values leading to many single plan cache entries; parameterization helps",
      "Reusing same parameterized query always",
      "Using plan guides"
    ],
    "answer": 1,
    "time": 20
  }
,
{
  "q": "Which function returns the transaction state inside a TRY/CATCH block?",
  "options": [
    "@@TRANCOUNT",
    "XACT_STATE()",
    "ERROR_STATE()",
    "TRANSACTION_STATE()"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What happens if a stored procedure starts a transaction but exits without COMMIT or ROLLBACK?",
  "options": [
    "SQL Server automatically commits it",
    "SQL Server automatically rolls it back immediately",
    "The transaction remains open and holds locks",
    "The connection is terminated"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which isolation level prevents both dirty reads and non-repeatable reads?",
  "options": [
    "READ UNCOMMITTED",
    "READ COMMITTED",
    "REPEATABLE READ",
    "SNAPSHOT"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which clause is required to create an indexed view in SQL Server?",
  "options": [
    "WITH SCHEMABINDING",
    "WITH CHECK",
    "WITH ENCRYPTION",
    "WITH BINDING"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What happens if you update a clustered index key?",
  "options": [
    "Only index entry updates",
    "Nothing happens",
    "The entire row is physically moved",
    "SQL Server rebuilds all indexes"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which is TRUE about table variables (@table) vs temp tables (#table)?",
  "options": [
    "Table variables support indexes automatically",
    "Table variables generate statistics",
    "Temp tables are stored in memory only",
    "Table variables do not generate statistics"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which statement is TRUE about TRY/CATCH?",
  "options": [
    "CATCH block can catch compile-time errors",
    "CATCH block can catch transaction abort errors",
    "CATCH block catches runtime errors only",
    "CATCH block catches RAISERROR with severity 20+"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which command returns the full definition of a stored procedure?",
  "options": [
    "sp_helptext",
    "syscomments",
    "sys.sql_modules",
    "sp_depends"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What does XACT_STATE() return when a transaction is uncommittable?",
  "options": [
    "0",
    "1",
    "-1",
    "NULL"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which constraint allows multiple NULLs?",
  "options": [
    "PRIMARY KEY",
    "UNIQUE (in SQL Server)",
    "CHECK",
    "FOREIGN KEY"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following CANNOT be used inside a scalar function?",
  "options": [
    "SELECT statement",
    "INSERT into a table",
    "Calling another scalar function",
    "Using variables"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the default isolation level in SQL Server?",
  "options": [
    "SERIALIZABLE",
    "READ COMMITTED",
    "READ UNCOMMITTED",
    "SNAPSHOT"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of these can cause a deadlock?",
  "options": [
    "Two sessions inserting into the same table",
    "Two sessions waiting on each other for locks",
    "Long-running SELECT queries",
    "Fragmented indexes"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which operator returns rows present in the first query but not the second?",
  "options": [
    "INTERSECT",
    "UNION",
    "UNION ALL",
    "EXCEPT"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "What does the OUTPUT clause in INSERT/UPDATE return?",
  "options": [
    "Only inserted rows",
    "Only updated rows",
    "Old and new values",
    "Error numbers"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which is TRUE about sequences?",
  "options": [
    "Sequence values can only increase",
    "Sequence values can be used across multiple tables",
    "Sequence resets automatically",
    "Sequence cannot be used in INSERT"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement forces SQL Server to recompile a stored procedure?",
  "options": [
    "WITH ENCRYPTION",
    "WITH RECOMPILE",
    "WITH SCHEMABINDING",
    "WITH NOCHECK"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which lock allows other transactions to read but not modify data?",
  "options": [
    "Exclusive Lock (X)",
    "Shared Lock (S)",
    "Update Lock (U)",
    "Intent Lock (I)"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which function retrieves the error message inside CATCH?",
  "options": [
    "ERROR_TEXT()",
    "ERROR_MSG()",
    "ERROR_MESSAGE()",
    "MESSAGE_TEXT()"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which of these tables can be modified using an INSTEAD OF trigger?",
  "options": [
    "System tables",
    "Views",
    "Temporary tables",
    "Memory-optimized tables"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which is TRUE about CROSS APPLY?",
  "options": [
    "Works only with scalar functions",
    "Cannot be used with table-valued functions",
    "Joins each row with the function result",
    "Returns only matching rows like INNER JOIN"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What happens when using UNION vs UNION ALL?",
  "options": [
    "UNION returns duplicates",
    "UNION ALL sorts data",
    "UNION removes duplicates",
    "UNION ALL removes duplicates"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which is TRUE about filtered indexes?",
  "options": [
    "They can include MAX columns",
    "They reduce index size by filtering rows",
    "They are slower than normal indexes",
    "They require a clustered index"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which window function returns the rank without gaps?",
  "options": [
    "RANK()",
    "DENSE_RANK()",
    "ROW_NUMBER()",
    "NTILE()"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of these resets automatically when SQL Server restarts?",
  "options": [
    "IDENTITY",
    "SEQUENCE",
    "Both",
    "Neither"
  ],
  "answer": 0,
  "time": 20
}
,
{
  "q": "Which isolation level can cause phantom reads?",
  "options": [
    "SERIALIZABLE",
    "SNAPSHOT",
    "REPEATABLE READ",
    "READ COMMITTED"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which DMV helps identify the most expensive queries executed recently?",
  "options": [
    "sys.dm_exec_cached_plans",
    "sys.dm_exec_query_stats",
    "sys.dm_exec_memory_clerks",
    "sys.dm_exec_requests"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the main disadvantage of CURSORs?",
  "options": [
    "They improve readability",
    "They operate row-by-row and reduce performance",
    "They simplify joins",
    "They prevent blocking"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What happens when SQL Server encounters a deadlock?",
  "options": [
    "Both transactions are killed",
    "One transaction is chosen as victim",
    "Both transactions roll back automatically",
    "SQL Server pauses both transactions"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement is TRUE about partitioned tables?",
  "options": [
    "Each partition must be on the same filegroup",
    "Indexes on partitioned tables must also be partitioned",
    "Partition switching requires identical table structure",
    "Partitioning improves performance always"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which statement reduces blocking without using NOLOCK?",
  "options": [
    "SET TRANSACTION ISOLATION LEVEL READ COMMITTED",
    "SET TRANSACTION ISOLATION LEVEL SNAPSHOT",
    "SET LOCK_TIMEOUT 0",
    "SET ROWCOUNT 0"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the effect of enabling READ_COMMITTED_SNAPSHOT?",
  "options": [
    "Dirty reads allowed",
    "Readers use version store instead of acquiring shared locks",
    "Writers block each other",
    "TempDB is not used at all"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What happens when you execute DELETE without a WHERE clause?",
  "options": [
    "Table becomes unusable",
    "Row-by-row deletion with logging",
    "Data is removed minimally logged",
    "Table is truncated automatically"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement about TRUNCATE TABLE is FALSE?",
  "options": [
    "It cannot be used if the table has a foreign key reference",
    "It resets the identity seed",
    "It is minimally logged",
    "It fires DELETE triggers"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "What does WAITFOR DELAY '00:00:10' do?",
  "options": [
    "Pauses query for 10 milliseconds",
    "Pauses query for 10 minutes",
    "Pauses query for 10 seconds",
    "Pauses query until a specific time"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What is the effect of OPTION (RECOMPILE) in a query?",
  "options": [
    "Disables all indexes",
    "Forces SQL Server to generate a new execution plan",
    "Deletes plan cache",
    "Runs in autocommit mode"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which function returns the last identity value generated in the session?",
  "options": [
    "SCOPE_IDENTITY()",
    "IDENT_INCR()",
    "@@IDENTITY",
    "IDENT_CURRENT()"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which function is safest for retrieving the last inserted identity value?",
  "options": [
    "@@IDENTITY",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT",
    "MAX(identity_column)"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the maximum number of clustered indexes per table?",
  "options": [
    "1",
    "2",
    "Unlimited",
    "Depends on columns"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the maximum number of non-clustered indexes allowed per table?",
  "options": [
    "999",
    "1",
    "16",
    "Unlimited"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which query detects blocked processes?",
  "options": [
    "SELECT * FROM sys.dm_exec_requests WHERE blocking_session_id <> 0",
    "SELECT * FROM sys.dm_tran_active_transactions",
    "SELECT * FROM sys.dm_db_missing_index_details",
    "SELECT * FROM sys.dm_os_wait_stats"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which index type is best for high-cardinality columns?",
  "options": [
    "Filtered Index",
    "Nonclustered Index",
    "Clustered Index",
    "Hash Index"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which database recovery model logs the least amount of data?",
  "options": [
    "FULL",
    "SIMPLE",
    "BULK_LOGGED",
    "ARCHIVE"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which feature allows multiple active result sets in one connection?",
  "options": [
    "MARS",
    "ARITHABORT",
    "FORCEPLAN",
    "SPARSE COLUMNS"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is a heap in SQL Server?",
  "options": [
    "A table without a clustered index",
    "A table without any indexes",
    "A table with fragmented pages",
    "A table with XML indexes"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which statement detects fragmentation in indexes?",
  "options": [
    "DBCC CHECKIDENT",
    "DBCC CHECKDB",
    "DBCC SHOWCONTIG",
    "sys.dm_db_index_physical_stats"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which locking hint forces row-level locking?",
  "options": [
    "ROWLOCK",
    "PAGLOCK",
    "TABLOCK",
    "NOLOCK"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which operator is used in MERGE statement for matching conditions?",
  "options": [
    "ON",
    "WHERE",
    "HAVING",
    "USING"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which system table stores sequence objects?",
  "options": [
    "sys.objects",
    "sys.sequences",
    "sys.types",
    "sys.tables"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What happens if you call NEXT VALUE FOR twice in the same SELECT?",
  "options": [
    "Both return same number",
    "Error occurs",
    "Sequence increments twice",
    "Sequence is reset"
  ],
  "answer": 2,
  "time": 20
}
,
{
  "q": "Which dynamic management view shows currently executing requests?",
  "options": [
    "sys.dm_exec_sessions",
    "sys.dm_exec_requests",
    "sys.dm_exec_query_stats",
    "sys.dm_os_workers"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which event indicates that a deadlock has occurred?",
  "options": [
    "error_reported",
    "deadlock_graph",
    "blocked_process_report",
    "sql_statement_completed"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which lock type is taken when a row is updated?",
  "options": [
    "Shared",
    "Update",
    "Exclusive",
    "Intent Exclusive"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which SQL Server feature prevents the Halloween Problem?",
  "options": [
    "Bookmark lookups",
    "Split-update",
    "Lock escalation",
    "Predicate pushdown"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which join returns rows from the left table even when no match exists on the right?",
  "options": [
    "Right Join",
    "Inner Join",
    "Left Join",
    "Cross Join"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which keyword forces SQL Server to ignore the query plan cache?",
  "options": [
    "WITH RECOMPILE",
    "OPTION (FAST)",
    "OPTION (HASH JOIN)",
    "FORCE ORDER"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which join type can cause exponential performance degradation if not indexed?",
  "options": [
    "Nested Loop Join",
    "Merge Join",
    "Hash Join",
    "Cross Join"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which FILEGROUP typically contains system objects?",
  "options": [
    "PRIMARY",
    "SECONDARY",
    "LOG",
    "TEMPDB"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which trigger fires first if both AFTER and INSTEAD OF triggers exist on a table?",
  "options": [
    "AFTER trigger",
    "INSTEAD OF trigger",
    "Random order",
    "Depends on object_id"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which SQL function is non-deterministic?",
  "options": [
    "LEN()",
    "UPPER()",
    "GETDATE()",
    "SUBSTRING()"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which table type persists only for the session and is stored in tempdb?",
  "options": [
    "Table variable",
    "Local temporary table",
    "Global temporary table",
    "Memory-optimized table"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which feature protects TempDB from contention?",
  "options": [
    "Memory-optimized tables",
    "Multiple TempDB data files",
    "Nonclustered indexes",
    "Parameter sniffing"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which SQL object cannot be referenced inside a function?",
  "options": [
    "Table variable",
    "Temporary table",
    "Inline table-valued function",
    "Scalar variable"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which clause is required for creating an Indexed View?",
  "options": [
    "WITH SCHEMABINDING",
    "WITH ENCRYPTION",
    "WITH CHECK OPTION",
    "WITH VIEW_METADATA"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which feature helps reduce parameter sniffing issues?",
  "options": [
    "OPTION (RECOMPILE)",
    "SET ARITHABORT ON",
    "SET NOCOUNT ON",
    "SET LOCK_TIMEOUT 0"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which constraint ensures column values must be unique or null?",
  "options": [
    "PRIMARY KEY",
    "UNIQUE",
    "CHECK",
    "DEFAULT"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement about CHECK constraints is TRUE?",
  "options": [
    "They fire for UPDATE but not INSERT",
    "They cannot reference multiple columns",
    "They prevent invalid data modification",
    "They execute after triggers"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which operator returns rows in one table but not the other?",
  "options": [
    "EXCEPT",
    "UNION",
    "INTERSECT",
    "CROSS APPLY"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which SQL feature allows reuse of an execution plan?",
  "options": [
    "Forced parameterization",
    "SET NOCOUNT ON",
    "TRY_CONVERT",
    "FORMAT()"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which DMV helps find missing indexes?",
  "options": [
    "sys.dm_db_missing_index_details",
    "sys.dm_exec_text_query_plan",
    "sys.dm_os_wait_stats",
    "sys.dm_exec_connections"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which condition triggers lock escalation?",
  "options": [
    "Small table scans",
    "Large number of row/page locks",
    "Indexed operations",
    "Deadlock detection"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which structure is used by SQL Server to maintain data inside a page?",
  "options": [
    "B-Tree",
    "Hash Table",
    "AVL Tree",
    "Trie"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which SQL keyword is used inside CTE for recursion?",
  "options": [
    "UNION ALL",
    "JOIN",
    "DISTINCT",
    "MERGE"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which isolation level uses row-versioning in TempDB?",
  "options": [
    "REPEATABLE READ",
    "READ COMMITTED SNAPSHOT",
    "SERIALIZABLE",
    "READ UNCOMMITTED"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which query returns the wait types consuming most time?",
  "options": [
    "SELECT * FROM sys.dm_exec_sessions",
    "SELECT * FROM sys.dm_os_wait_stats",
    "SELECT * FROM sys.dm_db_index_usage_stats",
    "SELECT * FROM sys.dm_os_memory_clerks"
  ],
  "answer": 1,
  "time": 20
}
,

  {
    "q": "What is a User-Defined Table Type (UDTT) in SQL Server?",
    "options": [
      "A permanent table in the database",
      "A custom table structure used to pass multiple rows to procedures/functions",
      "A temporary table stored in tempdb",
      "A datatype that stores JSON objects"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of the following constraints can be used in a UDTT?",
    "options": [
      "PRIMARY KEY",
      "UNIQUE",
      "CHECK",
      "All of the above"
    ],
    "answer": 3,
    "time": 15
  },
  {
    "q": "Why does `SELECT * FROM EmployeeType` fail after creating a UDTT?",
    "options": [
      "EmployeeType is not a table, it is a type",
      "The table is empty",
      "The database is locked",
      "EmployeeType must be prefixed with dbo."
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "How can you use a UDTT in SQL Server?",
    "options": [
      "Directly select from it like a table",
      "Declare a variable of that type, insert rows, then select from it",
      "Use it only in temporary tables",
      "It cannot be used in SQL Server"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the purpose of a Table-Valued Parameter (TVP)?",
    "options": [
      "To allow multiple rows to be passed as a single parameter to a stored procedure or function",
      "To store JSON data",
      "To define a new table in the database",
      "To replace indexes"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which of the following is the correct way to pass multiple rows to a stored procedure using a UDTT?",
    "options": [
      "Insert directly into the procedure parameter",
      "Declare a variable of UDTT type, insert rows into it, and pass the variable",
      "Create a temp table and pass its name",
      "Serialize rows into XML and pass as string"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What does the `OFFSET` clause in SQL Server do?",
    "options": [
      "Limits the number of rows returned from a query",
      "Skips a number of rows and optionally fetches the next set of rows",
      "Updates rows in a table",
      "Deletes rows after a certain offset"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "How would you skip the first 50 rows and fetch the next 10 in SQL Server?",
    "options": [
      "SELECT TOP 10 * FROM Table",
      "SELECT * FROM Table ORDER BY ID OFFSET 50 ROWS FETCH NEXT 10 ROWS ONLY",
      "SELECT * FROM Table LIMIT 50, 10",
      "SELECT * FROM Table WHERE RowNumber > 50 AND RowNumber <= 60"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "How can you assign a value from a table to a variable in SQL Server?",
    "options": [
      "SET @Var = SELECT ID FROM Table",
      "DECLARE @Var = SELECT TOP 1 ID FROM Table ORDER BY Date DESC",
      "DECLARE @Var INT; SET @Var = (SELECT TOP 1 ID FROM Table ORDER BY Date DESC)",
      "SELECT @Var = ID FROM Table"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which of the following is an alternative to using a UDTT for passing multiple rows?",
    "options": [
      "#Temp tables",
      "XML or JSON serialized string",
      "Bulk Insert / BCP",
      "All of the above"
    ],
    "answer": 3,
    "time": 20
  }
,  {
    "q": "Which of the following statements about UDTTs is TRUE?",
    "options": [
      "A UDTT creates a permanent table in the database",
      "A UDTT can be indexed directly like a normal table",
      "A UDTT can have DEFAULT constraints from SQL Server 2012 onwards",
      "You can use a UDTT in a SELECT statement without declaring a variable"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "When creating a TVP in a stored procedure, why must it be marked as READONLY?",
    "options": [
      "Because TVPs are temporary tables",
      "Because table-valued parameters cannot be modified inside the procedure",
      "Because SQL Server requires all parameters to be READONLY",
      "To allow multiple rows to be inserted"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of these is the correct syntax to declare a table variable of type UDTT?",
    "options": [
      "DECLARE @EmpList AS EmployeeType;",
      "DECLARE @EmpList EmployeeType;",
      "DECLARE EmployeeType @EmpList;",
      "DECLARE TABLE @EmpList EmployeeType;"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "You have inserted multiple rows into a UDTT variable. How can you access these rows?",
    "options": [
      "Directly select from the UDTT type",
      "Use SELECT from the variable declared of that UDTT type",
      "Call a system function to fetch rows",
      "Only insert them into a permanent table first"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of the following is TRUE about using OFFSET with FETCH in SQL Server?",
    "options": [
      "OFFSET can be used without ORDER BY",
      "FETCH NEXT cannot be used with OFFSET",
      "OFFSET must always be used with ORDER BY",
      "It automatically creates a row number column"
    ],
    "answer": 2,
    "time": 15
  },
  {
    "q": "If you want to get the last 10 records from a table using OFFSET/FETCH, what is the correct approach?",
    "options": [
      "ORDER BY ID DESC OFFSET 0 ROWS FETCH NEXT 10 ROWS ONLY",
      "OFFSET 10 ROWS FETCH LAST 10 ROWS",
      "SELECT TOP 10 * FROM Table ORDER BY ID ASC",
      "You cannot get last N rows with OFFSET/FETCH"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which of the following is a correct way to assign a table column value to a variable for further processing?",
    "options": [
      "DECLARE @MaxID INT = (SELECT MAX(ID) FROM Table);",
      "SET @MaxID = SELECT MAX(ID) FROM Table;",
      "SELECT MAX(ID) INTO @MaxID FROM Table;",
      "INSERT INTO @MaxID SELECT MAX(ID) FROM Table;"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which of the following is NOT a correct use case for a UDTT?",
    "options": [
      "Passing multiple rows to a stored procedure",
      "Batch inserts from an application",
      "Replacing a permanent table in the database",
      "Enforcing constraints on temporary data"
    ],
    "answer": 2,
    "time": 15
  },
  {
    "q": "You need to pass 10,000 rows from a .NET application to SQL Server. Which method is most efficient?",
    "options": [
      "Pass them as 10,000 individual INSERT statements",
      "Use a TVP with a UDTT",
      "Serialize them into a JSON string and parse in SQL Server",
      "Store in a temp table and read row by row"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which of the following statements about table variables is TRUE?",
    "options": [
      "They persist after the session ends",
      "They can have indexes defined implicitly via PRIMARY KEY or UNIQUE",
      "You can create foreign key relationships on them",
      "They cannot be passed as parameters"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "If a UDTT column has a DEFAULT constraint, when is it applied?",
    "options": [
      "When the table type is created",
      "When rows are inserted into a variable of that type without specifying the column",
      "When querying the UDTT variable",
      "SQL Server ignores DEFAULT constraints in UDTT"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "You want to skip 100 rows and fetch next 50 from a table for pagination. Which clause is correct?",
    "options": [
      "OFFSET 50 ROWS FETCH NEXT 100 ROWS ONLY",
      "OFFSET 100 ROWS FETCH NEXT 50 ROWS ONLY",
      "LIMIT 50,100",
      "SELECT TOP 50 SKIP 100"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What happens if you try to modify a TVP inside a stored procedure?",
    "options": [
      "It works like a normal table",
      "It throws an error because TVPs are READONLY",
      "It silently ignores changes",
      "It only allows DELETE operations"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "Which of these can you NOT do directly with a UDTT variable?",
    "options": [
      "Insert multiple rows",
      "Select rows",
      "Join with other tables",
      "Create foreign keys referencing other tables"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "Which is the correct way to use a UDTT variable in a stored procedure call from SQL?",
    "options": [
      "EXEC InsertEmployees EmployeeType",
      "DECLARE @EmpList EmployeeType; EXEC InsertEmployees @EmpList;",
      "SELECT * FROM EmployeeType; EXEC InsertEmployees",
      "CREATE TABLE @EmpList AS EmployeeType; EXEC InsertEmployees @EmpList;"
    ],
    "answer": 1,
    "time": 20
  }
,
  {
    "q": "Which of the following statements about a UDTT (User-Defined Table Type) is FALSE?",
    "options": [
      "You can declare variables of that type and use them like a table",
      "You can directly query the UDTT type without declaring a variable",
      "A UDTT can have PRIMARY KEY, UNIQUE, and CHECK constraints",
      "UDTT can have DEFAULT values from SQL Server 2012 onwards"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Why must a Table-Valued Parameter (TVP) be marked as READONLY in a stored procedure?",
    "options": [
      "Because SQL Server does not allow modifying the contents of TVPs inside procedures",
      "It is optional, you can modify TVPs if needed",
      "To allow automatic indexing of TVP data",
      "To ensure TVPs are treated as temp tables"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Given a UDTT `EmployeeType`, which is the correct way to select data after inserting rows?",
    "options": [
      "SELECT * FROM EmployeeType;",
      "DECLARE @EmpList EmployeeType; INSERT INTO @EmpList ...; SELECT * FROM @EmpList;",
      "EXEC EmployeeType;",
      "INSERT INTO EmployeeType VALUES (...)"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "If a UDTT column has a DEFAULT constraint, when is it applied?",
    "options": [
      "During type creation",
      "During insertion into a variable of that type without specifying the column",
      "During querying the variable",
      "It is never applied"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of the following is NOT allowed when defining a UDTT?",
    "options": [
      "PRIMARY KEY constraint",
      "DEFAULT constraint (SQL Server 2012+)",
      "FOREIGN KEY constraint referencing another table",
      "CHECK constraint"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "What is the most efficient way to insert 10,000 rows from an application into SQL Server?",
    "options": [
      "Send 10,000 individual INSERT statements",
      "Use a Table-Valued Parameter (TVP) with a UDTT",
      "Serialize rows into JSON and parse inside SQL",
      "Use a temp table and loop over rows"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which of the following is TRUE about table variables declared with a UDTT?",
    "options": [
      "They persist after session ends",
      "They can have indexes via PRIMARY KEY or UNIQUE",
      "They can reference other tables via FOREIGN KEY",
      "They automatically log all changes in the transaction log"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "If you declare a variable of a UDTT but do not insert any rows, what happens when you select from it?",
    "options": [
      "It throws an error",
      "It returns an empty result set",
      "It creates the table dynamically in the database",
      "It returns NULL for all columns"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "Which scenario is ideal for using a UDTT?",
    "options": [
      "Passing a single scalar value to a procedure",
      "Passing multiple rows as a single parameter to a procedure",
      "Temporary storage for small calculations",
      "Replacing a permanent table in the database"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "What is the correct way to declare a variable of UDTT type `EmployeeType`?",
    "options": [
      "DECLARE @EmpList AS EmployeeType;",
      "DECLARE @EmpList EmployeeType;",
      "DECLARE EmployeeType @EmpList;",
      "DECLARE TABLE @EmpList EmployeeType;"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "Why does `SELECT * FROM EmployeeType` throw 'Invalid object name'?",
    "options": [
      "The table does not exist yet",
      "EmployeeType is a type, not a table; you must declare a variable of that type first",
      "EmployeeType is a temp table",
      "You need to prefix it with dbo."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of these is a correct usage of OFFSET/FETCH in SQL Server?",
    "options": [
      "SELECT * FROM Table OFFSET 50 ROWS FETCH NEXT 10 ROWS ONLY;",
      "SELECT * FROM Table FETCH NEXT 10 ROWS OFFSET 50 ROWS;",
      "SELECT TOP 10 * FROM Table OFFSET 50;",
      "SELECT * FROM Table LIMIT 50,10"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "What happens if you try to modify a TVP inside a procedure?",
    "options": [
      "It works like a normal table",
      "It throws an error because TVPs are READONLY",
      "It ignores the changes silently",
      "It allows only DELETE operations"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "How can you assign the latest ID from a table to a variable in SQL Server?",
    "options": [
      "DECLARE @ID INT = (SELECT MAX(ID) FROM Table);",
      "SET @ID = SELECT MAX(ID) FROM Table;",
      "INSERT INTO @ID SELECT MAX(ID) FROM Table;",
      "SELECT MAX(ID) INTO @ID FROM Table;"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "Which of the following can you NOT do directly with a UDTT variable?",
    "options": [
      "Insert multiple rows",
      "Select rows",
      "Join with other tables",
      "Create foreign key relationships referencing other tables"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "If you want to skip 100 rows and fetch the next 50 for pagination, which syntax is correct?",
    "options": [
      "OFFSET 50 ROWS FETCH NEXT 100 ROWS ONLY",
      "OFFSET 100 ROWS FETCH NEXT 50 ROWS ONLY",
      "LIMIT 50,100",
      "SELECT TOP 50 SKIP 100"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of the following is NOT a valid alternative to using UDTT for passing multiple rows?",
    "options": [
      "#Temp tables",
      "XML or JSON serialized string",
      "Bulk Insert / BCP",
      "Scalar variable"
    ],
    "answer": 3,
    "time": 15
  },
  {
    "q": "Which statement about default values in UDTT columns is TRUE?",
    "options": [
      "They are ignored when inserting into a variable of that type",
      "They are applied when rows are inserted without specifying the column value",
      "They are applied during SELECT statements",
      "They can be overridden in the stored procedure parameter definition"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is a key advantage of using TVPs over individual INSERT statements?",
    "options": [
      "They are faster because they reduce round-trips between application and server",
      "They automatically create indexes",
      "They require no permissions",
      "They allow modification of read-only tables"
    ],
    "answer": 0,
    "time": 20
  },
  {
    "q": "How would you insert multiple rows into a UDTT variable before passing it to a stored procedure?",
    "options": [
      "Use multiple EXEC statements",
      "Use INSERT INTO @Variable (columns) VALUES (...), (...), ...;",
      "Use BULK INSERT only",
      "Directly assign a SELECT query to the variable"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which of the following is TRUE about performance when using UDTTs and TVPs?",
    "options": [
      "They are slower than individual inserts for large batches",
      "They reduce network overhead by passing multiple rows in a single call",
      "They automatically optimize queries with indexes",
      "They cannot be used for more than 1000 rows at a time"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which clause must always be used with OFFSET in SQL Server?",
    "options": [
      "WHERE",
      "ORDER BY",
      "TOP",
      "GROUP BY"
    ],
    "answer": 1,
    "time": 15
  },
  {
    "q": "When declaring a variable from a UDTT, which is TRUE about inserting rows with missing columns having DEFAULT values?",
    "options": [
      "An error occurs if any column is missing",
      "The DEFAULT value is applied for missing columns",
      "NULL is automatically inserted instead of DEFAULT",
      "The variable cannot accept missing columns"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Which scenario would be LEAST suitable for using UDTT?",
    "options": [
      "Passing thousands of rows from an application to SQL Server",
      "Enforcing constraints on a temporary dataset",
      "Passing a single row or small number of rows",
      "Batch processing for ETL operations"
    ],
    "answer": 2,
    "time": 15
  }
,
{
    "q": "Which SQL Server function is commonly used to format DATETIME values into strings with style codes?",
    "options": [
        "FORMAT()",
        "CONVERT()",
        "CAST()",
        "DATEPART()"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which style code in CONVERT returns a date in the format '21 Jul 2016'?",
    "options": [
        "104",
        "106",
        "107",
        "112"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "What is the advantage of using FORMAT() over CONVERT() in SQL Server?",
    "options": [
        "FORMAT() is faster for large datasets",
        "FORMAT() allows custom date and culture-specific formatting",
        "FORMAT() does not require ORDER BY",
        "FORMAT() can only format time, not date"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Given `DECLARE @Date DATETIME = '2016-09-05 00:01:02.333'`, what does `FORMAT(@Date, N'dddd, MMMM dd, yyyy hh:mm:ss tt')` return?",
    "options": [
        "2016-09-05 00:01:02.333",
        "Monday, September 05, 2016 12:01:02 AM",
        "09/05/2016 12:01 AM",
        "Monday, 5 September 2016"
    ],
    "answer": 1,
    "time": 25
},
{
    "q": "Which standard format specifier returns a full date and time in UTC in FORMAT()?",
    "options": [
        "D",
        "U",
        "s",
        "R"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "How can you calculate a person's age on a specific date using SQL Server?",
    "options": [
        "DATEDIFF(YEAR, DOB, GETDATE())",
        "Use a scalar function with YEAR difference and adjustment based on birthday",
        "DATEPART(YEAR, DOB) - DATEPART(YEAR, GETDATE())",
        "FORMAT(DOB, 'yyyy')"
    ],
    "answer": 1,
    "time": 25
},
{
    "q": "What does the OUTPUT clause in SQL Server do?",
    "options": [
        "Captures before/after state of rows during INSERT, UPDATE, DELETE, or MERGE",
        "Logs queries in SQL Server Agent",
        "Displays result in a message box",
        "Automatically formats the output"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which table variable correctly captures the OUTPUT of an INSERT into Employees table?",
    "options": [
        "DECLARE @Inserted TABLE (EmpID INT, EmpName VARCHAR(50), Salary INT);",
        "DECLARE @Inserted Employees;",
        "CREATE TABLE @Inserted AS Employees;",
        "DECLARE @Inserted INT;"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "In a MERGE statement with OUTPUT, which of the following can be captured?",
    "options": [
        "Only inserted rows",
        "Only deleted rows",
        "All actions including UPDATE, INSERT, DELETE",
        "Only the row count"
    ],
    "answer": 2,
    "time": 25
},
{
    "q": "What is a stored procedure in SQL Server?",
    "options": [
        "A saved query with no parameters",
        "A collection of SQL statements that can accept parameters and return results",
        "A view that is materialized",
        "A table with triggers"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "Which of the following is NOT a benefit of stored procedures?",
    "options": [
        "Reduced network traffic",
        "Execution plan caching",
        "Automatic indexing",
        "Reusability and security"
    ],
    "answer": 2,
    "time": 15
},
{
    "q": "What is the correct way to execute a stored procedure `GetProductDesc_withparameters` with parameter @PID = 706?",
    "options": [
        "EXEC GetProductDesc_withparameters 706;",
        "SELECT * FROM GetProductDesc_withparameters(706);",
        "CALL GetProductDesc_withparameters(706);",
        "EXECUTE SELECT GetProductDesc_withparameters WHERE PID=706;"
    ],
    "answer": 0,
    "time": 15
},
{
    "q": "Which scenario is a common use case for OUTPUT in SQL Server?",
    "options": [
        "Capturing auto-generated IDs after INSERT",
        "Modifying multiple rows without logging",
        "Replacing a stored procedure",
        "Performing server-level backups"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which FORMAT() argument changes the culture-specific output?",
    "options": [
        "First argument",
        "Second argument",
        "Third argument",
        "FORMAT() does not support culture"
    ],
    "answer": 2,
    "time": 20
},
{
    "q": "How would you implement an inline age calculation without creating a function?",
    "options": [
        "DATEDIFF(YEAR, DOB, GETDATE()) - CASE WHEN DATEADD(YEAR, DATEDIFF(YEAR, DOB, GETDATE()), DOB) > GETDATE() THEN 1 ELSE 0 END",
        "YEAR(GETDATE()) - YEAR(DOB)",
        "FORMAT(GETDATE(), 'yyyy') - FORMAT(DOB, 'yyyy')",
        "DATEPART(MONTH, GETDATE()) - DATEPART(MONTH, DOB)"
    ],
    "answer": 0,
    "time": 25
},
{
    "q": "Which OUTPUT scenario can capture both OLD and NEW values during an UPDATE?",
    "options": [
        "OUTPUT INSERTED.* INTO @TableVar",
        "OUTPUT DELETED.* INTO @TableVar",
        "OUTPUT DELETED.Salary AS OldSalary, INSERTED.Salary AS NewSalary INTO @TableVar",
        "OUTPUT $action INTO @TableVar"
    ],
    "answer": 2,
    "time": 25
},
{
    "q": "In an UPDATE with OUTPUT clause, which keyword represents the previous value of a column?",
    "options": [
        "INSERTED",
        "DELETED",
        "OLD",
        "NEW"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "Which of the following is TRUE about FORMAT() vs CONVERT()?",
    "options": [
        "FORMAT() uses .NET style formatting and supports culture, CONVERT() uses numeric style codes",
        "CONVERT() supports custom culture formatting",
        "FORMAT() is faster than CONVERT() for large datasets",
        "CONVERT() cannot convert datetime to string"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which OUTPUT clause usage is correct for DELETE operation?",
    "options": [
        "OUTPUT INSERTED.* INTO @Deleted",
        "OUTPUT DELETED.* INTO @Deleted",
        "OUTPUT $action INTO @Deleted",
        "Cannot use OUTPUT with DELETE"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Why would you prefer a stored procedure over inline queries in application code?",
    "options": [
        "For security, reusability, performance, and reduced network traffic",
        "Because stored procedures automatically index tables",
        "To allow client applications to modify database schema",
        "Because stored procedures cannot fail"
    ],
    "answer": 0,
    "time": 20
}
,
{
    "q": "Which of the following statements about a UDTT (User-Defined Table Type) is FALSE?",
    "options": [
        "You can declare variables of that type and use them like a table",
        "You can directly query the UDTT type without declaring a variable",
        "A UDTT can have PRIMARY KEY, UNIQUE, and CHECK constraints",
        "UDTT can have DEFAULT values from SQL Server 2012 onwards"
    ],
    "answer": 1,
    "time": 25
},
{
    "q": "Why must a Table-Valued Parameter (TVP) be marked as READONLY in a stored procedure?",
    "options": [
        "Because SQL Server does not allow modifying the contents of TVPs inside procedures",
        "It is optional, you can modify TVPs if needed",
        "To allow automatic indexing of TVP data",
        "To ensure TVPs are treated as temp tables"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Given a UDTT `EmployeeType`, which is the correct way to select data after inserting rows?",
    "options": [
        "SELECT * FROM EmployeeType;",
        "DECLARE @EmpList EmployeeType; INSERT INTO @EmpList ...; SELECT * FROM @EmpList;",
        "EXEC EmployeeType;",
        "INSERT INTO EmployeeType VALUES (...)"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "If a UDTT column has a DEFAULT constraint, when is it applied?",
    "options": [
        "During type creation",
        "During insertion into a variable of that type without specifying the column",
        "During querying the variable",
        "It is never applied"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which of the following is NOT allowed when defining a UDTT?",
    "options": [
        "PRIMARY KEY constraint",
        "DEFAULT constraint (SQL Server 2012+)",
        "FOREIGN KEY constraint referencing another table",
        "CHECK constraint"
    ],
    "answer": 2,
    "time": 25
},
{
    "q": "What is the most efficient way to insert 10,000 rows from an application into SQL Server?",
    "options": [
        "Send 10,000 individual INSERT statements",
        "Use a Table-Valued Parameter (TVP) with a UDTT",
        "Serialize rows into JSON and parse inside SQL",
        "Use a temp table and loop over rows"
    ],
    "answer": 1,
    "time": 25
},
{
    "q": "Which of the following is TRUE about table variables declared with a UDTT?",
    "options": [
        "They persist after session ends",
        "They can have indexes via PRIMARY KEY or UNIQUE",
        "They can reference other tables via FOREIGN KEY",
        "They automatically log all changes in the transaction log"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "If you declare a variable of a UDTT but do not insert any rows, what happens when you select from it?",
    "options": [
        "It throws an error",
        "It returns an empty result set",
        "It creates the table dynamically in the database",
        "It returns NULL for all columns"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "Which scenario is ideal for using a UDTT?",
    "options": [
        "Passing a single scalar value to a procedure",
        "Passing multiple rows as a single parameter to a procedure",
        "Temporary storage for small calculations",
        "Replacing a permanent table in the database"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "What is the correct way to declare a variable of UDTT type `EmployeeType`?",
    "options": [
        "DECLARE @EmpList AS EmployeeType;",
        "DECLARE @EmpList EmployeeType;",
        "DECLARE EmployeeType @EmpList;",
        "DECLARE TABLE @EmpList EmployeeType;"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "Why does `SELECT * FROM EmployeeType` throw 'Invalid object name'?",
    "options": [
        "The table does not exist yet",
        "EmployeeType is a type, not a table; you must declare a variable of that type first",
        "EmployeeType is a temp table",
        "You need to prefix it with dbo."
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which of these is a correct usage of OFFSET/FETCH in SQL Server?",
    "options": [
        "SELECT * FROM Table OFFSET 50 ROWS FETCH NEXT 10 ROWS ONLY;",
        "SELECT * FROM Table FETCH NEXT 10 ROWS OFFSET 50 ROWS;",
        "SELECT TOP 10 * FROM Table OFFSET 50;",
        "SELECT * FROM Table LIMIT 50,10"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "What happens if you try to modify a TVP inside a procedure?",
    "options": [
        "It works like a normal table",
        "It throws an error because TVPs are READONLY",
        "It ignores the changes silently",
        "It allows only DELETE operations"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "How can you assign the latest ID from a table to a variable in SQL Server?",
    "options": [
        "DECLARE @ID INT = (SELECT MAX(ID) FROM Table);",
        "SET @ID = SELECT MAX(ID) FROM Table;",
        "INSERT INTO @ID SELECT MAX(ID) FROM Table;",
        "SELECT MAX(ID) INTO @ID FROM Table;"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which of the following can you NOT do directly with a UDTT variable?",
    "options": [
        "Insert multiple rows",
        "Select rows",
        "Join with other tables",
        "Create foreign key relationships referencing other tables"
    ],
    "answer": 3,
    "time": 20
},
{
    "q": "If you want to skip 100 rows and fetch the next 50 for pagination, which syntax is correct?",
    "options": [
        "OFFSET 50 ROWS FETCH NEXT 100 ROWS ONLY",
        "OFFSET 100 ROWS FETCH NEXT 50 ROWS ONLY",
        "LIMIT 50,100",
        "SELECT TOP 50 SKIP 100"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which of the following is NOT a valid alternative to using UDTT for passing multiple rows?",
    "options": [
        "#Temp tables",
        "XML or JSON serialized string",
        "Bulk Insert / BCP",
        "Scalar variable"
    ],
    "answer": 3,
    "time": 15
},
{
    "q": "Which statement about default values in UDTT columns is TRUE?",
    "options": [
        "They are ignored when inserting into a variable of that type",
        "They are applied when rows are inserted without specifying the column value",
        "They are applied during SELECT statements",
        "They can be overridden in the stored procedure parameter definition"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "What is a key advantage of using TVPs over individual INSERT statements?",
    "options": [
        "They are faster because they reduce round-trips between application and server",
        "They automatically create indexes",
        "They require no permissions",
        "They allow modification of read-only tables"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "How would you insert multiple rows into a UDTT variable before passing it to a stored procedure?",
    "options": [
        "Use multiple EXEC statements",
        "Use INSERT INTO @Variable (columns) VALUES (...), (...), ...;",
        "Use BULK INSERT only",
        "Directly assign a SELECT query to the variable"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which of the following is TRUE about performance when using UDTTs and TVPs?",
    "options": [
        "They are slower than individual inserts for large batches",
        "They reduce network overhead by passing multiple rows in a single call",
        "They automatically optimize queries with indexes",
        "They cannot be used for more than 1000 rows at a time"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which clause must always be used with OFFSET in SQL Server?",
    "options": [
        "WHERE",
        "ORDER BY",
        "TOP",
        "GROUP BY"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "When declaring a variable from a UDTT, which is TRUE about inserting rows with missing columns having DEFAULT values?",
    "options": [
        "An error occurs if any column is missing",
        "The DEFAULT value is applied for missing columns",
        "NULL is automatically inserted instead of DEFAULT",
        "The variable cannot accept missing columns"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which scenario would be LEAST suitable for using UDTT?",
    "options": [
        "Passing thousands of rows from an application to SQL Server",
        "Enforcing constraints on a temporary dataset",
        "Passing a single row or small number of rows",
        "Batch processing for ETL operations"
    ],
    "answer": 2,
    "time": 15
},
{
    "q": "Which SQL Server function is commonly used to format DATETIME values into strings with style codes?",
    "options": [
        "FORMAT()",
        "CONVERT()",
        "CAST()",
        "DATEPART()"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which style code in CONVERT returns a date in the format '21 Jul 2016'?",
    "options": [
        "104",
        "106",
        "107",
        "112"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "What is the advantage of using FORMAT() over CONVERT() in SQL Server?",
    "options": [
        "FORMAT() is faster for large datasets",
        "FORMAT() allows custom date and culture-specific formatting",
        "FORMAT() does not require ORDER BY",
        "FORMAT() can only format time, not date"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Given `DECLARE @Date DATETIME = '2016-09-05 00:01:02.333'`, what does `FORMAT(@Date, N'dddd, MMMM dd, yyyy hh:mm:ss tt')` return?",
    "options": [
        "2016-09-05 00:01:02.333",
        "Monday, September 05, 2016 12:01:02 AM",
        "09/05/2016 12:01 AM",
        "Monday, 5 September 2016"
    ],
    "answer": 1,
    "time": 25
},
{
    "q": "Which standard format specifier returns a full date and time in UTC in FORMAT()?",
    "options": [
        "D",
        "U",
        "s",
        "R"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "How can you calculate a person's age on a specific date using SQL Server?",
    "options": [
        "DATEDIFF(YEAR, DOB, GETDATE())",
        "Use a scalar function with YEAR difference and adjustment based on birthday",
        "DATEPART(YEAR, DOB) - DATEPART(YEAR, GETDATE())",
        "FORMAT(DOB, 'yyyy')"
    ],
    "answer": 1,
    "time": 25
},
{
    "q": "What does the OUTPUT clause in SQL Server do?",
    "options": [
        "Captures before/after state of rows during INSERT, UPDATE, DELETE, or MERGE",
        "Logs queries in SQL Server Agent",
        "Displays result in a message box",
        "Automatically formats the output"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which table variable correctly captures the OUTPUT of an INSERT into Employees table?",
    "options": [
        "DECLARE @Inserted TABLE (EmpID INT, EmpName VARCHAR(50), Salary INT);",
        "DECLARE @Inserted Employees;",
        "CREATE TABLE @Inserted AS Employees;",
        "DECLARE @Inserted INT;"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "In a MERGE statement with OUTPUT, which of the following can be captured?",
    "options": [
        "Only inserted rows",
        "Only deleted rows",
        "All actions including UPDATE, INSERT, DELETE",
        "Only the row count"
    ],
    "answer": 2,
    "time": 25
},
{
    "q": "What is a stored procedure in SQL Server?",
    "options": [
        "A saved query with no parameters",
        "A collection of SQL statements that can accept parameters and return results",
        "A view that is materialized",
        "A table with triggers"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "Which of the following is NOT a benefit of stored procedures?",
    "options": [
        "Reduced network traffic",
        "Execution plan caching",
        "Automatic indexing",
        "Reusability and security"
    ],
    "answer": 2,
    "time": 15
},
{
    "q": "What is the correct way to execute a stored procedure `GetProductDesc_withparameters` with parameter @PID = 706?",
    "options": [
        "EXEC GetProductDesc_withparameters 706;",
        "SELECT * FROM GetProductDesc_withparameters(706);",
        "CALL GetProductDesc_withparameters(706);",
        "EXECUTE SELECT GetProductDesc_withparameters WHERE PID=706;"
    ],
    "answer": 0,
    "time": 15
},
{
    "q": "Which scenario is a common use case for OUTPUT in SQL Server?",
    "options": [
        "Capturing auto-generated IDs after INSERT",
        "Modifying multiple rows without logging",
        "Replacing a stored procedure",
        "Performing server-level backups"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which FORMAT() argument changes the culture-specific output?",
    "options": [
        "First argument",
        "Second argument",
        "Third argument",
        "FORMAT() does not support culture"
    ],
    "answer": 2,
    "time": 20
},
{
    "q": "How would you implement an inline age calculation without creating a function?",
    "options": [
        "DATEDIFF(YEAR, DOB, GETDATE()) - CASE WHEN DATEADD(YEAR, DATEDIFF(YEAR, DOB, GETDATE()), DOB) > GETDATE() THEN 1 ELSE 0 END",
        "YEAR(GETDATE()) - YEAR(DOB)",
        "FORMAT(GETDATE(), 'yyyy') - FORMAT(DOB, 'yyyy')",
        "DATEPART(MONTH, GETDATE()) - DATEPART(MONTH, DOB)"
    ],
    "answer": 0,
    "time": 25
},
{
    "q": "Which OUTPUT scenario can capture both OLD and NEW values during an UPDATE?",
    "options": [
        "OUTPUT INSERTED.* INTO @TableVar",
        "OUTPUT DELETED.* INTO @TableVar",
        "OUTPUT DELETED.Salary AS OldSalary, INSERTED.Salary AS NewSalary INTO @TableVar",
        "OUTPUT $action INTO @TableVar"
    ],
    "answer": 2,
    "time": 25
},
{
    "q": "In an UPDATE with OUTPUT clause, which keyword represents the previous value of a column?",
    "options": [
        "INSERTED",
        "DELETED",
        "OLD",
        "NEW"
    ],
    "answer": 1,
    "time": 15
},
{
    "q": "Which of the following is TRUE about FORMAT() vs CONVERT()?",
    "options": [
        "FORMAT() uses .NET style formatting and supports culture, CONVERT() uses numeric style codes",
        "CONVERT() supports custom culture formatting",
        "FORMAT() is faster than CONVERT() for large datasets",
        "CONVERT() cannot convert datetime to string"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which OUTPUT clause usage is correct for DELETE operation?",
    "options": [
        "OUTPUT INSERTED.* INTO @Deleted",
        "OUTPUT DELETED.* INTO @Deleted",
        "OUTPUT $action INTO @Deleted",
        "Cannot use OUTPUT with DELETE"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Why would you prefer a stored procedure over inline queries in application code?",
    "options": [
        "For security, reusability, performance, and reduced network traffic",
        "Because stored procedures automatically index tables",
        "To allow client applications to modify database schema",
        "Because stored procedures cannot fail"
    ],
    "answer": 0,
    "time": 20
}

,
{
    "q": "Which SQL statement is used to modify an existing stored procedure without dropping it?",
    "options": [
        "ALTER PROCEDURE",
        "UPDATE PROCEDURE",
        "MODIFY PROCEDURE",
        "REPLACE PROCEDURE"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "How do you rename an existing stored procedure in SQL Server?",
    "options": [
        "ALTER PROCEDURE OldName TO NewName",
        "sp_rename 'OldName', 'NewName'",
        "RENAME PROCEDURE OldName NewName",
        "UPDATE sys.procedures SET Name='NewName' WHERE Name='OldName'"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "What is the correct way to declare an OUTPUT parameter in a stored procedure?",
    "options": [
        "@ParamName INT OUTPUT",
        "@ParamName INT OUT",
        "@ParamName OUTPUT INT",
        "OUTPUT @ParamName INT"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which of the following is a correct way to execute a stored procedure with an OUTPUT parameter?",
    "options": [
        "EXEC proc_name 'value', @Var OUTPUT",
        "EXEC proc_name 'value', 5 OUTPUT",
        "EXEC proc_name 'value', @Var",
        "EXEC proc_name @Var OUTPUT"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Why does SQL Server throw 'Procedure expects parameter which was not supplied'?",
    "options": [
        "You did not pass a value for a required OUTPUT parameter",
        "You passed NULL instead of a variable",
        "The procedure does not exist",
        "The input parameter type is incorrect"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Why does SQL Server throw 'Cannot use OUTPUT option when passing a constant'?",
    "options": [
        "OUTPUT parameters can only be assigned to variables, not constants",
        "The procedure is read-only",
        "Constants are allowed, but must be cast",
        "The OUTPUT parameter is optional"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which of the following steps correctly fixes errors when using OUTPUT parameters?",
    "options": [
        "Declare a variable, pass it with OUTPUT keyword, then use the variable",
        "Pass a constant instead of variable",
        "Do not declare OUTPUT in procedure",
        "Use RETURN instead of OUTPUT"
    ],
    "answer": 0,
    "time": 25
},
{
    "q": "What does RAISERROR do in SQL Server?",
    "options": [
        "Generates custom error messages with specified severity and state",
        "Logs messages silently in SQL Server Agent",
        "Only prints informational messages",
        "Stops SQL Server service"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which RAISERROR severity levels indicate user-defined errors that can be caught?",
    "options": [
        "0–10",
        "11–18",
        "19–25",
        "All levels"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "Which RAISERROR syntax triggers an immediate message to the client and logs it?",
    "options": [
        "RAISERROR('Error', 16, 1) WITH LOG, NOWAIT",
        "RAISERROR('Error', 0, 1)",
        "RAISERROR('Error', 10, 0) WITH LOG",
        "RAISERROR('Error', 16, 1) NOWAIT"
    ],
    "answer": 0,
    "time": 25
},
{
    "q": "In the InsertEmployee procedure, why does RAISERROR prevent insertion?",
    "options": [
        "Because the condition Salary < 5000 is met",
        "Because RAISERROR always stops execution",
        "Because PRINT statements are ignored",
        "Because the table is locked"
    ],
    "answer": 0,
    "time": 20
},
{
    "q": "Which keyword is used to stop execution after RAISERROR in a procedure?",
    "options": [
        "RETURN",
        "EXIT",
        "STOP",
        "BREAK"
    ],
    "answer": 0,
    "time": 15
},
{
    "q": "What is a common use case for RAISERROR inside a stored procedure?",
    "options": [
        "To enforce business rules and validations",
        "To insert rows into a table",
        "To declare table variables",
        "To rename a stored procedure"
    ],
    "answer": 0,
    "time": 15
},
{
    "q": "Which of the following is NOT allowed when passing an OUTPUT parameter?",
    "options": [
        "Passing a declared variable",
        "Passing a constant value",
        "Using OUTPUT keyword",
        "Using it to capture SCOPE_IDENTITY()"
    ],
    "answer": 1,
    "time": 20
},
{
    "q": "How do you modify the logic of 'GetProductDesc_withparameters' but keep the same name?",
    "options": [
        "ALTER PROCEDURE GetProductDesc_withparameters ...",
        "CREATE PROCEDURE GetProductDesc_withparameters ...",
        "EXEC sp_rename 'GetProductDesc_withparameters', 'NewName'",
        "UPDATE PROCEDURE GetProductDesc_withparameters ..."
    ],
    "answer": 0,
    "time": 20
}
,

 
    {
      "q": "What happens if you BEGIN TRANSACTION but never COMMIT or ROLLBACK?",
      "options": [
        "The transaction stays open, locks are held, changes are uncommitted",
        "SQL Server throws an automatic error",
        "The transaction is rolled back automatically",
        "The changes are committed after 60 seconds"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "How can you pass multiple rows as a single parameter to a stored procedure in SQL Server?",
      "options": [
        "Using a User-Defined Table Type (UDTT) and a table-valued parameter",
        "Passing a CSV string and parsing it inside SQL",
        "Using multiple scalar parameters",
        "Using temporary tables only"
      ],
      "answer": 0,
      "time": 25
    },
    {
      "q": "Why does SELECT * FROM EmployeeType fail after creating a UDTT?",
      "options": [
        "Because EmployeeType is a type, not a table",
        "Because it requires schema prefix",
        "Because table type must be global",
        "Because it needs a session variable"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which SQL feature allows skipping a number of rows and fetching the next set for pagination?",
      "options": [
        "OFFSET ... FETCH NEXT",
        "TOP",
        "ROW_NUMBER() only",
        "NEXT keyword in cursors"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "How do you assign a table value to a variable in SQL Server?",
      "options": [
        "DECLARE @Var TABLE (...); INSERT INTO @Var SELECT ...",
        "SET @Var = SELECT ...",
        "SELECT ... INTO @Var",
        "CREATE TABLE @Var AS SELECT ..."
      ],
      "answer": 0,
      "time": 25
    },
    {
      "q": "Which CONVERT style code returns '21 Jul 2016 07:57:59:553'?",
      "options": [
        "113",
        "100",
        "120",
        "121"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which FORMAT specifier returns the full day name, e.g., 'Monday'?",
      "options": [
        "dddd",
        "D",
        "tt",
        "MMMM"
      ],
      "answer": 0,
      "time": 15
    },
    {
      "q": "How can you calculate a person’s age on a specific date in SQL Server?",
      "options": [
        "Using a scalar function with YEAR difference and a CASE adjustment",
        "DATEDIFF(MONTH, DOB, GETDATE())",
        "Subtracting years directly from DOB",
        "Using a table-valued function only"
      ],
      "answer": 0,
      "time": 25
    },
    {
      "q": "How do you capture inserted rows with their identity values in SQL Server?",
      "options": [
        "Using OUTPUT clause with a table variable",
        "Using SELECT SCOPE_IDENTITY() directly",
        "Using @@IDENTITY in a variable",
        "Using INSERT INTO ... SELECT ..."
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which keyword in a stored procedure reduces network traffic and caches execution plans?",
      "options": [
        "CREATE PROCEDURE",
        "SELECT",
        "DECLARE",
        "EXEC"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which SQL statement is used to modify an existing stored procedure without dropping it?",
      "options": [
        "ALTER PROCEDURE",
        "UPDATE PROCEDURE",
        "MODIFY PROCEDURE",
        "REPLACE PROCEDURE"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "How do you rename an existing stored procedure in SQL Server?",
      "options": [
        "ALTER PROCEDURE OldName TO NewName",
        "sp_rename 'OldName', 'NewName'",
        "RENAME PROCEDURE OldName NewName",
        "UPDATE sys.procedures SET Name='NewName' WHERE Name='OldName'"
      ],
      "answer": 1,
      "time": 20
    },
    {
      "q": "What is the correct way to declare an OUTPUT parameter in a stored procedure?",
      "options": [
        "@ParamName INT OUTPUT",
        "@ParamName INT OUT",
        "@ParamName OUTPUT INT",
        "OUTPUT @ParamName INT"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which of the following is a correct way to execute a stored procedure with an OUTPUT parameter?",
      "options": [
        "EXEC proc_name 'value', @Var OUTPUT",
        "EXEC proc_name 'value', 5 OUTPUT",
        "EXEC proc_name 'value', @Var",
        "EXEC proc_name @Var OUTPUT"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Why does SQL Server throw 'Procedure expects parameter which was not supplied'?",
      "options": [
        "You did not pass a value for a required OUTPUT parameter",
        "You passed NULL instead of a variable",
        "The procedure does not exist",
        "The input parameter type is incorrect"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Why does SQL Server throw 'Cannot use OUTPUT option when passing a constant'?",
      "options": [
        "OUTPUT parameters can only be assigned to variables, not constants",
        "The procedure is read-only",
        "Constants are allowed, but must be cast",
        "The OUTPUT parameter is optional"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which of the following steps correctly fixes errors when using OUTPUT parameters?",
      "options": [
        "Declare a variable, pass it with OUTPUT keyword, then use the variable",
        "Pass a constant instead of variable",
        "Do not declare OUTPUT in procedure",
        "Use RETURN instead of OUTPUT"
      ],
      "answer": 0,
      "time": 25
    },
    {
      "q": "What does RAISERROR do in SQL Server?",
      "options": [
        "Generates custom error messages with specified severity and state",
        "Logs messages silently in SQL Server Agent",
        "Only prints informational messages",
        "Stops SQL Server service"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which RAISERROR severity levels indicate user-defined errors that can be caught?",
      "options": [
        "0–10",
        "11–18",
        "19–25",
        "All levels"
      ],
      "answer": 1,
      "time": 20
    },
    {
      "q": "Which RAISERROR syntax triggers an immediate message to the client and logs it?",
      "options": [
        "RAISERROR('Error', 16, 1) WITH LOG, NOWAIT",
        "RAISERROR('Error', 0, 1)",
        "RAISERROR('Error', 10, 0) WITH LOG",
        "RAISERROR('Error', 16, 1) NOWAIT"
      ],
      "answer": 0,
      "time": 25
    },
    {
      "q": "In the InsertEmployee procedure, why does RAISERROR prevent insertion?",
      "options": [
        "Because the condition Salary < 5000 is met",
        "Because RAISERROR always stops execution",
        "Because PRINT statements are ignored",
        "Because the table is locked"
      ],
      "answer": 0,
      "time": 20
    },
    {
      "q": "Which keyword is used to stop execution after RAISERROR in a procedure?",
      "options": [
        "RETURN",
        "EXIT",
        "STOP",
        "BREAK"
      ],
      "answer": 0,
      "time": 15
    },
    {
      "q": "What is a common use case for RAISERROR inside a stored procedure?",
      "options": [
        "To enforce business rules and validations",
        "To insert rows into a table",
        "To declare table variables",
        "To rename a stored procedure"
      ],
      "answer": 0,
      "time": 15
    },
    {
      "q": "Which of the following is NOT allowed when passing an OUTPUT parameter?",
      "options": [
        "Passing a declared variable",
        "Passing a constant value",
        "Using OUTPUT keyword",
        "Using it to capture SCOPE_IDENTITY()"
      ],
      "answer": 1,
      "time": 20
    },
    {
      "q": "How do you modify the logic of 'GetProductDesc_withparameters' but keep the same name?",
      "options": [
        "ALTER PROCEDURE GetProductDesc_withparameters ...",
        "CREATE PROCEDURE GetProductDesc_withparameters ...",
        "EXEC sp_rename 'GetProductDesc_withparameters', 'NewName'",
        "UPDATE PROCEDURE GetProductDesc_withparameters ..."
      ],
      "answer": 0,
      "time": 20
    }
   
,
{
  "q": "Why does an INSERT still succeed after RAISERROR with severity 16 if no RETURN or THROW is used?",
  "options": [
    "RAISERROR sends the error but does not stop batch execution by default",
    "Severity 16 is ignored in SQL Server",
    "The INSERT happens in a separate transaction automatically",
    "RAISERROR only logs to error log"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Which option ensures RAISERROR stops further execution immediately without using RETURN or THROW?",
  "options": [
    "Wrap RAISERROR in a TRY…CATCH and handle the error",
    "Increase severity to 25",
    "Use PRINT after RAISERROR",
    "Use SET NOEXEC ON"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "What happens when control jumps into CATCH after RAISERROR inside TRY…CATCH?",
  "options": [
    "Statements in TRY after RAISERROR are skipped",
    "Execution continues normally",
    "The RAISERROR is ignored",
    "Batch terminates immediately without CATCH"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the main difference between RAISERROR and THROW inside a TRY…CATCH?",
  "options": [
    "THROW always stops execution immediately; RAISERROR can continue unless RETURN is used",
    "RAISERROR is only informational, THROW is fatal",
    "THROW cannot be used in stored procedures",
    "RAISERROR always stops execution immediately"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Which syntax correctly stops execution with THROW in a stored procedure?",
  "options": [
    "THROW 50001, 'Error message', 1;",
    "RAISERROR('Error', 16, 1) THROW;",
    "THROW ERROR 'Message';",
    "RAISERROR('Message', 16, 1) STOP;"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Inside TRY…CATCH, what happens if RAISERROR is used but no THROW or RETURN is executed in CATCH?",
  "options": [
    "Execution continues after CATCH",
    "Batch terminates immediately",
    "The error is ignored",
    "INSERT statements are rolled back automatically"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the recommended way in modern SQL Server to stop execution immediately after a validation error?",
  "options": [
    "Use THROW",
    "Use RAISERROR with severity 16 only",
    "Use PRINT statements",
    "Use SELECT TOP 0"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which RAISERROR severity levels require special permissions and can stop the server?",
  "options": [
    "19–25",
    "11–18",
    "0–10",
    "All levels"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which system stored procedure helps you view indexes on a table or view?",
  "options": [
    "sp_helpindex",
    "sp_viewindex",
    "sp_showindexes",
    "sp_indexes"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "If you want detailed index information including included columns and filters, which query is recommended?",
  "options": [
    "SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID('TableName')",
    "EXEC sp_helpindex 'TableName'",
    "DESCRIBE TableName",
    "SHOW INDEX FROM TableName"
  ],
  "answer": 0,
  "time": 20
}
,
{
  "q": "What is the main difference between SQL and T-SQL?",
  "options": [
    "SQL is standard; T-SQL is Microsoft-specific extension with procedural features",
    "SQL supports variables; T-SQL does not",
    "SQL only works in SQL Server; T-SQL works everywhere",
    "T-SQL is deprecated"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which feature is exclusive to T-SQL and not part of standard SQL?",
  "options": [
    "TRY...CATCH error handling",
    "SELECT statement",
    "INSERT INTO table",
    "WHERE clause"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which type of index physically sorts the table data in SQL Server?",
  "options": [
    "Clustered index",
    "Non-clustered index",
    "Unique index",
    "Filtered index"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "How many clustered indexes can a table have?",
  "options": [
    "1",
    "0",
    "Many",
    "Depends on row count"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which SQL operation removes all rows but keeps the table structure and is minimally logged?",
  "options": [
    "TRUNCATE",
    "DELETE",
    "DROP",
    "MERGE"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which SQL operation can remove rows conditionally using WHERE?",
  "options": [
    "DELETE",
    "TRUNCATE",
    "DROP",
    "ALTER"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "How do you write an UPDATE statement using values from another table in SQL Server?",
  "options": [
    "UPDATE target SET column = source.column FROM target JOIN source ON condition",
    "UPDATE target SET column = (SELECT column FROM target)",
    "UPDATE target SET column = source.column WHERE column IN source.column",
    "UPDATE target JOIN source SET column = source.column"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which is a recommended way to improve query performance in SQL Server?",
  "options": [
    "Use proper indexes, avoid SELECT *, filter early, use set-based operations",
    "Use cursors for all row-by-row processing",
    "Always use UNION instead of UNION ALL",
    "Use TEXT data type for large strings"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Why should you avoid SELECT * in production queries?",
  "options": [
    "It retrieves unnecessary columns, increasing I/O and slowing queries",
    "It always causes errors",
    "It disables indexes",
    "It locks the table exclusively"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which of the following is NOT a performance optimization technique?",
  "options": [
    "Using sp_ prefix for stored procedures",
    "Filtering early with WHERE",
    "Using proper data types",
    "Using stored procedures"
  ],
  "answer": 0,
  "time": 20
}

,
 
{
  "q": "What is the main difference between SQL and T-SQL?",
  "options": [
    "SQL is Microsoft-specific, T-SQL is standard",
    "SQL is standard for relational databases, T-SQL adds Microsoft-specific extensions",
    "SQL supports procedural programming, T-SQL does not",
    "There is no difference"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following is NOT a feature of T-SQL?",
  "options": [
    "Variables and control-of-flow statements",
    "Stored Procedures and Triggers",
    "RAISERROR and THROW",
    "Support for multiple RDBMS like Oracle or MySQL"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which statement correctly updates a column in one table using values from another table in SQL Server?",
  "options": [
    "UPDATE ud SET assid = (SELECT s.assid FROM sale s WHERE ud.id = s.id)",
    "UPDATE u SET u.assid = s.assid FROM ud u JOIN sale s ON u.id = s.id",
    "Both A and B",
    "None of the above"
  ],
  "answer": 2,
  "time": 25
},
{
  "q": "Which method is preferred in SQL Server for updating from another table?",
  "options": [
    "Using a correlated subquery",
    "Using JOIN in UPDATE statement",
    "Using a cursor",
    "Using UNION ALL"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following is TRUE about clustered and non-clustered indexes?",
  "options": [
    "You can have multiple clustered indexes per table",
    "Clustered index stores actual data in sorted order, non-clustered stores key + pointer",
    "Non-clustered index is always faster for range queries",
    "Clustered indexes are smaller than non-clustered indexes"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "How many clustered indexes can a SQL Server table have?",
  "options": [
    "1",
    "5",
    "Unlimited",
    "2"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which SQL command removes all rows but keeps the table structure?",
  "options": [
    "DELETE",
    "TRUNCATE",
    "DROP",
    "MERGE"
  ],
  "answer": 1,
  "time": 15
},
{
  "q": "Which SQL command removes the table structure as well as its data?",
  "options": [
    "DELETE",
    "TRUNCATE",
    "DROP",
    "ALTER"
  ],
  "answer": 2,
  "time": 15
},
{
  "q": "Which of the following improves query performance?",
  "options": [
    "Using SELECT * in queries",
    "Avoiding indexes",
    "Using EXISTS instead of IN for subqueries",
    "Using cursors for row-by-row operations"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which practice is recommended to improve SQL query performance?",
  "options": [
    "Using proper data types for columns",
    "Avoiding NULLs in fixed-length columns",
    "Creating proper clustered and non-clustered indexes",
    "All of the above"
  ],
  "answer": 3,
  "time": 25
},
{
  "q": "What is the recommended way to filter rows early for better performance?",
  "options": [
    "Filter after JOIN using HAVING",
    "Filter before JOIN using WHERE",
    "Filter using SELECT *",
    "Filter using UNION instead of UNION ALL"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following statements about using UNION ALL is correct?",
  "options": [
    "UNION ALL removes duplicates automatically",
    "UNION ALL is faster than UNION because it does not remove duplicates",
    "UNION ALL cannot combine tables from different databases",
    "UNION ALL always performs a sort operation"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which practice is recommended when creating stored procedures to improve performance?",
  "options": [
    "Use sp_ prefix",
    "Keep transactions short",
    "Avoid SET NOCOUNT ON",
    "Use SELECT *"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why should SELECT * be avoided in production queries?",
  "options": [
    "It uses minimal logging",
    "It retrieves only necessary columns, improving performance",
    "It can retrieve unnecessary columns and reduce performance",
    "It always causes syntax errors"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which indexing strategy is better for point lookups on non-key columns?",
  "options": [
    "Clustered Index",
    "Non-Clustered Index",
    "No Index",
    "Primary Key Index"
  ],
  "answer": 1,
  "time": 15
},
{
  "q": "What is the difference between DELETE and TRUNCATE?",
  "options": [
    "DELETE removes all rows and cannot be rolled back; TRUNCATE removes selected rows only",
    "DELETE removes rows one by one with full logging and can use WHERE; TRUNCATE removes all rows with minimal logging and cannot use WHERE",
    "Both remove all rows and are identical",
    "DELETE is faster than TRUNCATE"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Which method is recommended to avoid using cursors for performance?",
  "options": [
    "Use row-by-row operations",
    "Use set-based operations with JOINs",
    "Use nested cursors",
    "Use SELECT *"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the recommended approach when joining large tables for performance?",
  "options": [
    "Use subqueries",
    "Use JOINs with proper indexing",
    "Use cursors",
    "Use UNION instead of UNION ALL"
  ],
  "answer": 1,
  "time": 20
}
 
,
 
{
  "q": "What is the main difference between SQL and T-SQL?",
  "options": [
    "SQL is Microsoft-specific, T-SQL is standard",
    "SQL is standard for relational databases, T-SQL adds Microsoft-specific extensions",
    "SQL supports procedural programming, T-SQL does not",
    "There is no difference"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following is NOT a feature of T-SQL?",
  "options": [
    "Variables and control-of-flow statements",
    "Stored Procedures and Triggers",
    "RAISERROR and THROW",
    "Support for multiple RDBMS like Oracle or MySQL"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Which statement correctly updates a column in one table using values from another table in SQL Server?",
  "options": [
    "UPDATE ud SET assid = (SELECT s.assid FROM sale s WHERE ud.id = s.id)",
    "UPDATE u SET u.assid = s.assid FROM ud u JOIN sale s ON u.id = s.id",
    "Both A and B",
    "None of the above"
  ],
  "answer": 2,
  "time": 25
},
{
  "q": "Which method is preferred in SQL Server for updating from another table?",
  "options": [
    "Using a correlated subquery",
    "Using JOIN in UPDATE statement",
    "Using a cursor",
    "Using UNION ALL"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following is TRUE about clustered and non-clustered indexes?",
  "options": [
    "You can have multiple clustered indexes per table",
    "Clustered index stores actual data in sorted order, non-clustered stores key + pointer",
    "Non-clustered index is always faster for range queries",
    "Clustered indexes are smaller than non-clustered indexes"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "How many clustered indexes can a SQL Server table have?",
  "options": [
    "1",
    "5",
    "Unlimited",
    "2"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which SQL command removes all rows but keeps the table structure?",
  "options": [
    "DELETE",
    "TRUNCATE",
    "DROP",
    "MERGE"
  ],
  "answer": 1,
  "time": 15
},
{
  "q": "Which SQL command removes the table structure as well as its data?",
  "options": [
    "DELETE",
    "TRUNCATE",
    "DROP",
    "ALTER"
  ],
  "answer": 2,
  "time": 15
},
{
  "q": "Which of the following improves query performance?",
  "options": [
    "Using SELECT * in queries",
    "Avoiding indexes",
    "Using EXISTS instead of IN for subqueries",
    "Using cursors for row-by-row operations"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which practice is recommended to improve SQL query performance?",
  "options": [
    "Using proper data types for columns",
    "Avoiding NULLs in fixed-length columns",
    "Creating proper clustered and non-clustered indexes",
    "All of the above"
  ],
  "answer": 3,
  "time": 25
},
{
  "q": "What is the recommended way to filter rows early for better performance?",
  "options": [
    "Filter after JOIN using HAVING",
    "Filter before JOIN using WHERE",
    "Filter using SELECT *",
    "Filter using UNION instead of UNION ALL"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following statements about using UNION ALL is correct?",
  "options": [
    "UNION ALL removes duplicates automatically",
    "UNION ALL is faster than UNION because it does not remove duplicates",
    "UNION ALL cannot combine tables from different databases",
    "UNION ALL always performs a sort operation"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which practice is recommended when creating stored procedures to improve performance?",
  "options": [
    "Use sp_ prefix",
    "Keep transactions short",
    "Avoid SET NOCOUNT ON",
    "Use SELECT *"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why should SELECT * be avoided in production queries?",
  "options": [
    "It uses minimal logging",
    "It retrieves only necessary columns, improving performance",
    "It can retrieve unnecessary columns and reduce performance",
    "It always causes syntax errors"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which indexing strategy is better for point lookups on non-key columns?",
  "options": [
    "Clustered Index",
    "Non-Clustered Index",
    "No Index",
    "Primary Key Index"
  ],
  "answer": 1,
  "time": 15
},
{
  "q": "What is the difference between DELETE and TRUNCATE?",
  "options": [
    "DELETE removes all rows and cannot be rolled back; TRUNCATE removes selected rows only",
    "DELETE removes rows one by one with full logging and can use WHERE; TRUNCATE removes all rows with minimal logging and cannot use WHERE",
    "Both remove all rows and are identical",
    "DELETE is faster than TRUNCATE"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Which method is recommended to avoid using cursors for performance?",
  "options": [
    "Use row-by-row operations",
    "Use set-based operations with JOINs",
    "Use nested cursors",
    "Use SELECT *"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the recommended approach when joining large tables for performance?",
  "options": [
    "Use subqueries",
    "Use JOINs with proper indexing",
    "Use cursors",
    "Use UNION instead of UNION ALL"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following statements about RAISERROR is true?",
  "options": [
    "RAISERROR always stops the batch immediately",
    "RAISERROR sends an error message but execution continues unless RETURN or TRY...CATCH is used",
    "RAISERROR cannot be caught in TRY...CATCH",
    "RAISERROR automatically rolls back the transaction"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "How does THROW differ from RAISERROR in T-SQL?",
  "options": [
    "THROW always stops execution immediately and can be used inside TRY...CATCH",
    "THROW is only for severity below 10",
    "THROW cannot be used inside stored procedures",
    "THROW automatically retries the statement"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What will happen if RAISERROR 16 is executed without RETURN inside a procedure?",
  "options": [
    "Procedure stops immediately",
    "Error message is raised but next statements execute",
    "Execution is rolled back automatically",
    "SQL Server throws a fatal error"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which option ensures that RAISERROR stops execution without using RETURN or THROW?",
  "options": [
    "SET NOCOUNT ON",
    "SET XACT_ABORT ON",
    "Use UNION ALL",
    "Use SELECT *"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following will capture the last inserted identity in a table?",
  "options": [
    "SCOPE_IDENTITY()",
    "@@IDENTITY",
    "IDENT_CURRENT()",
    "All of the above"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "What is the correct way to execute a stored procedure with an OUTPUT parameter?",
  "options": [
    "EXEC ProcedureName @Param OUTPUT",
    "EXEC ProcedureName @Param = 5",
    "EXEC ProcedureName @Param = 'Test'",
    "EXEC ProcedureName"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which error occurs if you pass a constant to an OUTPUT parameter?",
  "options": [
    "Cannot use OUTPUT option with a constant",
    "Procedure executes successfully",
    "Syntax error",
    "Type conversion error"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which is a recommended method to log errors inside stored procedures?",
  "options": [
    "Using PRINT only",
    "Inserting errors into a dedicated ErrorLog table",
    "Using SELECT *",
    "Using UNION ALL"
  ],
  "answer": 1,
  "time": 15
},
{
  "q": "What is the main benefit of using SET NOCOUNT ON in stored procedures?",
  "options": [
    "Improves query performance by not sending row count messages",
    "Automatically logs errors",
    "Stops execution on errors",
    "Enables transactions"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which T-SQL construct allows procedural programming and error handling?",
  "options": [
    "Variables only",
    "Stored Procedures only",
    "TRY...CATCH and control-of-flow statements",
    "SELECT * queries"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which indexing strategy is better for retrieving large ordered ranges?",
  "options": [
    "Clustered Index",
    "Non-Clustered Index",
    "No Index",
    "Temporary Table"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which of the following is TRUE about transactions in SQL Server?",
  "options": [
    "Keep transactions as short as possible",
    "Long transactions improve performance",
    "Transactions automatically commit after 1 hour",
    "No need to commit transactions"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Which of the following improves performance when querying large tables?",
  "options": [
    "Using SELECT *",
    "Using table variables instead of temp tables where applicable",
    "Using cursors",
    "Dropping indexes"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which is the correct way to update multiple rows with a JOIN in SQL Server?",
  "options": [
    "UPDATE t SET col = (SELECT col FROM t2 WHERE t.id=t2.id)",
    "UPDATE t SET t.col = t2.col FROM t JOIN t2 ON t.id = t2.id",
    "Both are valid",
    "Neither is valid"
  ],
  "answer": 2,
  "time": 20
},

{
  "q": "Why are subqueries commonly used in SQL?",
  "options": [
    "To break a query into simpler parts and fetch data for main query conditions",
    "To replace indexes for faster performance",
    "To permanently store intermediate results",
    "To enforce primary key constraints"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Which of the following is a drawback of subqueries compared to JOINs?",
  "options": [
    "They are always faster",
    "They may be slower on large datasets and less optimized by the query engine",
    "They cannot be used in WHERE clauses",
    "They do not return any result"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which SQL construct can replace a subquery in the example: `SELECT * FROM Orders WHERE CustomerID IN (SELECT CustomerID FROM Customers WHERE City='London')`?",
  "options": [
    "JOIN: `SELECT o.* FROM Orders o JOIN Customers c ON o.CustomerID = c.CustomerID WHERE c.City='London'`",
    "MERGE",
    "CTE only",
    "No alternative exists"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "What is the primary purpose of using BULK INSERT in SQL Server?",
  "options": [
    "To insert a single row efficiently",
    "To load large datasets from files quickly",
    "To create indexes on a table",
    "To execute stored procedures in batch"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which of the following is TRUE when importing CSV using SSMS Import Wizard?",
  "options": [
    "It is suitable for very large, performance-critical datasets",
    "It allows GUI-based mapping of source columns to destination columns",
    "It automatically creates clustered indexes",
    "It enforces referential integrity by default"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which scenario is better for using BULK INSERT instead of SSMS Import Wizard?",
  "options": [
    "Small ad-hoc CSV imports",
    "Performance-critical and repeatable large dataset imports",
    "Interactive GUI-based testing",
    "Manual row-by-row inserts"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which is a common tip when importing CSV using BULK INSERT?",
  "options": [
    "Always ignore file path permissions",
    "Use a staging table to validate data before merging",
    "Do not skip the header row",
    "Avoid specifying FIELDTERMINATOR"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "How can you print numbers from 1 to 100 using T-SQL without using loops?",
  "options": [
    "Using a recursive CTE",
    "Using WHILE loop only",
    "Using BULK INSERT",
    "Using RAISERROR"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Why is it generally not recommended to apply an index directly on a CTE?",
  "options": [
    "CTEs are temporary query expressions and not physically stored",
    "CTEs already create indexes automatically",
    "CTEs can only return one row",
    "CTEs cannot contain joins"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "If you need indexing on data produced by a CTE, which of the following is a correct approach?",
  "options": [
    "Materialize the CTE into a temp table and create an index",
    "Directly create a clustered index on the CTE",
    "Replace CTE with UNION ALL",
    "Drop the table before indexing"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which of the following is a correct way to create an indexed view as an alternative to a CTE?",
  "options": [
    "CREATE VIEW vw_SalesSummary WITH SCHEMABINDING AS SELECT ProductID, SUM(Quantity) AS TotalQty FROM dbo.Sales GROUP BY ProductID; CREATE UNIQUE CLUSTERED INDEX IX_vw_SalesSummary ON vw_SalesSummary(ProductID);",
    "CREATE CTE AS SELECT ProductID FROM Sales; CREATE INDEX IX_CTE_ProductID ON CTE(ProductID);",
    "CREATE TEMP TABLE AS SELECT ProductID FROM Sales; CREATE INDEX ON TEMP(ProductID);",
    "CREATE VIEW vw_SalesSummary AS SELECT * FROM Sales;"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Which of the following is an advantage of using a temp table instead of a CTE when dealing with large datasets?",
  "options": [
    "Temp tables can have indexes, improving query performance",
    "Temp tables are always slower than CTEs",
    "Temp tables cannot be joined",
    "Temp tables cannot store aggregates"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You have a CSV with 1 million rows. Which approach is preferred for fast and repeatable import?",
  "options": [
    "SSMS Import Wizard with GUI mapping",
    "BULK INSERT into a staging table",
    "Manually opening the CSV and inserting row by row",
    "Using CTE to import data"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You need to filter orders for customers in 'London' and also calculate total order amount per customer efficiently. Which approach is better?",
  "options": [
    "Subquery in WHERE clause only",
    "JOIN with GROUP BY",
    "CTE without materialization",
    "Using RAISERROR"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You want to loop from 1 to 100 and perform calculations per number. Which T-SQL construct is the most efficient?",
  "options": [
    "Recursive CTE for inline calculation",
    "WHILE loop only",
    "RAISERROR inside loop",
    "Temporary table without loop"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Which statement about subqueries is TRUE?",
  "options": [
    "Subqueries can return scalar, rowset, or table expressions",
    "Subqueries can only be used in SELECT clauses",
    "Subqueries cannot contain aggregates",
    "Subqueries always perform better than joins"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You need to apply an index on aggregated sales data but want to maintain query readability. What is the best option?",
  "options": [
    "Use a temp table to store aggregation results and then index",
    "Use a CTE only",
    "Use a WHILE loop",
    "Use RAISERROR to create index dynamically"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Which of the following statements about importing CSV files is FALSE?",
  "options": [
    "SSMS Import Wizard is good for one-time small-medium CSV imports",
    "BULK INSERT is suitable for large datasets and repeatable loads",
    "BULK INSERT automatically validates column types and dates",
    "Using a staging table helps in validation"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Scenario: You used a CTE to calculate total quantity per product and need to join this with the products table. How can you optimize performance?",
  "options": [
    "Insert the CTE result into a temp table with index and join",
    "Directly join the CTE without indexing",
    "Use UNION ALL",
    "Use DROP INDEX before join"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You need to generate numbers from 1 to 100 in a query for testing. Which method is more suitable if you want the numbers as a result set rather than just printing?",
  "options": [
    "Recursive CTE",
    "WHILE loop with PRINT",
    "RAISERROR",
    "BULK INSERT"
  ],
  "answer": 0,
  "time": 20
}

,
{
  "q": "Scenario: You have a large Orders table and need total sales per customer. You want to avoid repeated scans. Which approach is better?",
  "options": [
    "Use a CTE multiple times in the query",
    "Aggregate into a temp table and create an index on CustomerID",
    "Use multiple subqueries in WHERE clauses",
    "Use WHILE loop to calculate totals"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You have a CSV file with 5 million rows. You need fast and repeatable loads. Which method is recommended?",
  "options": [
    "SSMS Import Wizard",
    "BULK INSERT into a staging table",
    "Manual INSERT using INSERT INTO ... VALUES",
    "Recursive CTE"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You need to generate a sequence from 1 to 100000 in SQL Server efficiently. Which approach is best?",
  "options": [
    "Recursive CTE",
    "WHILE loop with PRINT",
    "WHILE loop inserting into a temp table",
    "Using a numbers/tally table"
  ],
  "answer": 3,
  "time": 25
},
{
  "q": "Why is a subquery sometimes slower than a JOIN?",
  "options": [
    "Because subqueries create temporary tables automatically",
    "Because correlated subqueries execute for each outer row",
    "Because JOINs cannot use indexes",
    "Because subqueries cannot return multiple columns"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You have a CTE producing aggregated results, but queries on it are slow. What should you do?",
  "options": [
    "Replace CTE with a temp table and create appropriate indexes",
    "Add a clustered index directly on CTE",
    "Rewrite the CTE as a subquery",
    "Increase severity in RAISERROR"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You want to log errors during CSV import automatically into an ErrorLog table. Which method works best?",
  "options": [
    "Use TRY…CATCH around BULK INSERT and INSERT into ErrorLog in CATCH",
    "Use RAISERROR after successful import",
    "Use PRINT inside BULK INSERT",
    "Use WHILE loop over CSV rows"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Which of the following is TRUE about temp tables vs CTEs?",
  "options": [
    "CTEs can have indexes, temp tables cannot",
    "Temp tables are physically stored and can have indexes",
    "Temp tables cannot hold aggregates",
    "CTEs persist across sessions"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You want to avoid repeated execution of a heavy subquery multiple times. What is a recommended solution?",
  "options": [
    "Use a CTE multiple times",
    "Store the subquery results into a temp table with indexes",
    "Rewrite as multiple independent queries",
    "Use RAISERROR to halt execution"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You need to insert 10 million rows from CSV into SQL Server. Which consideration is critical for performance?",
  "options": [
    "Use TABLOCK during BULK INSERT",
    "Use RAISERROR after each insert",
    "Use WHILE loop",
    "Use SELECT * FROM CSV"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You have a reporting query that uses a subquery in WHERE with IN. On large tables, it's slow. What is a better approach?",
  "options": [
    "Replace IN subquery with an INNER JOIN",
    "Use multiple subqueries",
    "Use a WHILE loop",
    "Use RAISERROR"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You need to calculate a running total per customer. Which is most efficient?",
  "options": [
    "Recursive CTE",
    "Using window functions like SUM() OVER (PARTITION BY ... ORDER BY ...)",
    "Subquery inside WHERE",
    "BULK INSERT trick"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You want to validate CSV data before inserting into final table. What is best practice?",
  "options": [
    "Insert into a staging table first, check constraints, then move to main table",
    "Insert directly into main table",
    "Use RAISERROR on each row",
    "Use a WHILE loop to read CSV manually"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You want to prevent a batch insert if one row fails validation. Which T-SQL feature can help?",
  "options": [
    "RAISERROR with severity ≥16 combined with TRY…CATCH",
    "Recursive CTE",
    "SELECT DISTINCT",
    "WHILE loop"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You need a fast sequence from 1 to 1 million for testing. Which is slowest?",
  "options": [
    "Recursive CTE",
    "Using numbers/tally table",
    "Using CROSS JOIN on system tables",
    "Generating in application code"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You want to join a CTE result with a large table and improve performance. Which is best?",
  "options": [
    "Insert CTE into temp table and create indexes on join columns",
    "Directly join the CTE",
    "Use RAISERROR to halt execution before join",
    "Use BULK INSERT instead"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You have multiple CSV files arriving daily. You want automated import with validation. Which tool is recommended?",
  "options": [
    "BULK INSERT or SSIS packages with staging tables and error handling",
    "Manual SSMS Import Wizard each day",
    "Recursive CTE",
    "PRINT statement loop"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You need the total quantity per product and want it indexed for repeated reporting. What should you do?",
  "options": [
    "Use an indexed view or temp table with index",
    "Use CTE with GROUP BY only",
    "Use RAISERROR",
    "Use a subquery in SELECT clause"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You are importing a CSV and encounter NULLs in numeric columns. What should you do?",
  "options": [
    "Use a staging table with correct column types to handle NULLs",
    "Insert directly into main table ignoring NULLs",
    "Use RAISERROR on every NULL row",
    "Skip the row silently"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You want a reusable sequence generator in SQL Server. Which is best practice?",
  "options": [
    "Create a permanent Numbers/Tally table with pre-populated numbers",
    "Recursive CTE each time",
    "WHILE loop with PRINT",
    "RAISERROR sequence"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You are writing a performance-critical query that currently uses a subquery in SELECT. What should you check?",
  "options": [
    "Replace correlated subqueries with JOINs or APPLY",
    "Add RAISERROR for debugging",
    "Use recursive CTE instead of SELECT",
    "Always use SELECT *"
  ],
  "answer": 0,
  "time": 25
},

{
  "q": "Scenario: You have a frequently queried aggregated dataset. You want to improve performance. What should you do?",
  "options": [
    "Create a normal view",
    "Create an indexed/materialized view with SCHEMABINDING and clustered index",
    "Use a CTE every time",
    "Use a subquery in SELECT clause"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "What is the key difference between a normal view and an indexed (materialized) view?",
  "options": [
    "Normal view stores data physically, indexed view does not",
    "Normal view recalculates every query, indexed view stores results physically",
    "Normal view allows indexes, indexed view does not",
    "Both are physically stored"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You want to print numbers from 1 to 100 using a **set-based approach** instead of loops. Which method is best?",
  "options": [
    "WHILE loop",
    "Recursive CTE",
    "CURSOR",
    "GOTO"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Which of the following is NOT a valid way to generate numbers 1 to 100 in SQL Server?",
  "options": [
    "Using WHILE loop",
    "Using CURSOR",
    "Using GOTO",
    "Directly indexing a CTE with CREATE INDEX"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "Scenario: You have a recursive CTE generating a sequence. What must you ensure?",
  "options": [
    "It has a termination condition",
    "It uses RAISERROR to stop",
    "It always creates a clustered index",
    "It is created WITH SCHEMABINDING"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You inserted a row into a table with identity column. You want the last inserted identity value in the current session and scope only. Which function should you use?",
  "options": [
    "@@IDENTITY",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT('TableName')",
    "ROW_NUMBER()"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You inserted a row in a table that has a trigger inserting into another table with identity column. Which identity function may return the identity of the triggered table?",
  "options": [
    "@@IDENTITY",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT",
    "ROW_NUMBER()"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want to manually insert a specific identity value into a table. What must you do?",
  "options": [
    "Nothing, identity allows manual insert by default",
    "SET IDENTITY_INSERT TableName ON before inserting, then OFF after",
    "Use SCOPE_IDENTITY()",
    "Use @@IDENTITY"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: After turning on IDENTITY_INSERT and inserting a manual value, what happens to the auto-generated identity sequence?",
  "options": [
    "Sequence resets to 1",
    "Next auto-generated value continues from the last identity seed",
    "Sequence skips next value",
    "Next insert fails automatically"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You need to create a permanently indexed view. Which T-SQL clause is mandatory?",
  "options": [
    "WITH NOLOCK",
    "WITH SCHEMABINDING",
    "WITH (ROWLOCK)",
    "WITH CTE"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You have a table with millions of rows. You need to generate numbers 1 to 100 efficiently for a temporary report. Which method is fastest?",
  "options": [
    "Recursive CTE",
    "WHILE loop with PRINT",
    "Using a tally/numbers table",
    "CURSOR loop"
  ],
  "answer": 2,
  "time": 25
},
{
  "q": "Scenario: You want to join a CTE that produces aggregated sales totals with the Orders table. You notice poor performance. What is recommended?",
  "options": [
    "Join directly to CTE without changes",
    "Materialize CTE into a temp table and create indexes on join columns",
    "Use RAISERROR before join",
    "Use GOTO to loop through results"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You query an indexed view. Which of the following is TRUE?",
  "options": [
    "It recalculates aggregates every time",
    "It physically stores the aggregated results",
    "You cannot create non-clustered indexes on it",
    "SCHEMABINDING is optional"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You want to get the last identity inserted in a table across all sessions regardless of current scope. Which function should you use?",
  "options": [
    "@@IDENTITY",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT('TableName')",
    "ROW_NUMBER()"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Scenario: You want to create a temporary sequence from 1–100 in a query without loops. Which method is best?",
  "options": [
    "Temporary table with WHILE",
    "Recursive CTE",
    "CURSOR loop",
    "Manual insert statements"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You want to create an indexed view that uses non-deterministic functions like GETDATE(). What will happen?",
  "options": [
    "Indexed view works fine",
    "SQL Server will throw an error",
    "It converts GETDATE() to static value",
    "It ignores the function"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You have a recursive CTE generating numbers 1 to N. You forgot the termination condition. What happens?",
  "options": [
    "Query stops automatically at 100",
    "Query fails with MAXRECURSION error",
    "Query ignores recursion",
    "Query completes successfully with infinite numbers"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You need to frequently query total sales per product with millions of rows. Which is better?",
  "options": [
    "Normal view",
    "Indexed view (materialized view)",
    "CTE",
    "Subquery in SELECT"
  ],
  "answer": 1,
  "time": 25
}
,

{
  "q": "Scenario: You want to improve query performance on a heavily aggregated sales dataset queried multiple times daily. What is the best approach?",
  "options": [
    "Use a normal view",
    "Create an indexed/materialized view with SCHEMABINDING",
    "Use a CTE every time",
    "Use a subquery in SELECT clause"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You create an indexed view but forget SCHEMABINDING. What happens?",
  "options": [
    "View works and indexes can be created",
    "SQL Server throws an error",
    "View works without indexes",
    "Aggregates are precomputed automatically"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You need to join aggregated CTE results with another table frequently. Query is slow. How can you improve performance?",
  "options": [
    "Use normal CTE every time",
    "Materialize CTE into a temp table and add indexes",
    "Add RAISERROR before join",
    "Use GOTO to loop through results"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You want to print numbers 1–100 for a report. Which set-based approach is fastest?",
  "options": [
    "WHILE loop",
    "Recursive CTE",
    "Tally table or ROW_NUMBER() on sys.objects",
    "CURSOR loop"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Scenario: Recursive CTE is generating sequence but no termination condition is provided. What happens?",
  "options": [
    "Query stops automatically at 100",
    "Query fails with MAXRECURSION error",
    "Query completes successfully",
    "SQL Server automatically adds termination condition"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the difference between a normal view and an indexed view?",
  "options": [
    "Normal view stores data physically, indexed view does not",
    "Normal view recalculates every query, indexed view stores results physically",
    "Normal view allows non-clustered indexes, indexed view does not",
    "Both store data physically"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You need a sequence of numbers without creating loops or temp tables. Which is the best method?",
  "options": [
    "WHILE loop",
    "Recursive CTE",
    "Numbers table or tally table",
    "GOTO loop"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Scenario: You want to insert specific identity values into a table. What T-SQL command allows this?",
  "options": [
    "SET IDENTITY_INSERT TableName ON",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT('TableName')",
    "Use ROW_NUMBER() function"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: After inserting with IDENTITY_INSERT ON, what happens to the next auto-generated identity value?",
  "options": [
    "Resets to 1",
    "Continues from last identity seed",
    "Skips next value",
    "Next insert fails"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You inserted into a table with a trigger that inserts into another table with identity. Which function returns the triggered table’s identity?",
  "options": [
    "@@IDENTITY",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT('TableName')",
    "ROW_NUMBER()"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You need to get last inserted identity in the current scope only. Which function is safest?",
  "options": [
    "@@IDENTITY",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT('TableName')",
    "ROW_NUMBER()"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You want to import a large CSV file repeatedly for ETL purposes. Which method is fastest?",
  "options": [
    "SSMS Import Wizard",
    "BULK INSERT or bcp",
    "Manual INSERT statements",
    "CTE with OPENROWSET"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You want to quickly check indexes on a table or view. Which command helps?",
  "options": [
    "sp_helpindex 'TableName'",
    "SELECT * FROM sys.columns",
    "SELECT * FROM INFORMATION_SCHEMA.TABLES",
    "EXEC sp_who"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Scenario: You want to join CTE results with another table multiple times. What is best practice for performance?",
  "options": [
    "Keep as CTE every time",
    "Materialize into temp table and index",
    "Use normal view",
    "Use subqueries only"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You create a CTE and attempt to create an index directly on it. What happens?",
  "options": [
    "Index is created successfully",
    "Error, cannot create index on CTE",
    "CTE automatically materializes with index",
    "CTE is converted to indexed view"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You frequently query total sales per product on a million-row table. Which is better for performance?",
  "options": [
    "Normal view",
    "Indexed view",
    "CTE",
    "Subquery in SELECT clause"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You want to create an indexed view but it uses GETDATE(). What will happen?",
  "options": [
    "View is created successfully",
    "SQL Server throws error because function is non-deterministic",
    "GETDATE() is replaced with static value",
    "Index creation is ignored"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You need to generate numbers 1–100 in multiple queries efficiently. Which method is most reusable?",
  "options": [
    "WHILE loop",
    "Recursive CTE",
    "Permanent Numbers/Tally table",
    "GOTO"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Scenario: You want to insert data from CSV into a staging table. Which is a good practice?",
  "options": [
    "Insert directly into main table",
    "Insert into staging table, validate, then move to main table",
    "Use CTE only",
    "Use recursive function"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You use BULK INSERT but get permission error. What is likely the cause?",
  "options": [
    "File path not accessible to SQL Server service",
    "CSV has header row",
    "Target table is empty",
    "CSV is small"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You need to print numbers 1–100 in SQL without loops. Which method can you use?",
  "options": [
    "Recursive CTE",
    "WHILE loop",
    "CURSOR",
    "GOTO"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want to prevent CTE execution from re-running in every query. What is best?",
  "options": [
    "Use temp table or indexed view",
    "Use recursive CTE every time",
    "Use WHILE loop",
    "Use GOTO"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You want to select top N rows from a large table efficiently. Which technique helps?",
  "options": [
    "TOP with ORDER BY on indexed column",
    "TOP without ORDER BY",
    "WHILE loop",
    "Recursive CTE"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want to use a CTE for hierarchical data (employees → managers). What is required?",
  "options": [
    "Recursive CTE with anchor member and recursive member",
    "WHILE loop",
    "CURSOR",
    "Temporary table only"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You have a table with identity column and want the last identity inserted globally (any session). Which function?",
  "options": [
    "@@IDENTITY",
    "SCOPE_IDENTITY()",
    "IDENT_CURRENT('TableName')",
    "ROW_NUMBER()"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Scenario: You need to insert multiple rows with specific identity values. What must you remember?",
  "options": [
    "Set IDENTITY_INSERT ON for each insert, then OFF at end",
    "Use SCOPE_IDENTITY()",
    "Use @@IDENTITY",
    "Use recursive function"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want to generate 1–100 in SQL for testing without temp tables. Which option is most elegant?",
  "options": [
    "Recursive CTE",
    "WHILE loop",
    "CURSOR",
    "Manual INSERTs"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want to join two tables and a CTE producing totals. Which approach ensures indexes can be used?",
  "options": [
    "Use CTE directly in JOIN",
    "Materialize CTE into temp table with indexes, then join",
    "Use subquery only",
    "Use RAISERROR before JOIN"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You have millions of rows and need top 10 products by sales. Which is optimal?",
  "options": [
    "CTE with ROW_NUMBER() and ORDER BY",
    "Normal view",
    "Recursive function",
    "WHILE loop"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You want to prevent identity gaps after deletions. What is the behavior of SQL Server?",
  "options": [
    "Reuses deleted identity values automatically",
    "Does not reuse deleted values",
    "Resets sequence after each deletion",
    "Fills gaps when inserting manually"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You frequently need row numbers for query results. Which is most efficient?",
  "options": [
    "Use ROW_NUMBER() function",
    "Use WHILE loop",
    "Use CURSOR",
    "Use recursive function"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You need to query an indexed view with both clustered and non-clustered indexes. Which is true?",
  "options": [
    "Only clustered index is used automatically",
    "Non-clustered indexes can improve query performance further",
    "SCHEMABINDING is optional",
    "Aggregates are recalculated every query"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You want to import CSV with headers into SQL Server quickly. Which BULK INSERT option helps skip the header row?",
  "options": [
    "FIRSTROW = 1",
    "FIRSTROW = 2",
    "FIELDTERMINATOR = ','",
    "ROWTERMINATOR = '\\n'"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Scenario: You want to join millions of rows from table A to CTE B efficiently. What should you do?",
  "options": [
    "Use CTE directly in JOIN",
    "Materialize CTE into temp table with indexes before JOIN",
    "Use subquery in SELECT",
    "Use RAISERROR to skip rows"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Scenario: You want to recursively print numbers 1–100 using CTE. What is critical?",
  "options": [
    "Termination condition to avoid infinite recursion",
    "WHILE loop",
    "CURSOR",
    "Temporary table"
  ],
  "answer": 0,
  "time": 20
}
,

{
  "q": "Write a CTE in two ways. What is the difference between them?",
  "options": [
    "CTE with explicit column list vs CTE without column list; explicit is safer for unioned queries with different column names",
    "CTE with WHERE clause vs CTE without WHERE clause",
    "Recursive CTE vs Non-recursive CTE; one loops, one does not",
    "CTE with JOIN vs CTE with subquery"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You have multiple environments in a project. What is the role of DEV, TEST, UAT, PERF, and PROD?",
  "options": [
    "DEV: coding & unit testing, TEST: QA testing, UAT: business validation, PERF: load/performance testing, PROD: live system",
    "DEV: live system, TEST: coding, UAT: QA, PERF: development, PROD: backup",
    "DEV: reporting, TEST: dashboards, UAT: database tuning, PERF: unit testing, PROD: coding",
    "DEV: backup, TEST: performance, UAT: coding, PERF: QA, PROD: reporting"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want a column that automatically combines EmpID and EmpName. Which SQL feature helps?",
  "options": [
    "Computed Column",
    "Identity Column",
    "CTE",
    "Indexed View"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You frequently filter by a computed column. How can you optimize performance?",
  "options": [
    "Make the computed column PERSISTED and index it",
    "Use CTE every time",
    "Store computation in a variable",
    "Use WHILE loop to precompute"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: You want conditional sorting: Males by name descending, Females by country ascending. Which SQL technique is best?",
  "options": [
    "ORDER BY CASE expressions",
    "Use recursive CTE",
    "Use computed column",
    "Use temp table and sort manually"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want all Males first sorted by EmployeeName and then all Females sorted by Country. How would you implement in SQL Server?",
  "options": [
    "ORDER BY CASE WHEN Gender='Male' THEN 0 ELSE 1 END, EmployeeName, Country",
    "Use recursive CTE",
    "Use temp table and multiple SELECTs",
    "Cannot do in SQL Server"
  ],
  "answer": 0,
  "time": 25
},
{
  "q": "Scenario: What is the difference between normalized and denormalized tables?",
  "options": [
    "Normalized: multiple tables, remove redundancy, better for OLTP; Denormalized: fewer tables, faster read, more redundancy, better for OLAP",
    "Normalized: one table with all data; Denormalized: split tables",
    "Normalized: faster for reporting; Denormalized: better for updates",
    "No difference, just naming"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You have Employee table with DeptID. How do you normalize?",
  "options": [
    "Create separate Department table and use DeptID as FK",
    "Keep DeptName in Employee table only",
    "Duplicate Department table in multiple schemas",
    "Add DeptName to all queries via subquery"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want to denormalize for a reporting table to avoid joins. Which approach is correct?",
  "options": [
    "Include Department name in Employee table directly, even if it repeats",
    "Split Employee and Department into separate tables",
    "Use a CTE to join tables every time",
    "Use recursive function to combine tables on the fly"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want to maintain multiple database environments. Which is true?",
  "options": [
    "DEV is for coding, TEST for QA, UAT for business validation, PERF for load testing, PROD for live system",
    "All environments are identical and used interchangeably",
    "DEV is live, TEST is backup",
    "UAT is only for developers"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You have a computed column that concatenates first name and last name. Can you update it directly?",
  "options": [
    "No, computed columns cannot be directly updated",
    "Yes, always",
    "Yes, only if PERSISTED",
    "Yes, if it is indexed"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Scenario: You want to sort dynamically using CASE. What happens to rows that do not match any CASE condition?",
  "options": [
    "They are treated as NULL and appear last",
    "They are deleted",
    "They are sorted randomly",
    "SQL Server throws error"
  ],
  "answer": 0,
  "time": 15
},
{
  "q": "Scenario: Why is explicit column naming in a CTE safer than implicit?",
  "options": [
    "Ensures consistent column names even if unioned queries have different names",
    "Faster execution",
    "Automatically indexes the CTE",
    "Prevents recursion"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Scenario: You want a PERSISTED computed column. What is its advantage?",
  "options": [
    "Stored physically, can be indexed, faster for filtering and joins",
    "Calculated on the fly every time",
    "Cannot be indexed",
    "Automatically creates identity column"
  ],
  "answer": 0,
  "time": 20
},
  {
  "q": "Why is a subquery preferred over a JOIN in certain SQL scenarios?",
  "options": [
    "When data must be modified",
    "When logic depends on an aggregated or filtered intermediate result",
    "When performance is always critical",
    "When indexes cannot be used"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which type of subquery is executed once and reused by the outer query?",
  "options": [
    "Correlated subquery",
    "Scalar subquery",
    "Non-correlated subquery",
    "Inline view"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "A correlated subquery is usually slower because:",
  "options": [
    "It executes only once",
    "It references aggregated columns",
    "It is executed once per outer row",
    "It cannot use indexes"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which scenario is best suited for EXISTS instead of IN?",
  "options": [
    "Small lookup table",
    "When subquery returns NULLs",
    "When ordering is required",
    "When duplicate rows are needed"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "You are importing a small CSV once for testing. Which approach is best?",
  "options": [
    "SSIS package",
    "BULK INSERT",
    "SSMS Import Wizard",
    "bcp utility"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why is SSMS Import Wizard not recommended for production pipelines?",
  "options": [
    "It cannot import CSV files",
    "It is not easily automatable",
    "It does not support data types",
    "It fails on large files"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why must the SQL Server service account have file access for BULK INSERT?",
  "options": [
    "Because SSMS executes the command",
    "Because SQL Server engine reads the file",
    "Because Windows authentication is used",
    "Because tempdb is involved"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which BULK INSERT option is used to skip the header row?",
  "options": [
    "ROWTERMINATOR",
    "FIELDTERMINATOR",
    "FIRSTROW",
    "LASTROW"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "For repeated large CSV loads with performance as priority, what should you use?",
  "options": [
    "SSMS Import Wizard",
    "Manual INSERT statements",
    "BULK INSERT",
    "PRINT statements"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why is a recursive CTE preferred over a WHILE loop for generating sequences?",
  "options": [
    "WHILE loops are deprecated",
    "CTEs are set-based and optimized",
    "WHILE loops cannot generate numbers",
    "CTEs can be indexed"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "What is the default MAXRECURSION limit for a CTE in SQL Server?",
  "options": [
    "50",
    "100",
    "1000",
    "Unlimited"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why is PRINT not recommended for returning large result sets?",
  "options": [
    "It executes slowly",
    "It truncates output",
    "It causes deadlocks",
    "It disables indexing"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why can’t an index be created directly on a CTE?",
  "options": [
    "CTEs are read-only",
    "CTEs are not physically stored",
    "CTEs cannot contain joins",
    "CTEs cannot be reused"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "You need indexed intermediate results for complex logic. What should you use?",
  "options": [
    "CTE",
    "Derived table",
    "Temp table",
    "Scalar subquery"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which requirement is mandatory for creating an indexed view?",
  "options": [
    "NOLOCK hint",
    "SCHEMABINDING",
    "Dynamic SQL",
    "Temp tables"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which statement about Stored Procedures is TRUE?",
  "options": [
    "They must return a value",
    "They cannot use transactions",
    "They can modify database state",
    "They cannot accept parameters"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why are UDFs restricted from using transactions?",
  "options": [
    "To improve readability",
    "To ensure deterministic behavior",
    "To reduce locking",
    "To simplify syntax"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which operation is NOT allowed inside a SQL Server UDF?",
  "options": [
    "SELECT",
    "INSERT into a table",
    "CASE expression",
    "Arithmetic operations"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "TRUNCATE TABLE belongs to which SQL command category?",
  "options": [
    "DML",
    "DCL",
    "DDL",
    "TCL"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why is TRUNCATE faster than DELETE without WHERE?",
  "options": [
    "It fires fewer triggers",
    "It deallocates data pages",
    "It uses row-level logging",
    "It supports rollback"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which command is used to undo a transaction?",
  "options": [
    "COMMIT",
    "SAVEPOINT",
    "ROLLBACK",
    "GRANT"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which technique removes duplicates while keeping one row per group?",
  "options": [
    "DISTINCT",
    "GROUP BY",
    "ROW_NUMBER with PARTITION",
    "HAVING COUNT(*) > 1"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why is ROW_NUMBER preferred over GROUP BY when deleting duplicates?",
  "options": [
    "Always faster",
    "Allows control over which row is kept",
    "Consumes less memory",
    "Avoids sorting"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which function is best to get the latest row per group?",
  "options": [
    "RANK",
    "DENSE_RANK",
    "ROW_NUMBER",
    "NTILE"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why does using MONTH(date) in WHERE clause hurt performance?",
  "options": [
    "Incorrect results",
    "Implicit conversion",
    "Prevents index seek",
    "Requires GROUP BY"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which feature allows aggregation without losing row-level detail?",
  "options": [
    "GROUP BY",
    "DISTINCT",
    "Window functions",
    "Subqueries"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why is CASE used when summing positive and negative values?",
  "options": [
    "To avoid joins",
    "To conditionally aggregate data",
    "To improve indexing",
    "To handle NULL values"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "How does SUM() behave when NULL values are present?",
  "options": [
    "Returns NULL",
    "Throws an error",
    "Ignores NULL values",
    "Stops execution"
  ],
  "answer": 2,
  "time": 20
}
  ,
  {
    "q": "What is the key difference between COUNT(CASE WHEN condition THEN 1 END) and SUM(CASE WHEN condition THEN 1 ELSE 0 END)?",
    "options": [
      "COUNT counts NULL values but SUM does not",
      "SUM returns NULL when no rows match, COUNT returns 0",
      "COUNT ignores NULL values, SUM evaluates all rows",
      "There is no difference in any scenario"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why does COUNT(CASE WHEN id >= 0 THEN 1 END) correctly count only positive rows?",
    "options": [
      "COUNT evaluates the CASE expression result",
      "COUNT ignores rows where CASE returns NULL",
      "COUNT converts 1 to TRUE internally",
      "COUNT automatically applies a WHERE filter"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which expression would incorrectly count negative rows?",
    "options": [
      "COUNT(CASE WHEN id < 0 THEN 1 END)",
      "SUM(CASE WHEN id < 0 THEN 1 ELSE 0 END)",
      "COUNT(CASE WHEN id < 0 THEN id END)",
      "SUM(CASE WHEN id < 0 THEN id ELSE 0 END)"
    ],
    "answer": 3,
    "time": 30
  },
  {
    "q": "What happens if all rows are positive and you run SUM(CASE WHEN id < 0 THEN id END)?",
    "options": [
      "Returns 0",
      "Returns NULL",
      "Returns empty result",
      "Throws an error"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Why is using a unique primary key in DELETE duplicate queries safer?",
    "options": [
      "It improves query speed only",
      "It avoids deleting unintended rows with same business keys",
      "ROW_NUMBER requires a primary key",
      "DELETE cannot run without a primary key"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which DELETE strategy may fail if duplicate rows share the same id?",
    "options": [
      "DELETE FROM cte WHERE rn > 1",
      "DELETE WHERE id IN (SELECT id FROM cte WHERE rn > 1)",
      "DELETE using primary key",
      "DELETE using ROW_NUMBER partitioned by primary key"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why can DELETE ... WHERE id IN (subquery) be dangerous in de-duplication?",
    "options": [
      "IN is slower than EXISTS",
      "Subquery executes multiple times",
      "It may delete all rows sharing the same id",
      "DELETE does not support IN"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which SQL Server feature allows deleting directly from a CTE?",
    "options": [
      "ANSI SQL standard",
      "SQL Server extension",
      "Window function behavior",
      "Temporary table optimization"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What is the biggest risk of CROSS JOIN in production queries?",
    "options": [
      "Incorrect data types",
      "Deadlocks",
      "Cartesian explosion of rows",
      "Implicit NULL generation"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "If TableA has 5 rows and TableB has 0 rows, what does CROSS JOIN return?",
    "options": [
      "5 rows",
      "0 rows",
      "NULL rows",
      "Error"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which JOIN type preserves all rows from both tables regardless of matches?",
    "options": [
      "INNER JOIN",
      "LEFT JOIN",
      "RIGHT JOIN",
      "FULL OUTER JOIN"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "Which condition correctly implements a FULL OUTER ANTI-JOIN?",
    "options": [
      "WHERE a.col = b.col",
      "WHERE a.col IS NOT NULL AND b.col IS NOT NULL",
      "WHERE a.col IS NULL OR b.col IS NULL",
      "WHERE a.col <> b.col"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why does WHERE a.col <> b.col not correctly identify unmatched rows in FULL OUTER JOIN?",
    "options": [
      "<> does not work on strings",
      "NULL comparisons return UNKNOWN",
      "FULL JOIN removes NULLs automatically",
      "JOIN condition overrides WHERE clause"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which join pattern is best for finding mismatched records between two tables?",
    "options": [
      "INNER JOIN",
      "LEFT JOIN with WHERE b.col IS NULL",
      "FULL OUTER JOIN with NULL filters",
      "CROSS JOIN with filters"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "What logical operation does FULL OUTER JOIN excluding matches represent?",
    "options": [
      "Intersection",
      "Union",
      "Symmetric Difference",
      "Difference"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which JOIN type is functionally equivalent to LEFT JOIN + RIGHT JOIN UNION?",
    "options": [
      "INNER JOIN",
      "CROSS JOIN",
      "FULL OUTER JOIN",
      "SELF JOIN"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Why is COUNT(*) safe in aggregate queries but COUNT(column) may not be?",
    "options": [
      "COUNT(column) is slower",
      "COUNT(column) ignores NULL values",
      "COUNT(*) includes duplicates",
      "COUNT(column) requires indexes"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which aggregate expression guarantees a zero instead of NULL when no rows match?",
    "options": [
      "SUM(column)",
      "COUNT(column)",
      "SUM(CASE WHEN condition THEN 1 ELSE 0 END)",
      "COUNT(CASE WHEN condition THEN NULL END)"
    ],
    "answer": 2,
    "time": 30
  }
,
  {
    "q": "Which aggregate expression will return an incorrect positive_count if id contains NULL values?",
    "options": [
      "COUNT(*)",
      "COUNT(id)",
      "COUNT(CASE WHEN id >= 0 THEN 1 END)",
      "SUM(CASE WHEN id >= 0 THEN 1 ELSE 0 END)"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why is SUM(CASE WHEN condition THEN 1 END) considered unsafe for counting?",
    "options": [
      "SUM ignores NULL rows",
      "SUM returns NULL when no rows satisfy the condition",
      "SUM cannot be used with CASE",
      "SUM is slower than COUNT"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which approach guarantees correct counts even when the column contains NULLs?",
    "options": [
      "COUNT(column)",
      "COUNT(CASE WHEN condition THEN column END)",
      "SUM(CASE WHEN condition THEN 1 ELSE 0 END)",
      "COUNT(*)"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "What happens if ROW_NUMBER() ORDER BY clause is non-deterministic while deleting duplicates?",
    "options": [
      "Query fails",
      "Duplicates remain",
      "Random rows may be deleted",
      "SQL Server auto-fixes it"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which window function is safest when you want to keep exactly one row per duplicate group without caring which one?",
    "options": [
      "RANK()",
      "DENSE_RANK()",
      "ROW_NUMBER()",
      "NTILE()"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Why is DELETE using JOIN often preferred over DELETE using IN for de-duplication?",
    "options": [
      "JOIN allows GROUP BY",
      "JOIN avoids accidental multi-row deletion",
      "JOIN performs better and avoids logical ambiguity",
      "IN is not supported in DELETE"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which query pattern can silently turn a LEFT JOIN into an INNER JOIN?",
    "options": [
      "Using aliases",
      "Filtering right table columns in WHERE clause",
      "Using ON instead of USING",
      "Selecting specific columns"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why should conditions filtering the right table be placed inside the ON clause for LEFT JOIN?",
    "options": [
      "For better performance only",
      "To preserve unmatched left rows",
      "SQL Server requires it",
      "To avoid NULL values"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which join guarantees no row multiplication?",
    "options": [
      "INNER JOIN",
      "LEFT JOIN",
      "CROSS JOIN",
      "None of the above"
    ],
    "answer": 3,
    "time": 25
  },
  {
    "q": "Which scenario is the most dangerous use case of CROSS JOIN?",
    "options": [
      "Generating a calendar",
      "Pairing static dimension values",
      "Joining large fact tables accidentally",
      "Small lookup table joins"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Why does FULL OUTER JOIN with WHERE a.col <> b.col fail to detect mismatches?",
    "options": [
      "FULL JOIN ignores WHERE clause",
      "NULL comparisons return UNKNOWN",
      "The JOIN happens after WHERE",
      "Indexes are missing"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which condition correctly identifies rows present in TableA but not in TableB?",
    "options": [
      "a.col <> b.col",
      "a.col IS NOT NULL AND b.col IS NULL",
      "a.col IS NULL AND b.col IS NOT NULL",
      "a.col = b.col"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which join pattern represents a symmetric difference between two datasets?",
    "options": [
      "INNER JOIN",
      "LEFT ANTI JOIN",
      "RIGHT ANTI JOIN",
      "FULL OUTER JOIN with NULL filtering"
    ],
    "answer": 3,
    "time": 30
  },
  {
    "q": "Why is COUNT(*) preferred over COUNT(column) after OUTER JOINs?",
    "options": [
      "COUNT(column) is slower",
      "COUNT(column) ignores NULLs introduced by joins",
      "COUNT(*) requires indexes",
      "COUNT(column) causes duplication"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which operation happens first in SQL logical query processing?",
    "options": [
      "SELECT",
      "WHERE",
      "JOIN / FROM",
      "ORDER BY"
    ],
    "answer": 2,
    "time": 20
  }
,

{
  "q": "Which query correctly implements a LEFT EXCLUDING JOIN?",
  "options": [
    "SELECT * FROM A INNER JOIN B ON A.id = B.id WHERE B.id IS NULL",
    "SELECT * FROM A LEFT JOIN B ON A.id = B.id WHERE B.id IS NULL",
    "SELECT * FROM A RIGHT JOIN B ON A.id = B.id WHERE A.id IS NULL",
    "SELECT * FROM A FULL JOIN B ON A.id <> B.id"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Why does a LEFT JOIN with a WHERE condition on the right table act like an INNER JOIN?",
  "options": [
    "LEFT JOIN ignores NULL values",
    "WHERE clause is applied before JOIN",
    "Filtering right-table columns removes NULL-extended rows",
    "SQL optimizer rewrites it as INNER JOIN"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which condition identifies rows present only in the right table?",
  "options": [
    "LEFT JOIN WHERE B.col IS NULL",
    "RIGHT JOIN WHERE A.col IS NULL",
    "FULL JOIN WHERE A.col = B.col",
    "INNER JOIN WHERE A.col <> B.col"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Which join pattern represents 'A minus B'?",
  "options": [
    "INNER JOIN",
    "LEFT EXCLUDING JOIN",
    "RIGHT EXCLUDING JOIN",
    "FULL OUTER JOIN"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why is FULL OUTER JOIN with NULL filtering preferred over UNION of LEFT and RIGHT joins?",
  "options": [
    "UNION removes duplicates",
    "FULL JOIN is ANSI standard",
    "FULL JOIN preserves row origin with NULLs",
    "LEFT and RIGHT joins are slower"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which statement about subqueries vs JOINs is true in modern SQL engines?",
  "options": [
    "JOINs are always faster than subqueries",
    "Subqueries always execute row by row",
    "Optimizers can rewrite subqueries as joins",
    "Subqueries cannot use indexes"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which subquery pattern is most likely to cause performance issues on large datasets?",
  "options": [
    "Correlated subquery",
    "Scalar subquery",
    "Derived table",
    "CTE"
  ],
  "answer": 0,
  "time": 30
},
{
  "q": "Why are JOINs generally preferred over subqueries for DELETE operations?",
  "options": [
    "DELETE does not support subqueries",
    "JOINs are more readable",
    "JOINs allow better execution plans",
    "Subqueries cannot delete rows"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which DELETE statement is the safest when removing rows based on another table?",
  "options": [
    "DELETE FROM A WHERE id IN (SELECT id FROM B)",
    "DELETE A FROM A JOIN B ON A.id = B.id",
    "DELETE FROM A WHERE EXISTS (SELECT 1 FROM B)",
    "DELETE FROM A"
  ],
  "answer": 1,
  "time": 30
},
{
  "q": "Why is ORDER BY not allowed in a DELETE statement?",
  "options": [
    "DELETE does not return rows",
    "ORDER BY requires SELECT",
    "DELETE is logically unordered",
    "ORDER BY impacts performance"
  ],
  "answer": 2,
  "time": 25
},
{
  "q": "Which scenario violates First Normal Form (1NF)?",
  "options": [
    "Atomic values in each column",
    "Multiple phone numbers stored in one column",
    "Primary key present",
    "Unique rows"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Why does storing comma-separated values break 1NF?",
  "options": [
    "Indexes cannot be created",
    "Violates atomicity",
    "Primary key fails",
    "Data types mismatch"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Which table design satisfies 1NF but still allows data redundancy?",
  "options": [
    "Atomic columns with repeating rows",
    "Comma-separated columns",
    "No primary key",
    "Nested tables"
  ],
  "answer": 0,
  "time": 30
},
{
  "q": "Why does a CHECK constraint allow NULL values by default?",
  "options": [
    "NULL means invalid data",
    "CHECK ignores NULL rows",
    "NULL evaluates to UNKNOWN which passes CHECK",
    "CHECK only validates inserts"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which CHECK constraint definition will FAIL to create?",
  "options": [
    "CHECK (Age >= 18)",
    "CHECK (Salary > 0 AND Age >= 18)",
    "CHECK (Age IN (SELECT Age FROM RefTable))",
    "CHECK (Age BETWEEN 18 AND 60)"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Why is naming CHECK constraints considered best practice?",
  "options": [
    "Improves query performance",
    "Mandatory in SQL standard",
    "Easier to drop or modify later",
    "Prevents duplicate constraints"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which operation can bypass a CHECK constraint?",
  "options": [
    "INSERT",
    "UPDATE",
    "Bulk load with constraint disabled",
    "SELECT"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which statement about CHECK constraints is TRUE?",
  "options": [
    "They can reference other tables",
    "They can use subqueries",
    "They are evaluated per row",
    "They enforce referential integrity"
  ],
  "answer": 2,
  "time": 25
}
,
  

  {
    "q": "Why does a NOT NULL constraint differ fundamentally from a CHECK constraint?",
    "options": [
      "NOT NULL is faster than CHECK",
      "NOT NULL is evaluated before CHECK",
      "CHECK allows NULL values unless explicitly restricted",
      "CHECK constraints cannot be indexed"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why does a CHECK constraint allow NULL values by default?",
    "options": [
      "NULL values are ignored by constraints",
      "CHECK constraints are optional",
      "NULL evaluates to UNKNOWN, which passes CHECK validation",
      "CHECK constraints only validate INSERTs"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which operation will immediately fail when adding a NOT NULL constraint to an existing column?",
    "options": [
      "Column contains duplicate values",
      "Column contains NULL values",
      "Column contains negative values",
      "Column is indexed"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Why is adding a NOT NULL constraint considered a data-breaking change?",
    "options": [
      "It requires rebuilding indexes",
      "It enforces validation on existing and future data",
      "It changes query execution plans",
      "It locks the table permanently"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which constraint can exist multiple times on the same table?",
    "options": [
      "Primary Key",
      "Foreign Key",
      "Unique Constraint",
      "Identity"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why does a UNIQUE constraint allow one NULL value?",
    "options": [
      "NULL is treated as a value",
      "NULLs are ignored in uniqueness checks",
      "NULL represents UNKNOWN and is not equal to another NULL",
      "UNIQUE constraints are optional"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which design requirement forces the use of PRIMARY KEY instead of UNIQUE?",
    "options": [
      "Uniqueness only",
      "Ability to allow NULL",
      "Logical row identification and referential integrity",
      "Index creation"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What happens if you attempt to add a PRIMARY KEY to a table with duplicate values?",
    "options": [
      "Duplicates are automatically removed",
      "Constraint creation fails",
      "Only one row is kept",
      "Duplicates are converted to NULL"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Why can a table have only one PRIMARY KEY but multiple UNIQUE constraints?",
    "options": [
      "PRIMARY KEY is a physical structure",
      "PRIMARY KEY identifies the row, UNIQUE only enforces rules",
      "UNIQUE constraints are optional",
      "PRIMARY KEY does not create an index"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which constraint implicitly creates a clustered index by default in SQL Server?",
    "options": [
      "CHECK",
      "UNIQUE",
      "PRIMARY KEY",
      "FOREIGN KEY"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why is cleaning data before adding constraints a recommended practice in migrations?",
    "options": [
      "Constraints automatically fix data",
      "Constraints validate existing data immediately",
      "Indexes require clean data",
      "Triggers depend on constraints"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which constraint is most likely to slow down bulk INSERT operations?",
    "options": [
      "NOT NULL",
      "CHECK",
      "PRIMARY KEY / UNIQUE",
      "DEFAULT"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why areBase are constraints considered self-documenting schema elements?",
    "options": [
      "They generate ER diagrams automatically",
      "They describe business rules directly in metadata",
      "They add comments to columns",
      "They replace documentation tools"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which approach provides uniqueness enforcement with more flexibility than a UNIQUE constraint?",
    "options": [
      "Primary Key",
      "CHECK constraint",
      "Unique Index",
      "NOT NULL"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which statement about NULL comparisons is TRUE?",
    "options": [
      "NULL = NULL evaluates to TRUE",
      "NULL <> NULL evaluates to TRUE",
      "Any comparison with NULL returns UNKNOWN",
      "NULL behaves like zero"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why are triggers not preferred over constraints for enforcing simple rules?",
    "options": [
      "Triggers are faster",
      "Triggers are harder to maintain and debug",
      "Triggers cannot block inserts",
      "Triggers do not support validation"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which constraint contributes the MOST to data integrity with the LEAST logic complexity?",
    "options": [
      "Trigger",
      "Application validation",
      "Database constraint",
      "Stored procedure"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why should constraints usually be enabled AFTER bulk data loads?",
    "options": [
      "Constraints are ignored during bulk load",
      "Bulk load does not support constraints",
      "Constraint validation adds overhead during load",
      "Indexes must be rebuilt first"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why is sp_executesql preferred over EXEC for dynamic SQL in production systems?",
    "options": [
      "It executes faster in all cases",
      "It supports parameterization and plan reuse",
      "It allows dynamic table creation",
      "It suppresses SQL injection automatically"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is the biggest security risk when using EXEC(@sql) with string concatenation?",
    "options": [
      "Deadlocks",
      "Blocking",
      "SQL Injection",
      "Plan cache pollution"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Which feature of sp_executesql helps reduce plan cache bloat?",
    "options": [
      "Deferred compilation",
      "Parameterization",
      "Implicit transactions",
      "Batch execution"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why does dynamic SQL often suffer from parameter sniffing issues?",
    "options": [
      "Parameters are evaluated at runtime",
      "Execution plans are reused with different parameter values",
      "Dynamic SQL ignores indexes",
      "SQL Server recompiles every time"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which dynamic SQL scenario CANNOT be replaced with a parameterized query?",
    "options": [
      "Dynamic WHERE clause values",
      "Dynamic column names",
      "Dynamic filter values",
      "Dynamic input parameters"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What happens if a variable declared outside dynamic SQL is referenced inside EXEC(@sql)?",
    "options": [
      "It is automatically resolved",
      "It throws a compilation error",
      "It is treated as NULL",
      "It becomes global"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which error types are NOT caught by TRY...CATCH in SQL Server?",
    "options": [
      "Divide by zero",
      "Conversion errors",
      "Compile-time errors",
      "Constraint violations"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why is XACT_STATE() checked inside a CATCH block?",
    "options": [
      "To check if transaction exists",
      "To decide whether COMMIT or ROLLBACK is allowed",
      "To restart a transaction",
      "To suppress errors"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What does XACT_STATE() = -1 indicate?",
    "options": [
      "No active transaction",
      "Transaction is committable",
      "Transaction is uncommittable and must be rolled back",
      "Transaction is suspended"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Which statement about TRY...CATCH with transactions is TRUE?",
    "options": [
      "COMMIT is automatic if TRY succeeds",
      "ROLLBACK happens automatically on error",
      "Transaction must be explicitly committed or rolled back",
      "CATCH block always commits"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why is THROW preferred over RAISERROR in modern SQL Server?",
    "options": [
      "THROW supports formatted messages",
      "THROW preserves original error information",
      "RAISERROR is faster",
      "RAISERROR supports transactions better"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is the main benefit of logging errors into a table instead of printing them?",
    "options": [
      "Improves performance",
      "Allows auditing and post-mortem analysis",
      "Prevents transaction rollback",
      "Avoids TRY...CATCH"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Why should error logging inside a CATCH block avoid complex logic?",
    "options": [
      "CATCH blocks run only once",
      "Errors inside CATCH can suppress original error",
      "CATCH blocks cannot contain DML",
      "CATCH blocks auto-rollback"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is the effect of SET NOCOUNT ON inside a stored procedure?",
    "options": [
      "Prevents result sets from returning",
      "Suppresses row count messages",
      "Disables transactions",
      "Improves index usage"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "Why is SET NOCOUNT ON recommended for procedures executed by applications?",
    "options": [
      "It avoids SQL injection",
      "It reduces network traffic",
      "It forces recompilation",
      "It improves locking behavior"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Why does SET NOCOUNT ON placed outside a stored procedure not affect it?",
    "options": [
      "SET commands are session scoped",
      "Stored procedures reset session settings",
      "SET NOCOUNT is batch scoped",
      "Procedures ignore SET options"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which operation still returns results even when SET NOCOUNT ON is enabled?",
    "options": [
      "INSERT",
      "UPDATE",
      "SELECT",
      "MERGE"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which scenario benefits MOST from SET NOCOUNT ON?",
    "options": [
      "Single-row SELECT",
      "Bulk INSERT in stored procedure",
      "DDL operations",
      "Ad-hoc queries"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What hidden issue can arise if NOCOUNT is OFF in application-driven procedures?",
    "options": [
      "Deadlocks",
      "Extra result sets confusing application logic",
      "Index fragmentation",
      "Implicit commits"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which statement about NULL is TRUE in SQL Server?",
    "options": [
      "NULL = NULL returns TRUE",
      "NULL + 10 returns 10",
      "NULL compared with any value returns UNKNOWN",
      "NULL is equal to 0"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which aggregate function ignores NULL values?",
    "options": [
      "COUNT(*)",
      "COUNT(column_name)",
      "SUM(*)",
      "GROUP BY"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Can you add a PRIMARY KEY constraint to a table that already contains data?",
    "options": [
      "Yes, always",
      "Only if no duplicate and no NULL values exist",
      "Only if the table is empty",
      "Only using triggers"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What happens if you try to add a NOT NULL constraint on a column that contains NULL values?",
    "options": [
      "SQL Server replaces NULLs with default values",
      "Constraint is added and NULLs remain",
      "Operation fails",
      "NULL rows are deleted automatically"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "How many PRIMARY KEY constraints can a table have?",
    "options": [
      "Zero",
      "One",
      "Two",
      "Unlimited"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which statement is TRUE about UNIQUE constraints in SQL Server?",
    "options": [
      "A table can have only one UNIQUE constraint",
      "UNIQUE constraint does not allow NULL values",
      "UNIQUE constraint allows one NULL value",
      "UNIQUE constraint is the same as PRIMARY KEY"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which method is safer for executing Dynamic SQL in SQL Server?",
    "options": [
      "EXEC()",
      "sp_executesql",
      "PRINT",
      "SELECT"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is the main risk of using EXEC() with string concatenation?",
    "options": [
      "Deadlocks",
      "Index fragmentation",
      "SQL Injection",
      "Blocking"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which function returns the error message inside a CATCH block?",
    "options": [
      "ERROR_LINE()",
      "ERROR_SEVERITY()",
      "ERROR_MESSAGE()",
      "ERROR_STATE()"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What is the value of @@TRANCOUNT after a ROLLBACK statement?",
    "options": [
      "1",
      "Depends on nesting level",
      "0",
      "-1"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which JOIN returns only matching rows from both tables?",
    "options": [
      "LEFT OUTER JOIN",
      "RIGHT OUTER JOIN",
      "FULL OUTER JOIN",
      "INNER JOIN"
    ],
    "answer": 3,
    "time": 30
  },
  {
    "q": "Which DMV is used to identify slow-running queries in SQL Server?",
    "options": [
      "sys.tables",
      "sys.indexes",
      "sys.dm_exec_query_stats",
      "sys.objects"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What is the purpose of SET NOCOUNT ON?",
    "options": [
      "Stops query execution",
      "Suppresses row count messages",
      "Improves indexing",
      "Prevents deadlocks"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What does the CEILING() function do in SQL Server?",
    "options": [
      "Rounds a number to the nearest integer",
      "Returns the smallest integer greater than or equal to the number",
      "Returns the largest integer less than or equal to the number",
      "Removes decimal values"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is the result of FLOOR(6.6) in SQL Server?",
    "options": [
      "7",
      "6",
      "6.6",
      "Error"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is the output of ROUND(6.5, 0) in SQL Server?",
    "options": [
      "6",
      "6.0",
      "7",
      "7.0"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which function is best suited to find the latest record per consumer from a history table?",
    "options": [
      "RANK()",
      "DENSE_RANK()",
      "ROW_NUMBER() with ORDER BY DESC",
      "NTILE()"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which clause is used with ROW_NUMBER() to group records before ordering?",
    "options": [
      "ORDER BY",
      "GROUP BY",
      "PARTITION BY",
      "HAVING"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which SQL construct is used to swap values like 0 to 1 and 1 to 0?",
    "options": [
      "IF...ELSE",
      "CASE expression",
      "COALESCE",
      "ISNULL"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which function is commonly used to check if an object exists in SQL Server?",
    "options": [
      "OBJECT_NAME()",
      "OBJECT_SCHEMA_NAME()",
      "OBJECT_ID()",
      "SCHEMA_ID()"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which object type code represents a user table in OBJECT_ID checks?",
    "options": [
      "V",
      "P",
      "U",
      "T"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Where are temporary tables physically stored in SQL Server?",
    "options": [
      "master database",
      "user database",
      "tempdb database",
      "model database"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which command is commonly used to describe a temporary table structure?",
    "options": [
      "DESCRIBE #temp",
      "sp_help '#temp'",
      "SHOW COLUMNS",
      "DBCC INPUTBUFFER"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What does OBJECT_ID() return in SQL Server?",
    "options": [
      "The schema name of the object",
      "The ID of a schema-scoped object",
      "The row count of a table",
      "The database ID"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What will OBJECT_ID() return if the object does not exist?",
    "options": [
      "0",
      "-1",
      "NULL",
      "Error"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which parameter is used with OBJECT_ID to specify the object type?",
    "options": [
      "Database ID",
      "Object type code like 'U', 'V', 'P'",
      "Schema name",
      "Collation"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What does OBJECT_NAME(object_id) return?",
    "options": [
      "The ID of an object",
      "The name of an object from its object_id",
      "The database ID of an object",
      "The owner of the object"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which function would you use to find a stored procedure containing specific text?",
    "options": [
      "OBJECT_ID()",
      "OBJECT_NAME()",
      "OBJECT_DEFINITION()",
      "DB_NAME()"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which function is used to identify the datatype and properties of a variable in SQL Server?",
    "options": [
      "TYPEOF()",
      "SQL_VARIANT_PROPERTY()",
      "ISNUMERIC()",
      "CAST()"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which property of SQL_VARIANT_PROPERTY() gives the number of bytes required to store a variable?",
    "options": [
      "Precision",
      "Scale",
      "TotalBytes",
      "MaxLength"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What is the main difference between a temporary table (#TempTable) and a global temporary table (##GlobalTempTable)?",
    "options": [
      "Temporary table exists in master DB, global temp in tempdb",
      "Temporary table is session-specific, global temp is accessible to all sessions",
      "Temporary table requires DROP, global temp is auto-dropped",
      "Temporary table can’t have indexes, global temp can"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Where are temporary and global temporary tables stored physically in SQL Server?",
    "options": [
      "User database",
      "master database",
      "tempdb",
      "model database"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which catalog view and function combination can be used to search stored procedures containing a specific string?",
    "options": [
      "sys.tables + OBJECT_ID()",
      "sys.procedures + OBJECT_DEFINITION()",
      "sys.objects + OBJECT_NAME()",
      "sys.columns + OBJECT_DEFINITION()"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which SQL statements are considered DDL (Data Definition Language)?",
    "options": [
      "SELECT, INSERT, UPDATE",
      "CREATE, ALTER, DROP, TRUNCATE",
      "GRANT, REVOKE",
      "COMMIT, ROLLBACK"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which SQL statements are considered DML (Data Manipulation Language)?",
    "options": [
      "SELECT, INSERT, UPDATE, DELETE, MERGE",
      "CREATE, ALTER, DROP",
      "GRANT, REVOKE",
      "COMMIT, ROLLBACK"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Which SQL statements are considered DCL (Data Control Language)?",
    "options": [
      "SELECT, INSERT",
      "COMMIT, ROLLBACK",
      "GRANT, REVOKE",
      "CREATE, ALTER, DROP"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which SQL statements are considered TCL (Transaction Control Language)?",
    "options": [
      "COMMIT, ROLLBACK, SAVEPOINT, SET TRANSACTION",
      "SELECT, INSERT",
      "CREATE, ALTER, DROP",
      "GRANT, REVOKE"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "What does the ALL operator do in SQL?",
    "options": [
      "Returns TRUE if a value matches at least one value in a subquery",
      "Returns TRUE if a value matches all values in a subquery",
      "Performs an aggregate SUM of all values",
      "Compares values with a fixed constant"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which comparison operators can be used with ALL in SQL?",
    "options": [
      "=, !=, >, <, >=, <=",
      "LIKE, IN",
      "BETWEEN, ISNULL",
      "JOIN, UNION"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Why does the query fail: `SELECT Name FROM Employees WHERE Salary > (SELECT AvgSalary FROM Departments)`?",
    "options": [
      "The subquery is empty",
      "The outer query has no columns",
      "The subquery returns multiple rows",
      "The outer query uses an aggregate function incorrectly"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "How can you fix a subquery that returns multiple rows for comparison in SQL?",
    "options": [
      "Use an aggregate function like AVG()",
      "Use ALL or ANY operators",
      "Both A and B",
      "Change the table structure"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "In SQL, what is a tuple?",
    "options": [
      "A column in a table",
      "A row in a table",
      "The table schema",
      "A database index"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "In relational model terminology, which of the following is equivalent to a tuple in SQL?",
    "options": [
      "Table",
      "Column",
      "Row",
      "Data type"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What does the ANY operator do in SQL?",
    "options": [
      "Returns TRUE if a value matches all values in a subquery",
      "Returns TRUE if a value matches at least one value in a subquery",
      "Returns all rows from a table",
      "Returns NULL for unmatched rows"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which statement is TRUE about ALL and ANY operators in SQL?",
    "options": [
      "ALL requires the condition to be true for at least one value",
      "ANY requires the condition to be true for all values",
      "ALL requires the condition to be true for all values; ANY requires the condition to be true for at least one value",
      "ALL and ANY are equivalent and interchangeable"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why does the query `SELECT Name FROM Employees WHERE Salary > (SELECT AvgSalary FROM Departments)` fail if WHERE clause is removed from subquery?",
    "options": [
      "Outer query has no columns",
      "Subquery returns multiple rows, which cannot be compared with >",
      "Salary column is NULL",
      "AVG function is missing"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "How can you modify a multi-row subquery to avoid the error when comparing with a scalar?",
    "options": [
      "Use aggregate function like AVG() to return a single value",
      "Use ALL or ANY operators for multi-row comparison",
      "Both A and B",
      "Change the table structure"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Find employees whose salaries are equal to the average salary of their department. Which SQL query is correct?",
    "options": [
      "SELECT first_name FROM employees WHERE salary = ALL (SELECT AVG(salary) FROM employees GROUP BY department_id)",
      "SELECT first_name FROM employees WHERE salary = ANY (SELECT AVG(salary) FROM employees GROUP BY department_id)",
      "SELECT first_name FROM employees WHERE salary > ANY (SELECT MAX(salary) FROM employees GROUP BY department_id)",
      "SELECT first_name FROM employees WHERE salary < ALL (SELECT MIN(salary) FROM employees GROUP BY department_id)"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Consider the query: `SELECT * FROM (SELECT 1 AS a, 2 AS b) ab WHERE a <= ALL (SELECT 0 AS a UNION SELECT 4)`; what will it return?",
    "options": [
      "Row (1, 2)",
      "Row (0, 2)",
      "No rows",
      "Error due to UNION"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Consider the query: `SELECT * FROM (SELECT 1 AS a, 2 AS b) ab WHERE a <= ANY (SELECT 0 AS a UNION SELECT 4)`; what will it return?",
    "options": [
      "Row (1, 2)",
      "Row (0, 2)",
      "No rows",
      "Error due to ANY operator"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "What does the function DB_ID() return in SQL Server?",
    "options": [
      "ID of the current user",
      "ID of the current database",
      "Number of tables in the database",
      "Maximum object_id in the database"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "How do you get the ID of a specific database named 'TestDB'?",
    "options": [
      "SELECT OBJECT_ID('TestDB')",
      "SELECT DB_ID('TestDB')",
      "SELECT DATABASEPROPERTY('TestDB')",
      "SELECT DATABASE_ID('TestDB')"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which query returns products ordered at least once with quantity 9?",
    "options": [
      "SELECT ProductName FROM Products WHERE ProductID = ALL (SELECT ProductID FROM OrderDetails WHERE Quantity = 9)",
      "SELECT ProductName FROM Products WHERE ProductID = ANY (SELECT ProductID FROM OrderDetails WHERE Quantity = 9)",
      "SELECT ProductName FROM Products WHERE Quantity = 9",
      "SELECT ProductName FROM Products WHERE ProductID IN (SELECT ProductID FROM OrderDetails WHERE Quantity = 10)"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "If you want to find employees whose salary is higher than at least one department average salary, which operator should you use?",
    "options": [
      "ALL",
      "ANY",
      "IN",
      "EXISTS"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What does DB_NAME() without any argument return in SQL Server?",
    "options": [
      "The ID of the current database",
      "The name of the current database",
      "The default schema name",
      "NULL"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "How do you get the name of a database with database_id = 3?",
    "options": [
      "SELECT DB_NAME(3)",
      "SELECT DATABASE_NAME(3)",
      "SELECT OBJECT_NAME(3)",
      "SELECT DB_ID(3)"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Which of the following is TRUE about CASE statements in SQL?",
    "options": [
      "CASE can only be used in SELECT clause",
      "CASE cannot be nested",
      "CASE can be used in SELECT, ORDER BY, UPDATE, and WHERE clauses",
      "CASE always returns TRUE or FALSE"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "How can you count male and female employees in each department using CASE?",
    "options": [
      "COUNT(CASE WHEN gender='M' THEN 1 END)",
      "SUM(CASE WHEN gender='M' THEN 1 ELSE 0 END)",
      "Both A and B",
      "Neither A nor B"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What happens if no CASE conditions match and there is no ELSE clause?",
    "options": [
      "SQL throws an error",
      "SQL returns NULL",
      "SQL returns 0",
      "SQL returns the first value of the column"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which query can be used to check whether all employee IDs (`emp_id`) are unique?",
    "options": [
      "SELECT emp_id, COUNT(*) FROM employees GROUP BY emp_id HAVING COUNT(*) > 1",
      "SELECT DISTINCT emp_id FROM employees",
      "SELECT emp_id FROM employees WHERE emp_id IS UNIQUE",
      "SELECT emp_id FROM employees GROUP BY emp_id"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "How do you quickly confirm total records vs unique employee IDs?",
    "options": [
      "SELECT COUNT(*) FROM employees",
      "SELECT COUNT(DISTINCT emp_id) FROM employees",
      "SELECT COUNT(*) AS total_records, COUNT(DISTINCT emp_id) AS unique_emp_ids FROM employees",
      "SELECT emp_id, COUNT(*) FROM employees"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which of the following statements is NOT a DML command?",
    "options": [
      "SELECT",
      "INSERT",
      "UPDATE",
      "CREATE TABLE"
    ],
    "answer": 3,
    "time": 30
  },
  {
    "q": "What is the main difference between DML and DDL commands?",
    "options": [
      "DML affects database structure, DDL affects data",
      "DML affects data, DDL affects database structure",
      "DML and DDL are the same",
      "DML affects permissions, DDL affects transactions"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "How can you sort employees with job_name 'MANAGER' first, 'ANALYST' second, others last?",
    "options": [
      "ORDER BY job_name",
      "ORDER BY CASE WHEN job_name='MANAGER' THEN 1 WHEN job_name='ANALYST' THEN 2 ELSE 3 END",
      "ORDER BY CASE job_name END",
      "ORDER BY salary DESC"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "How would you give a bonus of 500 to IT department employees only using CASE in UPDATE?",
    "options": [
      "UPDATE employees SET salary = salary + 500 WHERE department='IT'",
      "UPDATE employees SET salary = salary + CASE WHEN department='IT' THEN 500 ELSE 0 END",
      "Both A and B",
      "UPDATE employees SET salary = 500"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "How can you delete duplicate rows in a table while keeping only one copy?",
    "options": [
      "DELETE FROM employees",
      "WITH DuplicateCTE AS (SELECT *, ROW_NUMBER() OVER(PARTITION BY emp_id ORDER BY emp_id) AS rn FROM employees) DELETE FROM DuplicateCTE WHERE rn > 1",
      "TRUNCATE TABLE employees",
      "DROP TABLE employees"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "How do you rename a column 'emp_name' to 'employee_name' in SQL Server?",
    "options": [
      "ALTER TABLE Employees RENAME COLUMN emp_name TO employee_name",
      "EXEC sp_rename 'Employees.emp_name', 'employee_name', 'COLUMN'",
      "ALTER COLUMN emp_name RENAME TO employee_name",
      "UPDATE Employees SET emp_name = 'employee_name'"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "How do you rename a database 'Test' to 'Test2'?",
    "options": [
      "ALTER DATABASE [Test] MODIFY NAME = [Test2]",
      "EXEC sp_renamedb 'Test', 'Test2'",
      "Both A and B",
      "DROP DATABASE Test; CREATE DATABASE Test2"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Write an SQL query to display total units sold by each pizza company.",
    "options": [
      "SELECT com, SUM(unitssold) FROM Foods GROUP BY com",
      "SELECT f.com, p.companyname, SUM(f.unitssold) AS total_units_sold FROM Foods f JOIN PizzaCompany p ON f.com = p.companyid GROUP BY f.com, p.companyname",
      "SELECT * FROM Foods",
      "SELECT companyname, SUM(unitssold) FROM PizzaCompany JOIN Foods"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Find department name, grade, and number of employees where at least two employees are SALESMAN.",
    "options": [
      "SELECT d.dep_name, s.grade, COUNT(*) FROM employees e JOIN department d ON e.dep_id = d.dep_id JOIN salary_grade s ON e.salary BETWEEN s.min_sal AND s.max_sal WHERE e.job_name = 'SALESMAN' GROUP BY d.dep_name, s.grade HAVING COUNT(*) >= 2",
      "SELECT dep_name FROM department",
      "SELECT * FROM employees WHERE job_name='SALESMAN'",
      "SELECT COUNT(*) FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "List departments where at least two employees are working.",
    "options": [
      "SELECT dep_name FROM dept WHERE dep_id IN (SELECT dep_id FROM emp2 GROUP BY dep_id HAVING COUNT(*) >= 2)",
      "SELECT dep_name FROM dept",
      "SELECT dep_name, COUNT(*) FROM emp2",
      "SELECT * FROM emp2"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Find product names where any order has quantity = 9.",
    "options": [
      "SELECT ProductName FROM Products WHERE ProductID = ANY (SELECT ProductID FROM OrderDetails WHERE Quantity = 9)",
      "SELECT ProductName FROM Products WHERE ProductID = ALL (SELECT ProductID FROM OrderDetails WHERE Quantity = 9)",
      "SELECT * FROM Products",
      "SELECT ProductID FROM OrderDetails"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Find employees whose salary is greater than all department average salaries.",
    "options": [
      "SELECT Name, Salary FROM Employees WHERE Salary > ALL (SELECT AvgSalary FROM Departments)",
      "SELECT Name, Salary FROM Employees WHERE Salary > ANY (SELECT AvgSalary FROM Departments)",
      "SELECT * FROM Employees",
      "SELECT MAX(Salary) FROM Employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "What is the difference between ANY and ALL in SQL?",
    "options": [
      "ANY returns TRUE if condition matches at least one value; ALL returns TRUE if condition matches all values",
      "ANY and ALL are the same",
      "ANY returns all values; ALL returns a single value",
      "ANY is used for joins; ALL is used for subqueries"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Find employees whose salaries equal the average salary of their department.",
    "options": [
      "SELECT first_name, last_name, salary FROM employees WHERE salary = ANY (SELECT AVG(salary) FROM employees GROUP BY department_id)",
      "SELECT * FROM employees WHERE salary = AVG(salary)",
      "SELECT * FROM employees",
      "SELECT salary FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "What does DB_ID() return in SQL Server?",
    "options": [
      "The ID number of a database",
      "The name of a database",
      "The number of tables in the database",
      "The current user ID"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "What does DB_NAME() return when called without arguments?",
    "options": [
      "The name of the current database",
      "The ID of the current database",
      "All database names",
      "NULL"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Write a query to check whether all employee numbers are unique.",
    "options": [
      "SELECT emp_id, COUNT(*) FROM employees GROUP BY emp_id HAVING COUNT(*) > 1",
      "SELECT DISTINCT emp_id FROM employees",
      "SELECT * FROM employees",
      "SELECT MAX(emp_id) FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Classify employees' salaries as High (>3000), Medium (2000-3000), Low (<2000) using CASE in SELECT.",
    "options": [
      "SELECT salary, CASE WHEN salary>3000 THEN 'High' WHEN salary BETWEEN 2000 AND 3000 THEN 'Medium' ELSE 'Low' END AS SalaryLevel FROM employees",
      "SELECT salary FROM employees",
      "SELECT CASE salary END FROM employees",
      "SELECT * FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "How would you give a bonus of 500 to IT department employees only using CASE in UPDATE?",
    "options": [
      "UPDATE employees SET salary = salary + 500 WHERE department='IT'",
      "UPDATE employees SET salary = salary + CASE WHEN department='IT' THEN 500 ELSE 0 END",
      "Both A and B",
      "UPDATE employees SET salary = 500"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "How do you count male and female employees per department using CASE?",
    "options": [
      "SELECT department, COUNT(CASE WHEN gender='M' THEN 1 END) AS male_count, COUNT(CASE WHEN gender='F' THEN 1 END) AS female_count FROM employees GROUP BY department",
      "SELECT department, COUNT(gender) FROM employees",
      "SELECT * FROM employees",
      "SELECT gender, COUNT(*) FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Find total salary of IT department using SUM with CASE.",
    "options": [
      "SELECT SUM(CASE WHEN department='IT' THEN salary ELSE 0 END) AS IT_Total_Salary FROM employees",
      "SELECT SUM(salary) FROM employees WHERE department='IT'",
      "SELECT * FROM employees",
      "SELECT SUM(salary) FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "How can you delete duplicates using a subquery?",
    "options": [
      "DELETE FROM employees WHERE emp_id NOT IN (SELECT MIN(emp_id) FROM employees GROUP BY emp_id)",
      "TRUNCATE TABLE employees",
      "DELETE FROM employees",
      "DROP TABLE employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "How do you delete duplicate employee rows while keeping only one copy using ROW_NUMBER()?",
    "options": [
      "WITH DuplicateCTE AS (SELECT *, ROW_NUMBER() OVER (PARTITION BY emp_id ORDER BY emp_id) AS rn FROM employees) DELETE FROM DuplicateCTE WHERE rn > 1",
      "DELETE FROM employees WHERE emp_id NOT IN (SELECT MIN(emp_id) FROM employees GROUP BY emp_id)",
      "TRUNCATE TABLE employees",
      "Both A and B"
    ],
    "answer": 3,
    "time": 30
  },
  {
    "q": "Get the second highest salary for each department using ROW_NUMBER().",
    "options": [
      "SELECT * FROM (SELECT emp_id, salary, ROW_NUMBER() OVER(PARTITION BY department_id ORDER BY salary DESC) AS rn FROM employees) t WHERE rn = 2",
      "SELECT MAX(salary) FROM employees",
      "SELECT TOP 2 salary FROM employees",
      "SELECT salary FROM employees WHERE salary = (SELECT MAX(salary) FROM employees)"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Calculate total salary of IT and HR separately in one query using SUM with CASE.",
    "options": [
      "SELECT SUM(CASE WHEN department='IT' THEN salary ELSE 0 END) AS IT_Salary, SUM(CASE WHEN department='HR' THEN salary ELSE 0 END) AS HR_Salary FROM employees",
      "SELECT SUM(salary) FROM employees WHERE department='IT' OR department='HR'",
      "SELECT salary FROM employees",
      "SELECT department, SUM(salary) FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Find employees whose salary is greater than all department average salaries.",
    "options": [
      "SELECT Name, Salary FROM Employees WHERE Salary > ALL (SELECT AVG(Salary) FROM Employees GROUP BY Department_ID)",
      "SELECT Name, Salary FROM Employees WHERE Salary > ANY (SELECT AVG(Salary) FROM Employees GROUP BY Department_ID)",
      "SELECT MAX(Salary) FROM Employees",
      "SELECT * FROM Employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Find employees whose salary is greater than at least one department's average salary.",
    "options": [
      "SELECT Name, Salary FROM Employees WHERE Salary > ANY (SELECT AVG(Salary) FROM Employees GROUP BY Department_ID)",
      "SELECT Name, Salary FROM Employees WHERE Salary > ALL (SELECT AVG(Salary) FROM Employees GROUP BY Department_ID)",
      "SELECT * FROM Employees",
      "SELECT MAX(Salary) FROM Employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Write a query to generate first 10 Fibonacci numbers using recursive CTE.",
    "options": [
      "WITH CTE_Fib AS (SELECT 0 AS n, 0 AS fib UNION ALL SELECT 1,1 UNION ALL SELECT n+1, fib+LAG(fib) OVER (ORDER BY n) FROM CTE_Fib) SELECT * FROM CTE_Fib WHERE n<10",
      "SELECT * FROM Fibonacci",
      "SELECT TOP 10 fib FROM Fibonacci",
      "SELECT * FROM CTE_Fib"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Identify duplicate employee emails but keep the earliest join_date row.",
    "options": [
      "WITH CTE AS (SELECT *, ROW_NUMBER() OVER(PARTITION BY email ORDER BY join_date ASC) AS rn FROM employees) SELECT * FROM CTE WHERE rn > 1",
      "SELECT email, COUNT(*) FROM employees GROUP BY email HAVING COUNT(*)>1",
      "SELECT DISTINCT email FROM employees",
      "DELETE FROM employees"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Find employees who have the same manager as 'John'.",
    "options": [
      "SELECT e1.* FROM employees e1 JOIN employees e2 ON e1.manager_id = e2.manager_id WHERE e2.name='John'",
      "SELECT * FROM employees WHERE manager_id=(SELECT manager_id FROM employees WHERE name='John')",
      "Both A and B",
      "SELECT name FROM employees"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Get the top 3 salaries per department, including ties using RANK().",
    "options": [
      "SELECT * FROM (SELECT *, RANK() OVER(PARTITION BY department_id ORDER BY salary DESC) AS rnk FROM employees) t WHERE rnk <= 3",
      "SELECT TOP 3 * FROM employees ORDER BY salary DESC",
      "SELECT * FROM employees",
      "SELECT MAX(salary) FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Select employees where department is IT get salary>5000, else salary>3000 using CASE in WHERE.",
    "options": [
      "SELECT * FROM employees WHERE salary > CASE WHEN department='IT' THEN 5000 ELSE 3000 END",
      "SELECT * FROM employees WHERE salary>5000 OR salary>3000",
      "SELECT * FROM employees",
      "SELECT * FROM employees WHERE salary>3000"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "How do you rollback changes only to a certain savepoint?",
    "options": [
      "SAVE TRANSACTION SavePoint1; ... ROLLBACK TRANSACTION SavePoint1",
      "ROLLBACK TRANSACTION",
      "COMMIT TRANSACTION SavePoint1",
      "BEGIN TRANSACTION"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Select employees whose salary is greater than the average salary of the department with highest headcount.",
    "options": [
      "SELECT * FROM employees WHERE salary > (SELECT AVG(salary) FROM employees WHERE department_id=(SELECT TOP 1 department_id FROM employees GROUP BY department_id ORDER BY COUNT(*) DESC))",
      "SELECT * FROM employees",
      "SELECT * FROM employees WHERE salary > AVG(salary)",
      "SELECT * FROM employees WHERE department_id=1"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Execute a query where table name is dynamic using sp_executesql.",
    "options": [
      "DECLARE @sql NVARCHAR(MAX) = 'SELECT * FROM ' + QUOTENAME(@TableName); EXEC sp_executesql @sql",
      "SELECT * FROM @TableName",
      "EXEC('SELECT * FROM ' + @TableName)",
      "SELECT * FROM employees"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Find missing employee IDs in a continuous sequence using CTE.",
    "options": [
      "WITH CTE AS (SELECT ROW_NUMBER() OVER(ORDER BY emp_id) AS rn, emp_id FROM employees) SELECT rn+1 AS missing_id FROM CTE WHERE rn+1 <> emp_id",
      "SELECT * FROM employees",
      "SELECT emp_id FROM employees WHERE emp_id IS NULL",
      "SELECT MAX(emp_id) FROM employees"
    ],
    "answer": 0,
    "time": 30
  },

  {
    "q": "You are performing a JOIN between 'emp' (Salary) and 'sal_grade' (Min_Sal, Max_Sal). If a salary matches multiple grade ranges due to overlapping data, how does the 'BETWEEN' operator behave in the JOIN condition?",
    "options": [
      "It throws an error because BETWEEN requires unique ranges.",
      "It returns only the first matching grade found in the table.",
      "It creates duplicate rows for the employee, one for each matching grade.",
      "It automatically selects the grade where the salary is closest to the Min_Sal."
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "In a Self-Join query to find employees senior to their managers (e.HireDate < m.HireDate), what happens to the CEO (who has a NULL ManagerID) if an INNER JOIN is used?",
    "options": [
      "The CEO is included but shows NULL for manager details.",
      "The CEO is excluded from the result set entirely.",
      "The query fails because you cannot compare a date to NULL.",
      "The CEO is matched with themselves."
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which of the following statements about DATEPART and DATENAME is TRUE regarding the 'weekday' (dw) date part?",
    "options": [
      "DATEPART returns a string like 'Monday', DATENAME returns 1.",
      "Both return an integer, but DATENAME is formatted as a string.",
      "DATEPART returns an integer (1-7), while DATENAME returns the name (e.g., 'Monday').",
      "They are identical and interchangeable in WHERE clauses."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "If you run DATEDIFF(year, '2023-12-31', '2024-01-01'), what is the result?",
    "options": [
      "0 (because only 1 day has passed)",
      "1 (because it counts the number of year boundaries crossed)",
      "0.0027 (the fractional part of the year)",
      "Error: Start date and end date must be at least 365 days apart."
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "In an Execution Plan, what does a 'Key Lookup' (Clustered) operator specifically indicate about your query?",
    "options": [
      "The table has no Primary Key.",
      "A Non-Clustered index was used, but it did not 'cover' all columns in the SELECT list.",
      "The query is performing a full table scan.",
      "The Clustered Index is fragmented and needs rebuilding."
    ],
    "answer": 1,
    "time":30
  },
  {
    "q": "Which Join Operator in an execution plan is typically chosen by the optimizer when both input datasets are large and pre-sorted on the join key?",
    "options": [
      "Nested Loops Join",
      "Hash Match Join",
      "Merge Join",
      "Adaptive Join"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "What is the primary difference between an 'Index Scan' and an 'Index Seek' in an execution plan?",
    "options": [
      "Scan reads only the header; Seek reads the data.",
      "Scan traverses the entire index; Seek uses the B-tree to jump to specific rows.",
      "Scan is always faster than Seek on large tables.",
      "Seek is used for HEAP tables, while Scan is used for Clustered tables."
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "In a Clustered Index B-tree structure, what is stored at the 'Leaf Level'?",
    "options": [
      "Only the Index Key and a pointer to the row.",
      "Pointers to the Intermediate levels.",
      "The actual, complete data rows of the table.",
      "A list of row IDs (RIDs) for the Heap."
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "When a new row is inserted into a Clustered Table and the corresponding data page is full, what event occurs to maintain the logical order?",
    "options": [
      "The row is placed in an Overflow Bucket.",
      "A Page Split occurs, moving roughly half the rows to a new page.",
      "The index is automatically disabled until a REBUILD is run.",
      "The row is stored at the end of the table (Heap behavior)."
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "You are comparing a Heap table and a Clustered table. Which one is generally faster for 'Heavy Insert' workloads where the order doesn't matter?",
    "options": [
      "Clustered Table (because it keeps data organized)",
      "Heap Table (because it avoids the overhead of maintaining B-tree order and page splits)",
      "Both are identical in insert performance.",
      "Clustered Table, but only if the ID is a GUID."
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What does the 'Thickness' of an arrow in a graphical Execution Plan represent?",
    "options": [
      "The speed of the data transfer.",
      "The relative cost of the operator it points to.",
      "The number of rows (volume of data) passing between operators.",
      "The amount of memory (RAM) being used by that step."
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "If DATEADD(month, 1, '2024-01-31') is executed, what is the result (considering 2024 is a leap year)?",
    "options": [
      "2024-02-28",
      "2024-03-01",
      "2024-02-29",
      "Error: February does not have 31 days."
    ],
    "answer": 2,
    "time": 30
  }

 ,
  {
  "q": "In a salary-grade mapping table where min_sal and max_sal define grade ranges, which join condition correctly maps an employee to a grade?",
  "options": [
    "e.salary = s.min_sal",
    "e.salary BETWEEN s.min_sal AND s.max_sal",
    "s.min_sal BETWEEN e.salary AND s.max_sal",
    "e.salary IN (s.min_sal, s.max_sal)"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why must min_salary always be placed first in a BETWEEN condition when joining salary-grade tables?",
  "options": [
    "BETWEEN automatically sorts values",
    "SQL Server enforces column order",
    "BETWEEN expects lower bound first to avoid logical errors",
    "It improves index usage"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which aggregation correctly returns grade, employee count, and highest salary per grade?",
  "options": [
    "SELECT grade, COUNT(*), salary FROM emp GROUP BY grade",
    "SELECT grade, COUNT(*), MAX(salary) FROM emp GROUP BY grade",
    "SELECT DISTINCT grade, COUNT(*), MAX(salary)",
    "SELECT grade, MAX(salary) FROM emp"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "In a self-join used to count employees per manager, which column should be grouped?",
  "options": [
    "EmployeeID",
    "ManagerID from employee table",
    "ManagerID from manager alias",
    "Employee name"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What does COUNT(*) represent when used after joining employees to their managers?",
  "options": [
    "Total rows in the table",
    "Number of managers",
    "Number of employees reporting to each manager",
    "Number of NULL managers"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why is a self-join required to count employees under each manager?",
  "options": [
    "Managers and employees are stored in different tables",
    "Managers are derived using aggregation",
    "Employees and managers exist in the same table",
    "COUNT cannot work without joins"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which condition correctly finds employees senior to their own managers?",
  "options": [
    "e.HireDate > m.HireDate",
    "e.HireDate = m.HireDate",
    "e.HireDate < m.HireDate",
    "DATEDIFF(day, e.HireDate, m.HireDate) < 0"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Why should the seniority condition be placed in the ON clause when using LEFT JOIN?",
  "options": [
    "To improve performance",
    "To preserve employees without managers",
    "To avoid NULL values",
    "To force INNER JOIN behavior"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which join type excludes employees who do not have managers?",
  "options": [
    "LEFT JOIN",
    "RIGHT JOIN",
    "FULL JOIN",
    "INNER JOIN"
  ],
  "answer": 3,
  "time": 20
},
{
  "q": "What data type does DATEPART() return in SQL Server?",
  "options": [
    "VARCHAR",
    "NVARCHAR",
    "INT",
    "DATETIME"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which DATEPART value returns numbers from 1 to 12?",
  "options": [
    "day",
    "month",
    "quarter",
    "week"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which function should be used when month names like 'September' are required?",
  "options": [
    "DATEPART()",
    "DATENAME()",
    "CONVERT()",
    "FORMAT()"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Why is DATEPART preferred over DATENAME in WHERE clause filtering?",
  "options": [
    "DATENAME returns NULL",
    "DATEPART returns numeric values suitable for comparison",
    "DATENAME is deprecated",
    "DATEPART improves indexing"
  ],
  "answer": 1,
  "time": 20
},
{
  "q": "Which query correctly filters records from September using DATEPART?",
  "options": [
    "WHERE DATENAME(month, order_date) = 9",
    "WHERE DATEPART(month, order_date) = 'September'",
    "WHERE DATEPART(month, order_date) = 9",
    "WHERE MONTHNAME(order_date) = 9"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which DATEPART option extracts hour information from a datetime value?",
  "options": [
    "hh",
    "mi",
    "ss",
    "dd"
  ],
  "answer": 0,
  "time": 20
},
{
  "q": "Which scenario MOST requires DATEPART instead of DATENAME?",
  "options": [
    "Displaying reports",
    "String comparison",
    "Date calculations",
    "Formatting output"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "What happens if DATEPART is applied on a NULL date column?",
  "options": [
    "Returns 0",
    "Returns empty string",
    "Returns NULL",
    "Throws error"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which SQL concept is demonstrated when emp table is joined to itself?",
  "options": [
    "Recursive query",
    "Self join",
    "Cross join",
    "Correlated subquery"
  ],
  "answer": 1,
  "time": 20
}
  ,{
  "q": "Which statement about CURRENT_TIMESTAMP in SQL Server is TRUE?",
  "options": [
    "It returns the current UTC time",
    "It is evaluated once per query execution",
    "It returns datetime2 with nanosecond precision",
    "It is evaluated once per row"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "Which data type is returned by CURRENT_TIMESTAMP in SQL Server?",
  "options": [
    "datetime2",
    "smalldatetime",
    "datetime",
    "timestamp"
  ],
  "answer": 2,
  "time": 20
},
{
  "q": "Which scenario can cause DATEDIFF() to return misleading results?",
  "options": [
    "When calculating differences in years",
    "When start_date > end_date",
    "When crossing month or year boundaries",
    "When using DATEDIFF_BIG"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "What does DATEDIFF(DAY, '2024-01-01 23:59', '2024-01-02 00:01') return?",
  "options": [
    "0",
    "1",
    "2",
    "NULL"
  ],
  "answer": 1,
  "time": 30
},
{
  "q": "Why is DATEDIFF() not suitable for calculating exact age?",
  "options": [
    "It ignores leap years",
    "It truncates fractional date parts",
    "It always rounds up",
    "It does not support YEAR"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "What happens when DATEADD(MONTH, 1, '2024-01-31') is executed?",
  "options": [
    "2024-03-02",
    "2024-02-31",
    "2024-02-29",
    "Error is thrown"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which operation in an execution plan usually indicates missing indexes?",
  "options": [
    "Index Seek",
    "Table Scan",
    "Nested Loop",
    "Compute Scalar"
  ],
  "answer": 1,
  "time": 25
},
{
  "q": "What does a Key Lookup in an execution plan usually indicate?",
  "options": [
    "Corrupted index",
    "Missing clustered index",
    "Non-covering nonclustered index",
    "Statistics mismatch"
  ],
  "answer": 2,
  "time": 30
},
{
  "q": "Which execution plan join is generally most efficient for large unsorted datasets?",
  "options": [
    "Nested Loop Join",
    "Merge Join",
    "Hash Join",
    "Cartesian Join"
  ],
  "answer": 2,
  "time": 25
},
{
  "q": "A large difference between estimated rows and actual rows in an execution plan usually indicates:",
  "options": [
    "Missing foreign keys",
    "Outdated or inaccurate statistics",
    "Improper GROUP BY",
    "Excessive parallelism"
  ],
  "answer": 1,
  "time": 30
},
{
  "q": "What does the cost percentage in an execution plan represent?",
  "options": [
    "Actual execution time",
    "CPU usage percentage",
    "Relative estimated cost within the query",
    "Memory consumption percentage"
  ],
  "answer": 2,
  "time": 25
},
{
  "q": "Which execution plan operator indicates multi-threaded execution?",
  "options": [
    "Compute Scalar",
    "Parallelism",
    "Bitmap",
    "Index Scan"
  ],
  "answer": 1,
  "time": 20
},

  
  {
    "q": "In an actual execution plan, what does a large difference between Estimated Rows and Actual Rows usually indicate?",
    "options": [
      "Missing clustered index",
      "Outdated or inaccurate statistics",
      "Implicit data type conversion",
      "Query recompilation"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why does a Key Lookup become a serious performance issue in SQL Server?",
    "options": [
      "Because it forces a table scan",
      "Because it executes once per row returned from the nonclustered index",
      "Because it prevents parallelism",
      "Because it disables index seeks"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which operator in an execution plan indicates that SQL Server is combining unsorted large datasets?",
    "options": [
      "Nested Loops",
      "Merge Join",
      "Hash Match",
      "Bitmap Filter"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why can a Clustered Index Scan be acceptable in some scenarios?",
    "options": [
      "When the table is small or most rows are required",
      "When the query uses GROUP BY",
      "When a nonclustered index exists",
      "When statistics are disabled"
    ],
    "answer": 0,
    "time": 25
  },
  {
    "q": "What is the leaf level of a clustered index?",
    "options": [
      "Pointers to data rows",
      "Nonclustered index keys",
      "Actual table data rows",
      "Intermediate index pages"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "In a heap table, how does SQL Server locate a specific row after a nonclustered index seek?",
    "options": [
      "By scanning all heap pages",
      "By using a RID lookup",
      "By converting it to a clustered index",
      "By using key lookups"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What causes a page split in a clustered index?",
    "options": [
      "Deleting rows from the table",
      "Inserting a row when the target page has no free space",
      "Running an index scan",
      "Updating non-key columns"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which execution plan operator indicates SQL Server is writing intermediate results to tempdb?",
    "options": [
      "Compute Scalar",
      "Sort",
      "Index Seek",
      "Stream Aggregate"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why are heap tables generally slower for range queries?",
    "options": [
      "Because heaps do not support parallelism",
      "Because rows are not stored in any logical order",
      "Because heaps cannot have nonclustered indexes",
      "Because heaps force key lookups"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What does the thickness of arrows between operators in an execution plan represent?",
    "options": [
      "CPU usage",
      "Operator cost percentage",
      "Number of rows flowing between operators",
      "Execution order"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which join type is usually chosen by SQL Server when both inputs are sorted on join keys?",
    "options": [
      "Nested Loops",
      "Hash Join",
      "Merge Join",
      "Adaptive Join"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why is a nonclustered index on a heap often less efficient than on a clustered table?",
    "options": [
      "Because it points to physical row identifiers instead of ordered keys",
      "Because heaps cannot be cached",
      "Because SQL Server avoids heap indexes",
      "Because heaps disable index seeks"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "What does a Parallelism (Gather Streams) operator indicate?",
    "options": [
      "Query execution was forced to single thread",
      "Results from multiple threads are being combined",
      "Index rebuild is occurring",
      "Statistics update is running"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which scenario most commonly leads to incorrect cardinality estimation?",
    "options": [
      "Using PRIMARY KEY",
      "Filtered indexes",
      "Outdated statistics",
      "Using SET NOCOUNT ON"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why does SQL Server sometimes prefer an Index Scan over an Index Seek?",
    "options": [
      "Scans are always faster",
      "When a large percentage of rows are required",
      "When indexes are fragmented",
      "When statistics are disabled"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which execution plan issue is most likely when a query suddenly becomes slow without code changes?",
    "options": [
      "Implicit conversion",
      "Parameter sniffing",
      "Missing primary key",
      "Deadlock"
    ],
    "answer": 1,
    "time": 30
  },

  {
    "q": "Why can a non-clustered index on a heap table be less efficient than on a clustered table?",
    "options": [
      "Because heaps do not allow non-clustered indexes",
      "Because it uses RID lookups instead of clustered key lookups",
      "Because heaps are always scanned fully",
      "Because non-clustered indexes are ignored on heaps"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What does a RID lookup reference in a heap table?",
    "options": [
      "Clustered index key",
      "Row number",
      "File ID, Page ID, and Slot ID",
      "Primary key value"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why can frequent page splits occur in a clustered index?",
    "options": [
      "Because non-key columns are updated",
      "Because new rows are inserted in the middle of the key order",
      "Because statistics are outdated",
      "Because heap tables are converted automatically"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What happens internally when a clustered index is created on a heap table?",
    "options": [
      "Only metadata is updated",
      "The heap remains unchanged",
      "SQL Server rebuilds and physically reorders the data",
      "A non-clustered index is created automatically"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why can a clustered index on a monotonically increasing key (like IDENTITY) reduce page splits?",
    "options": [
      "Because rows are always inserted at the end",
      "Because SQL Server disables fragmentation",
      "Because statistics are auto-updated",
      "Because it forces index seeks"
    ],
    "answer": 0,
    "time": 25
  },
  {
    "q": "Which scenario most likely causes a Key Lookup in a clustered table?",
    "options": [
      "Using SELECT *",
      "Query using nonclustered index without covering required columns",
      "Heap table access",
      "Clustered index scan"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is stored at the leaf level of a non-clustered index on a clustered table?",
    "options": [
      "Entire data row",
      "Only non-key columns",
      "Index key plus clustered index key",
      "RID pointer"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why does ISNULL() sometimes cause implicit data type conversion issues?",
    "options": [
      "Because ISNULL returns the data type with higher precedence",
      "Because ISNULL always returns NVARCHAR",
      "Because ISNULL ignores NULL values",
      "Because ISNULL cannot be used in SELECT"
    ],
    "answer": 0,
    "time": 30
  },
  {
    "q": "Which behavior is correct when using ISNULL() inside an index key?",
    "options": [
      "It always improves index usage",
      "It can prevent index seeks",
      "It forces clustered index scan",
      "It disables statistics"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why is IS NULL preferred over ISNULL() in WHERE clauses for filtering?",
    "options": [
      "ISNULL() cannot be indexed",
      "IS NULL is ANSI standard and avoids expression-based filtering",
      "ISNULL() returns incorrect results",
      "IS NULL forces table scans"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "How does NULLIF() help prevent divide-by-zero errors?",
    "options": [
      "By converting NULL to zero",
      "By converting zero to NULL",
      "By skipping rows automatically",
      "By raising an exception"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What is the result data type of ISNULL(expression1, expression2)?",
    "options": [
      "Always expression2 data type",
      "Always expression1 data type",
      "Highest precedence data type of both",
      "NVARCHAR by default"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which index type is best suited to eliminate Key Lookups completely?",
    "options": [
      "Clustered index",
      "Filtered index",
      "Covering non-clustered index",
      "Unique index"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Why are heap tables risky for frequently updated rows?",
    "options": [
      "Because heaps do not allow updates",
      "Because forwarded records can occur",
      "Because indexes are dropped automatically",
      "Because heaps force recompilation"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is a forwarded record in a heap table?",
    "options": [
      "A deleted row reference",
      "A row moved due to page split with pointer left behind",
      "A clustered index pointer",
      "A nonclustered index entry"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Why does SQL Server store clustered index keys in all non-clustered indexes?",
    "options": [
      "For sorting purposes",
      "To locate the full data row efficiently",
      "To reduce index size",
      "To enforce uniqueness"
    ],
    "answer": 1,
    "time": 25
  },
  


  {
    "q": "In SQL Server, what does a non-clustered index store when created on a heap table?",
    "options": [
      "Only the indexed columns without any row locator",
      "Indexed columns and a Row Identifier (RID)",
      "Indexed columns and clustered key",
      "Entire table data duplicated"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "When a non-clustered index is created on a table that already has a clustered index, what acts as the row locator?",
    "options": [
      "RID",
      "Page ID",
      "Clustered index key",
      "Primary key always"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which operation causes a KEY LOOKUP when using a non-clustered index?",
    "options": [
      "Selecting only indexed columns",
      "Using WHERE clause on non-indexed column",
      "Selecting non-covered columns from non-clustered index",
      "Using GROUP BY on indexed column"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why is creating both clustered and non-clustered indexes on the same column usually unnecessary?",
    "options": [
      "SQL Server does not allow it",
      "Clustered index already stores sorted data",
      "Both indexes will always be identical in storage",
      "Non-clustered index cannot reference clustered index"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which statement is TRUE about dropping an index created by a PRIMARY KEY constraint?",
    "options": [
      "It can be dropped using DROP INDEX",
      "It must be dropped using ALTER TABLE DROP CONSTRAINT",
      "It is dropped automatically after disabling constraint",
      "It cannot be dropped at all"
    ],
    "answer": 1,
    "time": 20
  },
  {
    "q": "What happens internally when a clustered index is dropped from a table?",
    "options": [
      "Table becomes empty",
      "Table converts into a heap",
      "All non-clustered indexes are dropped",
      "Data pages are deleted"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "Which scenario is MOST likely to cause an Index Scan instead of Index Seek?",
    "options": [
      "WHERE EmpID = 100",
      "WHERE Salary > 50000",
      "WHERE YEAR(HireDate) = 2022",
      "JOIN on primary key"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why does using a function on an indexed column often prevent Index Seek?",
    "options": [
      "SQL Server ignores indexes with functions",
      "Functions change the stored data",
      "Predicate becomes non-SARGable",
      "Index statistics get deleted"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which query is more likely to result in an Index Seek?",
    "options": [
      "WHERE Salary + 1000 > 50000",
      "WHERE Salary BETWEEN 40000 AND 50000",
      "WHERE CAST(HireDate AS DATE) = '2023-01-01'",
      "WHERE MONTH(HireDate) = 6"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "In an execution plan, what does a Key Lookup indicate?",
    "options": [
      "Query optimizer error",
      "Lookup into non-clustered index",
      "Fetching missing columns from clustered index",
      "Table scan operation"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Which query pattern avoids Key Lookups most effectively?",
    "options": [
      "Using SELECT *",
      "Creating filtered index",
      "Creating covering non-clustered index",
      "Using INNER JOIN instead of LEFT JOIN"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Which index type is BEST for range-based queries such as BETWEEN and ORDER BY?",
    "options": [
      "Heap",
      "Non-clustered index",
      "Clustered index",
      "Filtered index"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Why can a non-clustered index become inefficient on low-selectivity columns?",
    "options": [
      "Index size increases",
      "Too many duplicate key values cause scans",
      "SQL Server disables the index",
      "Statistics are ignored"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which employee query is MOST expensive without a proper index?",
    "options": [
      "Finding employee by primary key",
      "Finding employees by department",
      "Finding employees joined after a date",
      "Counting total employees"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What is the primary reason SQL Server may choose Index Scan even when an index exists?",
    "options": [
      "Index is disabled",
      "Statistics indicate most rows qualify",
      "Clustered index missing",
      "Query uses ORDER BY"
    ],
    "answer": 1,
    "time": 30
  }
,
  {
    "q": "What is the key difference between a UNIQUE constraint and a UNIQUE index in SQL Server?",
    "options": [
      "UNIQUE index enforces data integrity but constraint does not",
      "UNIQUE constraint expresses business rule while UNIQUE index is a physical object",
      "UNIQUE index cannot prevent duplicate values",
      "UNIQUE constraint improves query performance"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "When a UNIQUE constraint is created on a column, what does SQL Server create internally by default?",
    "options": [
      "A non-unique clustered index",
      "A unique clustered index",
      "A unique non-clustered index",
      "No index is created"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Which statement about UNIQUE indexes and UNIQUE constraints is TRUE?",
    "options": [
      "Query optimizer treats them differently",
      "UNIQUE constraint does not allow NULL values",
      "UNIQUE index created manually does not create a constraint",
      "UNIQUE constraint always creates clustered index"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Why is it recommended to use UNIQUE constraints for enforcing business rules?",
    "options": [
      "They are faster than indexes",
      "They automatically prevent table scans",
      "They clearly communicate data integrity intent",
      "They require less storage"
    ],
    "answer": 2,
    "time": 25
  },
  {
    "q": "Which error severity level is commonly used for user-defined errors raised using RAISERROR?",
    "options": [
      "1",
      "10",
      "16",
      "25"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which of the following errors CANNOT be caught by TRY...CATCH in SQL Server?",
    "options": [
      "Primary key violation",
      "Divide by zero",
      "Syntax error",
      "Foreign key violation"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What happens if RAISERROR is used with severity level less than 11?",
    "options": [
      "Execution stops immediately",
      "Transaction is rolled back",
      "Message is treated as informational",
      "TRY...CATCH block is triggered"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "Which statement about THROW is TRUE compared to RAISERROR?",
    "options": [
      "THROW cannot be used inside CATCH",
      "THROW resets error information",
      "THROW preserves original error details when rethrowing",
      "THROW requires severity and state always"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "What is the primary limitation of @@ERROR compared to TRY...CATCH?",
    "options": [
      "It returns error message instead of number",
      "It must be checked immediately after each statement",
      "It works only inside stored procedures",
      "It captures compile-time errors"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Why is @@ERROR considered unsafe in multi-statement batches?",
    "options": [
      "It resets after COMMIT",
      "It is overwritten by any subsequent statement",
      "It cannot detect constraint violations",
      "It causes implicit rollbacks"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What will @@ROWCOUNT return immediately after a TRY...CATCH block finishes execution?",
    "options": [
      "Rows affected inside TRY block",
      "Rows affected inside CATCH block",
      "Rows affected by last statement inside TRY or CATCH",
      "Always 0"
    ],
    "answer": 3,
    "time": 30
  },
  {
    "q": "Why should @@ROWCOUNT be stored in a variable when used with TRY...CATCH?",
    "options": [
      "TRY...CATCH clears @@ROWCOUNT automatically",
      "Later statements reset @@ROWCOUNT",
      "@@ROWCOUNT cannot be used inside CATCH",
      "It improves performance"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "What does @@ROWCOUNT return when an INSERT fails due to primary key violation?",
    "options": [
      "-1",
      "NULL",
      "Number of attempted rows",
      "0"
    ],
    "answer": 3,
    "time": 20
  },
  {
    "q": "Which function helps determine whether a transaction should be rolled back inside a CATCH block?",
    "options": [
      "@@TRANCOUNT",
      "ERROR_STATE()",
      "XACT_STATE()",
      "@@ERROR"
    ],
    "answer": 2,
    "time": 30
  },
  {
    "q": "In nested TRY...CATCH blocks, how do you propagate the same error to the outer CATCH?",
    "options": [
      "RAISERROR without parameters",
      "THROW;",
      "RETURN error_number",
      "SET @@ERROR = 1"
    ],
    "answer": 1,
    "time": 25
  },
  {
    "q": "Which error numbers commonly represent constraint violations in SQL Server?",
    "options": [
      "1205 and 547",
      "2627 and 547",
      "208 and 207",
      "50000 and 60000"
    ],
    "answer": 1,
    "time": 30
  },
  {
    "q": "What is the main reason SET NOCOUNT ON is commonly used in stored procedures?",
    "options": [
      "It changes @@ROWCOUNT value",
      "It improves query optimization",
      "It suppresses row count messages",
      "It avoids transaction rollback"
    ],
    "answer": 2,
    "time": 20
  },
  {
    "q": "Which combination provides the MOST reliable modern error-handling pattern in SQL Server?",
    "options": [
      "@@ERROR with RETURN codes",
      "RAISERROR with severity < 10",
      "TRY...CATCH with THROW and XACT_STATE()",
      "SET ROWCOUNT with @@ERROR"
    ],
    "answer": 2,
    "time": 30
  }


  // add more questions here...
];

/* ----------------- STATE ----------------- */
let questions = [];
let userAnswers = []; // integer | null
let questionRemain = []; // seconds left per question
let marked = []; // boolean mark for review
let batchIndex = 0;
let currentIndex = 0;
let globalSeconds = 0;
let paused = false;
let shuffleEnabled = true;
let darkMode = false;
let globalTimerId = null, questionTimerId = null;

// completed batches stored persistently
let completedBatches = JSON.parse(localStorage.getItem(COMPLETED_KEY) || "[]");

/* ----------------- HELPERS ----------------- */
function saveState(){
  const payload = { originalQuestions, questions, userAnswers, questionRemain, marked, batchIndex, currentIndex, globalSeconds, paused, shuffleEnabled, darkMode };
  localStorage.setItem(LS_KEY, JSON.stringify(payload));
}
function loadState(){
  try{ const s = localStorage.getItem(LS_KEY); return s? JSON.parse(s): null; }catch(e){return null}
}
function clearSavedState(){ localStorage.removeItem(LS_KEY); }

function shuffleArray(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }}
function formatTime(sec){ const m=Math.floor(sec/60); const s=sec%60; return `${m}:${String(s).padStart(2,'0')}`; }
function inProgress(){ return questions && questions.length && userAnswers.some(a=>a!==null); }

/* ----------------- BATCH MENU ----------------- */
function renderBatchMenu(){
  const menu = document.getElementById('menu');
  menu.innerHTML = '';
  const total = Math.max(1, Math.ceil(originalQuestions.length / QUESTIONS_PER_BATCH));
  const h = document.createElement('div'); h.innerHTML = `<strong>Select Batch</strong>`; menu.appendChild(h);

  const btnWrap = document.createElement('div');
  btnWrap.className = 'batch-wrap';

  for(let b=0;b<total;b++){
    const btn = document.createElement('button');
    btn.className = 'batch-btn';
    btn.style.border = '0';
    // show completed status
    if (completedBatches.includes(b)){
      btn.style.background = 'var(--good)';
      btn.style.color = '#fff';
      btn.textContent = `Batch ${b+1} ✓ Completed`;
    } else {
      btn.classList.add('primary');
      btn.textContent = `Start Batch ${b+1}`;
      btn.style.color = '#fff';
    }
    btn.onclick = ()=> startBatchWithCheck(b);
    btnWrap.appendChild(btn);
  }
  menu.appendChild(btnWrap);

  // Resume button if saved
  const st = loadState();
  if(st && st.questions && st.questions.length){
    const br = document.createElement('div'); br.style.marginTop='10px';
    const r = document.createElement('button'); r.className='warn'; r.textContent='Resume Last Attempt'; r.onclick=resumeExam;
    br.appendChild(r);
    menu.appendChild(br);
  }

  // Reset All Batches button
  const resetWrap = document.createElement('div');
  resetWrap.style.marginTop = '16px';
  const resetBtn = document.createElement('button');
  resetBtn.className = 'reset-btn';
  resetBtn.style.background = 'var(--bad)';
  resetBtn.style.color = '#fff';
  resetBtn.style.padding = '10px 14px';
  resetBtn.style.borderRadius = '8px';
  resetBtn.textContent = 'Reset All Batches';
  resetBtn.onclick = resetAllBatches;
  resetWrap.appendChild(resetBtn);
  menu.appendChild(resetWrap);

  // Small note
  const note = document.createElement('div'); note.className='small'; note.style.marginTop='10px';
  note.textContent = 'You can submit any batch anytime and switch batches freely. Progress is saved locally. Use Reset to clear completions.';
  menu.appendChild(note);
}

// helper: confirm before starting new batch if current in-progress
function startBatchWithCheck(targetBatch){
  if(inProgress()){
    const ok = confirm('You have in-progress answers in the current batch. Starting another batch will discard the current in-memory progress (saved attempts remain). Proceed?');
    if(!ok) return;
  }
  startBatch(targetBatch);
}

/* ----------------- START / RESUME ----------------- */
function startBatch(b){
  batchIndex = b;
  const start = b * QUESTIONS_PER_BATCH;
  const end = Math.min(start + QUESTIONS_PER_BATCH, originalQuestions.length);
  questions = JSON.parse(JSON.stringify(originalQuestions.slice(start, end)));
  if(shuffleEnabled) shuffleQuestionsAndOptions();
  userAnswers = new Array(questions.length).fill(null);
  questionRemain = new Array(questions.length).fill(PER_QUESTION_SECONDS);
  marked = new Array(questions.length).fill(false);
  currentIndex = 0;
  globalSeconds = questions.length * PER_QUESTION_SECONDS;
  paused = false;
  saveState();
  showExam();
}

function resumeExam(){
  const st = loadState();
  if(!st) return alert('No saved attempt');
  // restore
  originalQuestions = st.originalQuestions || originalQuestions;
  questions = st.questions || [];
  userAnswers = st.userAnswers || new Array(questions.length).fill(null);
  questionRemain = st.questionRemain || new Array(questions.length).fill(PER_QUESTION_SECONDS);
  marked = st.marked || new Array(questions.length).fill(false);
  batchIndex = st.batchIndex || 0;
  currentIndex = st.currentIndex || 0;
  globalSeconds = st.globalSeconds || (questions.length * PER_QUESTION_SECONDS);
  paused = !!st.paused;
  shuffleEnabled = typeof st.shuffleEnabled === 'boolean' ? st.shuffleEnabled : shuffleEnabled;
  darkMode = !!st.darkMode;
  applyUISettings();
  showExam();
}

function shuffleQuestionsAndOptions(){
  shuffleArray(questions);
  questions.forEach(q=>{
    const correctText = q.options[q.answer];
    shuffleArray(q.options);
    q.answer = q.options.indexOf(correctText);
  });
}

/* ----------------- RENDER EXAM ----------------- */
function showExam(){
  document.getElementById('menu').style.display = 'none';
  document.getElementById('controls').style.display = 'flex';
  document.getElementById('exam').style.display = 'block';
  document.getElementById('result').innerHTML = '';
  document.getElementById('batchTitle').textContent = `${batchIndex+1}`;
  applyUISettings();
  renderQuestion();
  renderNavNums();
  updateProgress();
  updateTimersDisplay();
  // ensure timers are running according to paused state
  clearInterval(globalTimerId); clearInterval(questionTimerId);
  if(!paused){ startGlobalTimer(); startQuestionTimer(); }
  // show/hide prev/next batch buttons appropriately
  updateBatchNavButtons();
}

function applyUISettings(){
  document.getElementById('shuffleToggle').textContent = `Shuffle: ${shuffleEnabled? 'ON':'OFF'}`;
  document.getElementById('darkToggle').textContent = darkMode? 'Light':'Dark';
  document.body.classList.toggle('dark', darkMode);
}

function renderQuestion(){
  if(!questions || questions.length === 0){
    document.getElementById('questionBox').innerHTML = '<em>No questions in this batch.</em>';
    return;
  }
  const q = questions[currentIndex];
  let html = `<div style='display:flex;justify-content:space-between;align-items:center'><div><strong>Q${currentIndex+1}.</strong> ${escapeHtml(q.q)}</div><div class='small'>Marked: <strong>${marked[currentIndex]? 'Yes':'No'}</strong></div></div><hr>`;
  q.options.forEach((opt,i)=>{
    const checked = (userAnswers[currentIndex]===i)? 'checked': '';
    html += `<label style='display:block;margin:8px 0;padding:8px;border-radius:6px;border:1px solid #eee;cursor:pointer'><input type='radio' name='opt' value='${i}' ${checked}> ${escapeHtml(opt)}</label>`;
  });
  document.getElementById('questionBox').innerHTML = html;
  document.querySelectorAll("input[name='opt']").forEach(el=>el.onchange = ()=>{
    userAnswers[currentIndex] = parseInt(el.value);
    saveState();
    renderNavNums();
    updateProgress();
  });
}

function renderNavNums(){
  const wrap = document.getElementById('navNums'); wrap.innerHTML = '';
  if(!questions) return;
  questions.forEach((q,i)=>{
    const b = document.createElement('button');
    b.textContent = i+1;
    b.style.minWidth = '36px';
    b.style.minHeight = '36px';
    if(userAnswers[i] !== null) b.classList.add('answered');
    if(marked[i]) b.classList.add('marked');
    if(i===currentIndex) b.style.boxShadow='0 0 0 4px rgba(0,123,255,0.12)';
    b.onclick = ()=>{ saveState(); currentIndex = i; renderQuestion(); startQuestionTimer(); updateTimersDisplay(); renderNavNums(); };
    wrap.appendChild(b);
  });
}

function updateProgress(){
  const answered = userAnswers.filter(x=>x!==null).length;
  const total = questions.length;
  const pct = total ? Math.round((answered/total)*100) : 0;
  document.getElementById('progBar').style.width = pct+'%';
  document.getElementById('progressText').textContent = `Answered ${answered} / ${total} (${pct}%)`;
  document.getElementById('marksLegend').innerHTML = `<span style='color:var(--good)'>Answered</span> &nbsp; <span style='border:2px dashed #ff9800;padding:2px;border-radius:4px'>Marked</span>`;
}

/* ----------------- TIMERS ----------------- */
function startGlobalTimer(){ clearInterval(globalTimerId); globalTimerId = setInterval(()=>{
  if(paused) return;
  globalSeconds--;
  if(globalSeconds <= 0){ globalSeconds = 0; submitBatch(); }
  saveState(); updateTimersDisplay();
}, 1000); }

function startQuestionTimer(){ clearInterval(questionTimerId); questionTimerId = setInterval(()=>{
  if(paused) return;
  if(!questionRemain[currentIndex] && questionRemain[currentIndex] !== 0) questionRemain[currentIndex] = PER_QUESTION_SECONDS;
  questionRemain[currentIndex] = (questionRemain[currentIndex] || PER_QUESTION_SECONDS) - 1;
  if(questionRemain[currentIndex] <= 0){ questionRemain[currentIndex] = 0; goNext(); }
  saveState(); updateTimersDisplay();
}, 1000); }

function updateTimersDisplay(){
  document.getElementById('globalTimer').textContent = formatTime(globalSeconds || 0);
  document.getElementById('questionTimer').textContent = (questionRemain[currentIndex] !== undefined ? questionRemain[currentIndex] : PER_QUESTION_SECONDS);
}

/* ----------------- NAVIGATION ----------------- */
function goNext(){
  if(!questions || questions.length===0) return;
  if(currentIndex < questions.length - 1){
    currentIndex++;
    renderQuestion(); renderNavNums(); startQuestionTimer(); saveState();
  } else {
    // at end — don't force submit automatically; show a message then let user decide
    const ok = confirm('You are at the last question. Do you want to submit this batch now?');
    if(ok) submitBatch();
  }
}
function goPrev(){
  if(!questions || questions.length===0) return;
  if(currentIndex > 0){
    currentIndex--;
    renderQuestion(); renderNavNums(); startQuestionTimer(); saveState();
  }
}

document.getElementById('nextBtn').onclick = ()=>{ saveState(); goNext(); };
document.getElementById('prevBtn').onclick = ()=>{ saveState(); goPrev(); };

document.getElementById('answerLaterBtn').onclick = ()=>{ if(!questions || !questions.length) return; marked[currentIndex] = true; saveState(); renderNavNums(); goNext(); };

document.getElementById('pauseBtn').onclick = ()=>{ paused = true; saveState(); document.getElementById('pauseBtn').style.display='none'; document.getElementById('resumeBtn').style.display='inline-block'; };
document.getElementById('resumeBtn').onclick = ()=>{ paused = false; saveState(); document.getElementById('pauseBtn').style.display='inline-block'; document.getElementById('resumeBtn').style.display='none'; startGlobalTimer(); startQuestionTimer(); };

/* ----------------- BATCH NAV BUTTONS & HOME ----------------- */
document.getElementById('homeBtn').onclick = ()=>{ // go back to menu (keeps saved state)
  clearInterval(globalTimerId); clearInterval(questionTimerId);
  document.getElementById('exam').style.display = 'none';
  document.getElementById('controls').style.display = 'none';
  document.getElementById('menu').style.display = 'block';
  document.getElementById('result').innerHTML = '';
  renderBatchMenu();
};

document.getElementById('nextBatchBtn').onclick = ()=>{ const total = Math.max(1, Math.ceil(originalQuestions.length / QUESTIONS_PER_BATCH)); if(batchIndex+1 >= total){ alert('No next batch'); return; } startBatchWithCheck(batchIndex+1); };
document.getElementById('prevBatchBtn').onclick = ()=>{ if(batchIndex-1 < 0){ alert('No previous batch'); return; } startBatchWithCheck(batchIndex-1); };

/* ----------------- SUBMIT & REVIEW ----------------- */
document.getElementById('submitBtn').onclick = ()=>{ // allow submit at any time
  const confirmNow = confirm('Submit this batch now? You will see the result and saved attempt will be cleared.');
  if(confirmNow) submitBatch();
};

function submitBatch(){
  clearInterval(globalTimerId); clearInterval(questionTimerId);
  let correct = 0;
  const details = (questions || []).map((q,i)=>{
    const ua = userAnswers[i];
    const isCorrect = (ua !== null && ua === q.answer);
    if(isCorrect) correct++;
    return { q: q.q, options: q.options, ua, correctIndex: q.answer, isCorrect };
  });

  const total = questions.length || 0;
  const pct = total ? ((correct/total)*100).toFixed(2) : '0.00';

  // Mark current batch as completed (persist this)
  if (!completedBatches.includes(batchIndex)) {
    completedBatches.push(batchIndex);
    localStorage.setItem(COMPLETED_KEY, JSON.stringify(completedBatches));
  }

  // clear saved state for this attempt (but keep completed list)
  clearSavedState();

  document.getElementById('exam').style.display = 'none';
  document.getElementById('controls').style.display = 'none';
  document.getElementById('result').innerHTML = `
    <h2>Batch ${batchIndex+1} Result</h2>
    <p><strong>Score:</strong> ${correct} / ${total} (${pct}%)</p>
    <div style="margin-top:12px">
      <button id='viewDetail' class='primary'>View Detailed Review</button>
      <button id='backMenu' class='secondary'>Back to Menu</button>
      <button id='startNext' class='secondary'>Start Next Batch</button>
    </div>
  `;

  document.getElementById('viewDetail').onclick = ()=> showDetailedReview(details);
  document.getElementById('backMenu').onclick = ()=> { location.reload(); }; // simple reload to restore initial UI
  document.getElementById('startNext').onclick = ()=> {
    const totalB = Math.max(1, Math.ceil(originalQuestions.length / QUESTIONS_PER_BATCH));
    if(batchIndex+1 < totalB) startBatch(batchIndex+1);
    else alert('No next batch available.');
  };
}

/* detailed review view */
function showDetailedReview(details){
  let html = `<h3>Detailed Review — Batch ${batchIndex+1}</h3><ol>`;
  details.forEach((d,i)=>{
    html += `<li style='margin:8px 0'><strong>${escapeHtml(d.q)}</strong><br>Your: ${d.ua !== null ? escapeHtml(d.options[d.ua]) : '<em>Not answered</em>'} ${d.isCorrect? '<span style="color:var(--good)"> (Correct)</span>' : '<span style="color:var(--bad)"> (Wrong)</span>' }<br>Correct: ${escapeHtml(d.options[d.correctIndex])}</li>`;
  });
  html += `</ol><div style="margin-top:12px"><button id='detailBack' class='primary'>Back to Menu</button></div>`;
  document.getElementById('result').innerHTML = html;
  document.getElementById('detailBack').onclick = ()=> { location.reload(); };
}

/* ----------------- IMPORT / EXPORT / UI ----------------- */
document.getElementById('exportBtn').onclick = ()=>{
  const data = JSON.stringify(originalQuestions, null, 2);
  const blob = new Blob([data],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download = 'questions.json'; a.click(); URL.revokeObjectURL(url);
};

document.getElementById('importBtn').onclick = ()=>{ document.getElementById('importFile').click(); };
document.getElementById('importFile').onchange = (e)=>{
  const f = e.target.files[0]; if(!f) return; const reader = new FileReader(); reader.onload = ev=>{
    try{
      const arr = JSON.parse(ev.target.result);
      if(!Array.isArray(arr)) throw 0;
      originalQuestions = arr;
      alert('Imported '+arr.length+' questions.'); renderBatchMenu();
    }catch(err){ alert('Invalid JSON file'); }
  }; reader.readAsText(f);
};

/* Shuffle toggle */
document.getElementById('shuffleToggle').onclick = ()=>{ shuffleEnabled = !shuffleEnabled; document.getElementById('shuffleToggle').textContent = `Shuffle: ${shuffleEnabled? 'ON':'OFF'}`; saveState(); };
/* Dark toggle */
document.getElementById('darkToggle').onclick = ()=>{ darkMode = !darkMode; applyUISettings(); saveState(); };

/* ----------------- RESET ALL BATCHES ----------------- */
function resetAllBatches(){
  if (!confirm("Are you sure you want to reset all batches? This will clear completed status and saved progress.")) return;
  // Clear completed batches
  completedBatches = [];
  localStorage.setItem(COMPLETED_KEY, JSON.stringify(completedBatches));
  // Clear saved attempt state
  clearSavedState();
  // Re-render menu
  renderBatchMenu();
  alert("All batches and saved attempts have been reset.");
}

/* ----------------- UTIL ----------------- */
function escapeHtml(str){ return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

/* update prev/next batch button visibility */
function updateBatchNavButtons(){
  const total = Math.max(1, Math.ceil(originalQuestions.length / QUESTIONS_PER_BATCH));
  document.getElementById('nextBatchBtn').disabled = (batchIndex+1 >= total);
  document.getElementById('prevBatchBtn').disabled = (batchIndex <= 0);
}

/* ----------------- INIT ----------------- */
renderBatchMenu();
applyUISettings();

</script>
</body>
</html>
